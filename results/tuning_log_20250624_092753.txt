2025-06-24 09:27:53,287 - src.hyperparameter_tuning - INFO - MLflow 실험 설정: hyperparameter_tuning (ID: 765186397364671153)
2025-06-24 09:27:53,287 - src.hyperparameter_tuning - INFO - 데이터 로드 중: data/processed/processed_data_with_features.csv
2025-06-24 09:27:53,291 - src.hyperparameter_tuning - INFO - 테스트용 데이터 로드: 1,000 행
2025-06-24 09:27:53,291 - src.hyperparameter_tuning - INFO - 모델 타입: xgboost
2025-06-24 09:27:53,291 - src.hyperparameter_tuning - INFO - 튜닝 설정 - 시도 횟수: 100, 타임아웃: 3600초
2025-06-24 09:27:53,291 - src.hyperparameter_tuning - INFO - 하이퍼파라미터 튜너 초기화 완료
2025-06-24 09:27:53,292 - src.hyperparameter_tuning - INFO -   - 튜닝 설정: {'data': {'file_path': 'data/processed_data.csv', 'encoding': 'utf-8', 'na_values': ['', 'nan', 'NaN', 'NULL', 'null']}, 'features': {'target_columns': ['suicide_a_next_year'], 'exclude_columns': ['id', 'patient_id', 'visit_date', 'visit_year'], 'categorical_columns': ['gender', 'marital_status', 'education_level', 'income_level', 'residence_type', 'insurance_type', 'primary_diagnosis', 'comorbidity', 'medication_type', 'treatment_type', 'follow_up_status'], 'selected_features': ['age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score'], 'validation': {'scope': 'sample', 'sample_size': 10}, 'enable_feature_engineering': False, 'enable_lagged_features': False, 'lag_periods': [1, 2, 3], 'lagged_features': {'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp']}, 'enable_rolling_stats': False, 'rolling_stats': {'window_sizes': [2, 3], 'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp']}}, 'preprocessing': {'time_series_imputation': {'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp'], 'fallback_strategy': 'mean'}, 'numerical_imputation': {'strategy': 'mean', 'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']}, 'categorical_imputation': {'strategy': 'most_frequent', 'columns': ['sex']}, 'categorical_encoding': {'method': 'ordinal'}, 'missing_value_strategy': 'median', 'outlier_detection': {'method': 'iqr', 'threshold': 1.5}, 'scaling': {'method': 'robust', 'with_mean': True, 'with_std': True}, 'feature_selection': {'method': 'variance_threshold', 'threshold': 0.01}}, 'data_split': {'test_ids_ratio': 0.15, 'random_state': 42, 'method': 'stratified_kfold', 'n_splits': 5, 'test_size': 0.2, 'val_size': 0.2}, 'validation': {'strategy': 'group_kfold', 'num_cv_folds': 3, 'test_size': 0.15, 'random_state': 42, 'val_ids_ratio': 0.15, 'validation_start_year': 2021, 'min_train_years': 3, 'max_train_years': 8}, 'time_series': {'date_column': 'dov', 'year_column': 'yov', 'id_column': 'id'}, 'evaluation': {'regression_metrics': ['mae', 'rmse', 'r2'], 'classification_metrics': ['precision', 'recall', 'f1', 'roc_auc', 'balanced_accuracy'], 'cv_metrics': ['accuracy', 'f1', 'auc', 'rmse', 'r2'], 'save_predictions': True, 'save_feature_importance': True, 'save_confusion_matrix': True, 'save_roc_curve': True, 'save_precision_recall_curve': True, 'primary_metric': 'f1_score', 'secondary_metrics': ['recall', 'precision', 'balanced_accuracy', 'roc_auc'], 'cv': {'strategy': 'group_kfold', 'n_folds': 5, 'shuffle': False}}, 'training': {'early_stopping': True, 'patience': 10, 'handle_imbalance': True, 'save_best_model': True, 'model_save_path': 'models/'}, 'logging': {'log_splits_info': True, 'log_fold_details': True, 'level': 'INFO', 'format': '%(asctime)s - %(name)s - %(levelname)s - %(message)s', 'file': 'logs/experiment.log'}, 'output': {'directory': 'results', 'save_model': True, 'save_predictions': True, 'save_feature_importance': True, 'save_confusion_matrix': True, 'save_roc_curve': True, 'save_precision_recall_curve': True}, 'mlflow': {'experiment_name': 'hyperparameter_tuning', 'experiment_description': '자살 위험 예측 모델 실험', 'tags': ['suicide_prediction', 'healthcare', 'classification', 'regression'], 'nested_runs': True, 'save_artifacts': True, 'log_params': True, 'log_metrics': True, 'log_model': True, 'tracking': {'tracking_uri': 'file:./mlruns', 'experiment_name': 'suicide_prediction', 'nested_runs': True, 'artifact_location': './mlruns'}, 'logging': {'param_logging_level': 'INFO', 'metric_logging_level': 'INFO', 'artifact_logging_level': 'INFO', 'log_experiment_info': True, 'log_fold_results': True, 'log_model_info': True}, 'log_optimization': True}, 'model': {'model_type': 'xgboost', 'xgboost': {'n_estimators': 100, 'max_depth': 6, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8, 'min_child_weight': 1, 'scale_pos_weight': 1.0, 'early_stopping_rounds': 10, 'verbose': 0, 'n_jobs': 28, 'use_focal_loss': False, 'focal_loss': {'alpha': 0.25, 'gamma': 2.0}}}, 'resampling': {'enabled': False, 'method': 'smote', 'random_state': 42, 'smote_k_neighbors': 5, 'borderline_smote_k_neighbors': 5, 'adasyn_k_neighbors': 5, 'under_sampling_strategy': 'random', 'hybrid_strategy': 'smote_tomek', 'time_series_adapted': {'enabled': False, 'time_weight': 0.3, 'pattern_preservation': True}}, 'experiment': {'name': 'hyperparameter_tuning_experiment', 'description': 'Optuna 기반 하이퍼파라미터 최적화 실험', 'tags': ['hyperparameter_tuning', 'optuna', 'optimization']}, 'tuning': {'direction': 'maximize', 'n_trials': 50, 'n_jobs': 1, 'early_stopping': {'enabled': True, 'patience': 20, 'min_trials': 30}}, 'sampler': {'type': 'tpe', 'tpe': {'n_startup_trials': 10, 'n_ei_candidates': 24, 'multivariate': True, 'group': False}, 'cmaes': {'x0': {'n_estimators': 100, 'max_depth': 6, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8, 'min_child_weight': 1, 'reg_alpha': 0.1, 'reg_lambda': 1.0}, 'sigma0': 0.1}}, 'xgboost_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 1000, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 15, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'subsample': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'colsample_bytree': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'min_child_weight': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'reg_alpha': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'reg_lambda': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'scale_pos_weight': {'type': 'float', 'low': 0.5, 'high': 10.0, 'log': True}}, 'lightgbm_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 1000, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 12, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'subsample': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'colsample_bytree': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'min_child_weight': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'reg_alpha': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'reg_lambda': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}}, 'catboost_params': {'iterations': {'type': 'int', 'low': 50, 'high': 500, 'log': False}, 'depth': {'type': 'int', 'low': 3, 'high': 10, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'l2_leaf_reg': {'type': 'float', 'low': 1, 'high': 10, 'log': True}, 'border_count': {'type': 'int', 'low': 32, 'high': 255, 'log': False}, 'bagging_temperature': {'type': 'float', 'low': 0.1, 'high': 1.0, 'log': False}, 'random_strength': {'type': 'float', 'low': 0.1, 'high': 10.0, 'log': True}}, 'random_forest_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 500, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 20, 'log': False}, 'min_samples_split': {'type': 'int', 'low': 2, 'high': 20, 'log': False}, 'min_samples_leaf': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'max_features': {'type': 'categorical', 'choices': ['sqrt', 'log2', 'auto']}}, 'results': {'save_best_model': True, 'model_save_path': 'models/best_tuned_model.joblib', 'save_study': True, 'study_save_path': 'models/optuna_study.pkl', 'create_plots': True, 'plots_save_path': 'data/tuning_results/'}}
2025-06-24 09:27:53,292 - src.hyperparameter_tuning - INFO -   - 튜닝 횟수: 100
2025-06-24 09:27:53,292 - src.hyperparameter_tuning - INFO -   - 타임아웃: 3600초
2025-06-24 09:27:53,292 - __main__ - INFO - 하이퍼파라미터 최적화 실행 중...
2025-06-24 09:27:53,292 - src.hyperparameter_tuning - INFO - === 하이퍼파라미터 튜닝 시작 ===
2025-06-24 09:27:53,293 - src.hyperparameter_tuning - INFO - Trial 0: 모델 타입 = xgboost
2025-06-24 09:27:53,296 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:53,297 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:53,297 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:53,297 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:53,297 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:53,297 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:53,297 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:53,298 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:53,298 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:53,299 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:53,299 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:53,299 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:53,299 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:53,299 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:53,299 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:53,299 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:53,299 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:53,299 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:53,300 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:53,300 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:53,300 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:53,300 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:53,300 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:53,300 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:53,300 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:53,300 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:53,300 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:53,300 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:53,304 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:53,306 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:53,307 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:53,307 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:53,307 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:53,307 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:53,307 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:53,307 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:53,309 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:53,311 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:53,311 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:53,311 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:53,311 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:53,311 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:53,311 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:53,311 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:53,311 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:53,311 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,311 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,311 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:53,311 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:53,311 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,311 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,311 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:53,311 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:53,311 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,312 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:53,312 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:53,312 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:53,313 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:53,313 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:53,313 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:53,313 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:53,313 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:53,313 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:53,313 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:53,313 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:53,313 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:53,313 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,313 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:53,313 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:53,313 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,314 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,314 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,314 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,314 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,314 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,314 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,315 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,315 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:53,315 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,315 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:53,315 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,315 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,315 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:53,315 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:53,315 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,315 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,316 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,316 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,316 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,316 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,316 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,316 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,316 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:53,316 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,317 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:53,317 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,317 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:53,317 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,317 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:53,317 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:53,317 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:53,317 - src.models.xgboost_model - INFO -   n_estimators: 406
2025-06-24 09:27:53,317 - src.models.xgboost_model - INFO -   max_depth: 15
2025-06-24 09:27:53,317 - src.models.xgboost_model - INFO -   learning_rate: 0.1205712628744377
2025-06-24 09:27:53,317 - src.models.xgboost_model - INFO -   subsample: 0.8394633936788146
2025-06-24 09:27:53,317 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6624074561769746
2025-06-24 09:27:53,317 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 09:27:53,317 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:53,317 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:53,317 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:53,317 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:53,317 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:53,317 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:53,317 - src.models.xgboost_model - INFO -   reg_alpha: 3.3323645788192616e-08
2025-06-24 09:27:53,317 - src.models.xgboost_model - INFO -   reg_lambda: 0.6245760287469893
2025-06-24 09:27:53,317 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:53,317 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:53,318 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:53,352 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:53,352 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:53,352 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:53,353 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:53,353 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,353 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,353 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,353 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,353 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,353 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,354 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,354 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,354 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:53,354 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,354 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:53,356 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:53,356 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:53,356 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:53,356 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:53,356 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,356 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:53,356 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:53,356 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:53,356 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:53,356 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:53,356 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:53,356 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:53,357 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,357 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,357 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,357 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,358 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:53,358 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:53,358 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:53,358 - src.training - INFO -   accuracy: 0.984
2025-06-24 09:27:53,358 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:53,358 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:53,358 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:53,358 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:53,358 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:53,358 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:53,358 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:53,358 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:53,358 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:53,358 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:53,358 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.984, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:53,358 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,358 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,358 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,358 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,373 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:53,373 - src.hyperparameter_tuning - ERROR - Trial 0 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:53,374 - src.hyperparameter_tuning - INFO - Trial 1: 모델 타입 = xgboost
2025-06-24 09:27:53,378 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:53,379 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:53,379 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:53,379 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:53,379 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:53,379 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:53,379 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:53,379 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:53,379 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:53,380 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:53,380 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:53,380 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:53,380 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:53,380 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:53,380 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:53,380 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:53,380 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:53,380 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:53,381 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:53,381 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:53,381 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:53,381 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:53,381 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:53,381 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:53,381 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:53,381 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:53,381 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:53,381 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:53,384 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:53,387 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:53,387 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:53,387 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:53,387 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:53,387 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:53,387 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:53,387 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:53,389 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:53,391 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:53,391 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:53,391 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:53,391 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:53,391 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:53,391 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:53,391 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:53,391 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:53,391 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,391 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,391 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:53,391 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:53,391 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,391 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,391 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:53,391 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:53,391 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,392 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:53,392 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:53,392 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:53,393 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:53,393 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:53,393 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:53,393 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:53,393 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:53,393 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:53,393 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:53,393 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:53,393 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:53,393 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,393 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:53,393 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:53,393 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,393 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,394 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,394 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,394 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,394 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,394 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,394 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,394 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:53,394 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,395 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:53,395 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,395 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,395 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:53,395 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:53,395 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,395 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,395 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,395 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,395 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,396 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,396 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,396 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,396 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:53,396 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,396 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:53,396 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,396 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:53,396 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,396 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:53,397 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:53,397 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:53,397 - src.models.xgboost_model - INFO -   n_estimators: 723
2025-06-24 09:27:53,397 - src.models.xgboost_model - INFO -   max_depth: 3
2025-06-24 09:27:53,397 - src.models.xgboost_model - INFO -   learning_rate: 0.2708160864249968
2025-06-24 09:27:53,397 - src.models.xgboost_model - INFO -   subsample: 0.9329770563201687
2025-06-24 09:27:53,397 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6849356442713105
2025-06-24 09:27:53,397 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 09:27:53,397 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:53,397 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:53,397 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:53,397 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:53,397 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:53,397 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:53,397 - src.models.xgboost_model - INFO -   reg_alpha: 4.4734294104626844e-07
2025-06-24 09:27:53,397 - src.models.xgboost_model - INFO -   reg_lambda: 5.472429642032198e-06
2025-06-24 09:27:53,397 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:53,397 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:53,397 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:53,405 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:53,405 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:53,405 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:53,405 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:53,405 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,405 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,405 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,405 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,405 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,406 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,406 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,406 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,406 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:53,406 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,406 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:53,407 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:53,407 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:53,407 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:53,407 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:53,407 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,407 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:53,407 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:53,407 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:53,407 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:53,407 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:53,407 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:53,407 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:53,408 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,408 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,408 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,408 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,408 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:53,408 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:53,408 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:53,408 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:27:53,408 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:53,408 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:53,408 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:53,408 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:53,408 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:53,409 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:53,409 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:53,409 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:53,409 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:53,409 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:53,409 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:53,409 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,409 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,409 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,409 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,424 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:53,424 - src.hyperparameter_tuning - ERROR - Trial 1 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:53,425 - src.hyperparameter_tuning - INFO - Trial 2: 모델 타입 = xgboost
2025-06-24 09:27:53,429 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:53,430 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:53,430 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:53,430 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:53,430 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:53,430 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:53,430 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:53,430 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:53,430 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:53,431 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:53,431 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:53,431 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:53,431 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:53,431 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:53,431 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:53,431 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:53,431 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:53,431 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:53,432 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:53,432 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:53,432 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:53,432 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:53,432 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:53,432 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:53,432 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:53,432 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:53,432 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:53,432 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:53,436 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:53,438 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:53,438 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:53,438 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:53,438 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:53,438 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:53,438 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:53,438 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:53,440 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:53,442 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:53,442 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:53,442 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:53,442 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:53,442 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:53,442 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:53,442 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:53,442 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:53,442 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,442 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,443 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:53,443 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:53,443 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,443 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,443 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:53,443 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:53,443 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,443 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:53,443 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:53,443 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:53,444 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:53,444 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:53,444 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:53,444 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:53,444 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:53,444 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:53,444 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:53,444 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:53,444 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:53,444 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,444 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:53,445 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:53,445 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,445 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,445 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,445 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,445 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,445 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,446 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,446 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,446 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:53,446 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,446 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:53,446 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,446 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,446 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:53,446 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:53,446 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,446 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,447 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,447 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,447 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,447 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,447 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,447 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,447 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:53,447 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,447 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:53,448 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,448 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:53,448 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,448 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:53,448 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:53,448 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:53,448 - src.models.xgboost_model - INFO -   n_estimators: 460
2025-06-24 09:27:53,448 - src.models.xgboost_model - INFO -   max_depth: 6
2025-06-24 09:27:53,448 - src.models.xgboost_model - INFO -   learning_rate: 0.08012737503998542
2025-06-24 09:27:53,448 - src.models.xgboost_model - INFO -   subsample: 0.6557975442608167
2025-06-24 09:27:53,448 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7168578594140873
2025-06-24 09:27:53,448 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 09:27:53,448 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:53,448 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:53,448 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:53,448 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:53,448 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:53,448 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:53,448 - src.models.xgboost_model - INFO -   reg_alpha: 0.00012724181576752517
2025-06-24 09:27:53,448 - src.models.xgboost_model - INFO -   reg_lambda: 0.1165691561324743
2025-06-24 09:27:53,448 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:53,448 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:53,448 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:53,462 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:53,462 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:53,462 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:53,462 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:53,462 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,462 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,462 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,463 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,463 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,463 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,463 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,463 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,463 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:53,463 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,463 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:53,464 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:53,464 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:53,464 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:53,464 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:53,464 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,464 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:53,464 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:53,464 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:53,464 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:53,464 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:53,465 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:53,465 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:53,465 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,465 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,465 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,466 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,466 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:53,466 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:53,466 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:53,466 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:53,466 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:53,466 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:53,466 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:53,466 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:53,466 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:53,466 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:53,466 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:53,466 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:53,466 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:53,466 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:53,466 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:53,466 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,466 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,466 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,466 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,482 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:53,482 - src.hyperparameter_tuning - ERROR - Trial 2 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:53,483 - src.hyperparameter_tuning - INFO - Trial 3: 모델 타입 = xgboost
2025-06-24 09:27:53,487 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:53,487 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:53,487 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:53,487 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:53,487 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:53,487 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:53,487 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:53,487 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:53,487 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:53,488 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:53,488 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:53,488 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:53,488 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:53,488 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:53,488 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:53,488 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:53,488 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:53,488 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:53,489 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:53,489 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:53,489 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:53,489 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:53,489 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:53,489 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:53,489 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:53,489 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:53,489 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:53,489 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:53,493 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:53,495 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:53,495 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:53,495 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:53,495 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:53,495 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:53,495 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:53,495 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:53,497 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:53,499 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:53,499 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:53,499 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:53,499 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:53,499 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:53,499 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:53,499 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:53,499 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:53,499 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,499 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,499 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:53,499 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:53,499 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,499 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,499 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:53,499 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:53,499 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,500 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:53,500 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:53,500 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:53,501 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:53,501 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:53,501 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:53,501 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:53,501 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:53,501 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:53,501 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:53,501 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:53,501 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:53,501 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,501 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:53,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:53,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,501 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,502 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:53,502 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,503 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:53,503 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,503 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,503 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:53,503 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:53,503 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,503 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,503 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,503 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,503 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,503 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,504 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,504 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,504 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:53,504 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,504 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:53,504 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,504 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:53,504 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,504 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:53,505 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:53,505 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:53,505 - src.models.xgboost_model - INFO -   n_estimators: 539
2025-06-24 09:27:53,505 - src.models.xgboost_model - INFO -   max_depth: 10
2025-06-24 09:27:53,505 - src.models.xgboost_model - INFO -   learning_rate: 0.011711509955524094
2025-06-24 09:27:53,505 - src.models.xgboost_model - INFO -   subsample: 0.8430179407605753
2025-06-24 09:27:53,505 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6682096494749166
2025-06-24 09:27:53,505 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 09:27:53,505 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:53,505 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:53,505 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:53,505 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:53,505 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:53,505 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:53,505 - src.models.xgboost_model - INFO -   reg_alpha: 3.4671276804481113
2025-06-24 09:27:53,505 - src.models.xgboost_model - INFO -   reg_lambda: 4.905556676028774
2025-06-24 09:27:53,505 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:53,505 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:53,505 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:53,588 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:53,588 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:53,588 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:53,588 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:53,588 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,588 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,588 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,588 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,588 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,589 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,589 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,589 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,589 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:53,589 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,589 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:53,590 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:53,590 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:53,590 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:53,590 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:53,590 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,590 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:53,590 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:53,590 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:53,590 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:53,590 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:53,590 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:53,590 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:53,591 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,591 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,591 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,591 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,591 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:53,591 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:53,591 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:53,591 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:53,591 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:53,591 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:53,591 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:53,592 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:53,592 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:53,592 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:53,592 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:53,592 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:53,592 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:53,592 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:53,592 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:53,592 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,592 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,592 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,592 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,607 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:53,608 - src.hyperparameter_tuning - ERROR - Trial 3 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:53,609 - src.hyperparameter_tuning - INFO - Trial 4: 모델 타입 = xgboost
2025-06-24 09:27:53,612 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:53,613 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:53,613 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:53,613 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:53,613 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:53,613 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:53,613 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:53,613 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:53,613 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:53,613 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:53,613 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:53,613 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:53,613 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:53,613 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:53,614 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:53,614 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:53,614 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:53,614 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:53,614 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:53,615 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:53,615 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:53,615 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:53,615 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:53,615 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:53,615 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:53,615 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:53,615 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:53,615 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:53,618 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:53,620 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:53,620 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:53,620 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:53,620 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:53,620 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:53,620 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:53,620 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:53,622 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:53,624 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:53,624 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:53,624 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:53,624 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:53,624 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:53,624 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:53,624 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:53,624 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:53,624 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,624 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,625 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:53,625 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:53,625 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,625 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,625 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:53,625 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:53,625 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,626 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:53,626 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:53,626 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:53,626 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:53,626 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:53,626 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:53,626 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:53,626 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:53,626 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:53,626 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:53,626 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:53,626 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:53,627 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,627 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:53,627 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:53,627 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,627 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,627 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,627 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,627 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,627 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,628 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,628 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,628 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:53,628 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,628 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:53,628 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,628 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,628 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:53,628 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:53,628 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,628 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,629 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,629 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,629 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,629 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,629 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,629 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,629 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:53,629 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,630 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:53,630 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,630 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:53,630 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,630 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:53,630 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:53,630 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:53,630 - src.models.xgboost_model - INFO -   n_estimators: 339
2025-06-24 09:27:53,630 - src.models.xgboost_model - INFO -   max_depth: 4
2025-06-24 09:27:53,630 - src.models.xgboost_model - INFO -   learning_rate: 0.1024932221692416
2025-06-24 09:27:53,630 - src.models.xgboost_model - INFO -   subsample: 0.7760609974958406
2025-06-24 09:27:53,630 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6488152939379115
2025-06-24 09:27:53,630 - src.models.xgboost_model - INFO -   min_child_weight: 5
2025-06-24 09:27:53,630 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:53,630 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:53,630 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:53,630 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:53,630 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:53,630 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:53,630 - src.models.xgboost_model - INFO -   reg_alpha: 2.039373116525212e-08
2025-06-24 09:27:53,630 - src.models.xgboost_model - INFO -   reg_lambda: 1.527156759251193
2025-06-24 09:27:53,630 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:53,630 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:53,630 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:53,644 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:53,644 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:53,644 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:53,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:53,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,645 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,645 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,645 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,645 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,645 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,645 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,645 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,646 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:53,646 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,646 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:53,646 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:53,646 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:53,646 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:53,647 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:53,647 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,647 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:53,647 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:53,647 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:53,647 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:53,647 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:53,647 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:53,647 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:53,647 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,647 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,648 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,648 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,648 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:53,648 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:53,648 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:53,648 - src.training - INFO -   accuracy: 0.984
2025-06-24 09:27:53,648 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:53,648 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:53,648 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:53,648 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:53,648 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:53,648 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:53,648 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:53,648 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:53,648 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:53,648 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:53,648 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.984, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:53,648 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,648 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,648 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,648 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,664 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:53,664 - src.hyperparameter_tuning - ERROR - Trial 4 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:53,665 - src.hyperparameter_tuning - INFO - Trial 5: 모델 타입 = xgboost
2025-06-24 09:27:53,668 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:53,669 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:53,669 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:53,669 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:53,669 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:53,669 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:53,669 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:53,669 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:53,669 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:53,670 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:53,670 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:53,670 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:53,670 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:53,670 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:53,670 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:53,670 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:53,670 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:53,670 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:53,671 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:53,671 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:53,671 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:53,671 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:53,671 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:53,671 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:53,671 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:53,671 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:53,671 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:53,671 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:53,674 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:53,677 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:53,677 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:53,677 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:53,677 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:53,677 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:53,677 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:53,677 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:53,679 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:53,681 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:53,681 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:53,681 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:53,681 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:53,681 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:53,681 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:53,681 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:53,681 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:53,681 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,681 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,681 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:53,681 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:53,681 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,681 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,681 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:53,681 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:53,681 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,682 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:53,682 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:53,682 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:53,683 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:53,683 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:53,683 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:53,683 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:53,683 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:53,683 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:53,683 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:53,683 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:53,683 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:53,683 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,683 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:53,683 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:53,683 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,683 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,684 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,684 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,684 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,684 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,684 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,684 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,684 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:53,684 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,685 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:53,685 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,685 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,685 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:53,685 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:53,685 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,685 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,685 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,685 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,685 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,686 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,686 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,686 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,686 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:53,686 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,686 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:53,686 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,686 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:53,686 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,686 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:53,687 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:53,687 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:53,687 - src.models.xgboost_model - INFO -   n_estimators: 680
2025-06-24 09:27:53,687 - src.models.xgboost_model - INFO -   max_depth: 7
2025-06-24 09:27:53,687 - src.models.xgboost_model - INFO -   learning_rate: 0.05864129169696527
2025-06-24 09:27:53,687 - src.models.xgboost_model - INFO -   subsample: 0.8186841117373118
2025-06-24 09:27:53,687 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6739417822102108
2025-06-24 09:27:53,687 - src.models.xgboost_model - INFO -   min_child_weight: 10
2025-06-24 09:27:53,687 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:53,687 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:53,687 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:53,687 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:53,687 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:53,687 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:53,687 - src.models.xgboost_model - INFO -   reg_alpha: 0.09466630153726856
2025-06-24 09:27:53,687 - src.models.xgboost_model - INFO -   reg_lambda: 2.854239907497756
2025-06-24 09:27:53,687 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:53,687 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:53,687 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:53,706 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:53,706 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:53,706 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:53,706 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:53,706 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,706 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,706 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,706 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,706 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,707 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,707 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,707 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,707 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:53,707 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,707 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:53,708 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:53,708 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:53,708 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:53,708 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:53,708 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,708 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:53,708 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:53,708 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:53,708 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:53,708 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:53,708 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:53,708 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:53,709 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,709 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,709 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,709 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,709 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:53,709 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:53,709 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:53,709 - src.training - INFO -   accuracy: 0.972
2025-06-24 09:27:53,709 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:53,709 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:53,709 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:53,709 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:53,709 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:53,710 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:53,710 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:53,710 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:53,710 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:53,710 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:53,710 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.972, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:53,710 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,710 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,710 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,710 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,725 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:53,725 - src.hyperparameter_tuning - ERROR - Trial 5 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:53,726 - src.hyperparameter_tuning - INFO - Trial 6: 모델 타입 = xgboost
2025-06-24 09:27:53,729 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:53,730 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:53,730 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:53,730 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:53,730 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:53,730 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:53,730 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:53,730 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:53,730 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:53,731 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:53,731 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:53,731 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:53,731 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:53,731 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:53,731 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:53,731 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:53,731 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:53,731 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:53,732 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:53,732 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:53,732 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:53,732 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:53,732 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:53,732 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:53,732 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:53,732 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:53,732 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:53,732 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:53,735 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:53,737 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:53,737 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:53,737 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:53,737 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:53,737 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:53,737 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:53,737 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:53,740 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:53,741 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:53,741 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:53,742 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:53,742 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:53,742 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:53,742 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:53,742 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:53,742 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:53,742 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,742 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,742 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:53,742 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:53,742 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,742 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,742 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:53,742 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:53,742 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,743 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:53,743 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:53,743 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:53,744 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:53,744 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:53,744 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:53,744 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:53,744 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:53,744 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:53,744 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:53,744 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:53,744 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:53,744 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,744 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:53,744 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:53,744 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,744 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,744 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,744 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,745 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,745 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,745 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,745 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,745 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:53,745 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,745 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:53,745 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,745 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,745 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:53,745 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:53,745 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,746 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,746 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,746 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,746 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,746 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,746 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,746 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,747 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:53,747 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,747 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:53,747 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,747 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:53,747 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,747 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:53,747 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:53,747 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:53,747 - src.models.xgboost_model - INFO -   n_estimators: 618
2025-06-24 09:27:53,747 - src.models.xgboost_model - INFO -   max_depth: 14
2025-06-24 09:27:53,747 - src.models.xgboost_model - INFO -   learning_rate: 0.01351182947645082
2025-06-24 09:27:53,747 - src.models.xgboost_model - INFO -   subsample: 0.6783931449676581
2025-06-24 09:27:53,747 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6180909155642152
2025-06-24 09:27:53,747 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 09:27:53,747 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:53,747 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:53,747 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:53,748 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:53,748 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:53,748 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:53,748 - src.models.xgboost_model - INFO -   reg_alpha: 3.148441347423712e-05
2025-06-24 09:27:53,748 - src.models.xgboost_model - INFO -   reg_lambda: 2.7678419414850017e-06
2025-06-24 09:27:53,748 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:53,748 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:53,748 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:53,826 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:53,826 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:53,826 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:53,826 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:53,826 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,826 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,826 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,826 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,826 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,827 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,827 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,827 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,827 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:53,827 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,827 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:53,828 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:53,828 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:53,828 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:53,828 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:53,828 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,828 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:53,828 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:53,828 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:53,828 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:53,828 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:53,828 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:53,828 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:53,829 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,829 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,829 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,829 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,829 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:53,829 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:53,829 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:53,829 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:27:53,829 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:53,829 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:53,829 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:53,830 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:53,830 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:53,830 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:53,830 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:53,830 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:53,830 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:53,830 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:53,830 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:53,830 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,830 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,830 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,830 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,846 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:53,846 - src.hyperparameter_tuning - ERROR - Trial 6 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:53,847 - src.hyperparameter_tuning - INFO - Trial 7: 모델 타입 = xgboost
2025-06-24 09:27:53,850 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:53,851 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:53,851 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:53,851 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:53,851 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:53,851 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:53,851 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:53,851 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:53,851 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:53,851 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:53,851 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:53,851 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:53,851 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:53,851 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:53,851 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:53,851 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:53,851 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:53,851 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:53,852 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:53,852 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:53,852 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:53,852 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:53,852 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:53,852 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:53,852 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:53,852 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:53,852 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:53,852 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:53,856 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:53,858 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:53,858 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:53,858 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:53,858 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:53,858 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:53,858 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:53,858 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:53,860 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:53,862 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:53,862 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:53,862 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:53,862 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:53,862 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:53,862 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:53,862 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:53,862 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:53,862 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,862 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,863 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:53,863 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:53,863 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,863 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,863 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:53,863 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:53,863 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,863 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:53,864 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:53,864 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:53,864 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:53,864 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:53,864 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:53,864 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:53,864 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:53,864 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:53,864 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:53,864 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:53,864 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:53,864 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,864 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:53,865 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:53,865 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,865 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,865 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,865 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,865 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,865 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,866 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,866 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,866 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:53,866 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,866 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:53,866 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,866 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,866 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:53,866 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:53,866 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,866 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,867 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,867 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,867 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,867 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,867 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,867 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,867 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:53,867 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:53,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,868 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:53,868 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,868 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:53,868 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:53,868 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:53,868 - src.models.xgboost_model - INFO -   n_estimators: 389
2025-06-24 09:27:53,868 - src.models.xgboost_model - INFO -   max_depth: 6
2025-06-24 09:27:53,868 - src.models.xgboost_model - INFO -   learning_rate: 0.06333268775321842
2025-06-24 09:27:53,868 - src.models.xgboost_model - INFO -   subsample: 0.6563696899899051
2025-06-24 09:27:53,868 - src.models.xgboost_model - INFO -   colsample_bytree: 0.9208787923016158
2025-06-24 09:27:53,868 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 09:27:53,868 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:53,868 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:53,868 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:53,868 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:53,868 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:53,868 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:53,868 - src.models.xgboost_model - INFO -   reg_alpha: 7.620481786158549
2025-06-24 09:27:53,868 - src.models.xgboost_model - INFO -   reg_lambda: 0.08916674715636537
2025-06-24 09:27:53,868 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:53,868 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:53,868 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:53,886 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:53,886 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:53,886 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:53,886 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:53,886 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,887 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,887 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,887 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,887 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,887 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,887 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,888 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,888 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:53,888 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,888 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:53,890 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:53,890 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:53,890 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:53,890 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:53,890 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,890 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:53,890 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:53,890 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:53,891 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:53,891 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:53,891 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:53,891 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:53,891 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,891 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,891 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,892 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,892 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:53,892 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:53,892 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:53,892 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:53,892 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:53,892 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:53,892 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:53,892 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:53,892 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:53,892 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:53,892 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:53,892 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:53,892 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:53,892 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:53,892 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:53,892 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,892 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,892 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,892 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,908 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:53,908 - src.hyperparameter_tuning - ERROR - Trial 7 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:53,909 - src.hyperparameter_tuning - INFO - Trial 8: 모델 타입 = xgboost
2025-06-24 09:27:53,913 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:53,913 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:53,913 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:53,913 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:53,913 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:53,913 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:53,913 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:53,913 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:53,913 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:53,914 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:53,914 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:53,914 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:53,914 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:53,914 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:53,914 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:53,914 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:53,914 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:53,914 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:53,915 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:53,915 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:53,915 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:53,915 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:53,915 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:53,915 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:53,915 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:53,915 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:53,915 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:53,915 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:53,919 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:53,921 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:53,921 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:53,921 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:53,921 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:53,921 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:53,921 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:53,921 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:53,923 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:53,925 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:53,925 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:53,925 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:53,925 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:53,925 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:53,925 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:53,925 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:53,925 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:53,925 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,925 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,925 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:53,925 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:53,925 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,925 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,925 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:53,925 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:53,926 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,926 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:53,926 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:53,926 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:53,927 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:53,927 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:53,927 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:53,927 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:53,927 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:53,927 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:53,927 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:53,927 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:53,927 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:53,927 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,927 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:53,927 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:53,927 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,927 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,928 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,928 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,928 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,928 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,928 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,928 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,928 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:53,928 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,929 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:53,929 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,929 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,929 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:53,929 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:53,929 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,929 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,929 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,929 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,929 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,930 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:53,930 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,930 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:53,930 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,930 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:53,930 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,930 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:53,931 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:53,931 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:53,931 - src.models.xgboost_model - INFO -   n_estimators: 55
2025-06-24 09:27:53,931 - src.models.xgboost_model - INFO -   max_depth: 13
2025-06-24 09:27:53,931 - src.models.xgboost_model - INFO -   learning_rate: 0.11069143219393454
2025-06-24 09:27:53,931 - src.models.xgboost_model - INFO -   subsample: 0.8916028672163949
2025-06-24 09:27:53,931 - src.models.xgboost_model - INFO -   colsample_bytree: 0.9085081386743783
2025-06-24 09:27:53,931 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 09:27:53,931 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:53,931 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:53,931 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:53,931 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:53,931 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:53,931 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:53,931 - src.models.xgboost_model - INFO -   reg_alpha: 1.683416412018213e-05
2025-06-24 09:27:53,931 - src.models.xgboost_model - INFO -   reg_lambda: 1.1036250149900698e-07
2025-06-24 09:27:53,931 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:53,931 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:53,931 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:53,944 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:53,944 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:53,944 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:53,944 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:53,944 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,944 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,945 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,945 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,945 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,945 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,945 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,945 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,945 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:53,945 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,946 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:53,946 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:53,946 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:53,946 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:53,946 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:53,946 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,946 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:53,946 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:53,946 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:53,947 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:53,947 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:53,947 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:53,947 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:53,947 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,947 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,947 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,948 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:53,948 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:53,948 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:53,948 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:53,948 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:27:53,948 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:53,948 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:53,948 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:53,948 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:53,948 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:53,948 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:53,948 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:53,948 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:53,948 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:53,948 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:53,948 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:53,948 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,948 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,948 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,948 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,964 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:53,964 - src.hyperparameter_tuning - ERROR - Trial 8 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:53,965 - src.hyperparameter_tuning - INFO - Trial 9: 모델 타입 = xgboost
2025-06-24 09:27:53,968 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:53,969 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:53,969 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:53,969 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:53,969 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:53,969 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:53,969 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:53,969 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:53,969 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:53,970 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:53,970 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:53,970 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:53,970 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:53,970 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:53,970 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:53,970 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:53,970 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:53,970 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:53,971 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:53,971 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:53,971 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:53,971 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:53,971 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:53,971 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:53,971 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:53,971 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:53,971 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:53,971 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:53,974 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:53,977 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:53,977 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:53,977 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:53,977 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:53,977 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:53,977 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:53,977 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:53,979 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:53,981 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:53,981 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:53,981 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:53,981 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:53,981 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:53,981 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:53,981 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:53,981 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:53,981 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,981 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,981 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:53,981 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:53,981 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,981 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,981 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:53,981 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:53,981 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,982 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:53,982 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:53,982 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:53,983 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:53,983 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:53,983 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:53,983 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:53,983 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:53,983 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:53,983 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:53,983 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:53,983 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:53,983 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,983 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:53,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:53,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,984 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,984 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:53,984 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,985 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:53,985 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,985 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,985 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:53,985 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:53,985 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,985 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:53,985 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:53,985 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:53,985 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:53,986 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:53,986 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:53,986 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:53,986 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:53,986 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:53,986 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:53,986 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,986 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:53,986 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:53,986 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:53,987 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:53,987 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:53,987 - src.models.xgboost_model - INFO -   n_estimators: 642
2025-06-24 09:27:53,987 - src.models.xgboost_model - INFO -   max_depth: 7
2025-06-24 09:27:53,987 - src.models.xgboost_model - INFO -   learning_rate: 0.012413189635294229
2025-06-24 09:27:53,987 - src.models.xgboost_model - INFO -   subsample: 0.7243929286862649
2025-06-24 09:27:53,987 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7300733288106989
2025-06-24 09:27:53,987 - src.models.xgboost_model - INFO -   min_child_weight: 8
2025-06-24 09:27:53,987 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:53,987 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:53,987 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:53,987 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:53,987 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:53,987 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:53,987 - src.models.xgboost_model - INFO -   reg_alpha: 0.005470376807480391
2025-06-24 09:27:53,987 - src.models.xgboost_model - INFO -   reg_lambda: 0.9658611176861268
2025-06-24 09:27:53,987 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:53,987 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:53,987 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:54,045 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:54,045 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:54,045 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:54,045 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,045 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,045 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,046 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,046 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,046 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,047 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:54,047 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:54,047 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:54,047 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:54,047 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:54,047 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,047 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:54,047 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:54,047 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:54,048 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:54,048 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:54,048 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:54,048 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:54,048 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,048 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,048 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,049 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,049 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:54,049 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:54,049 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:54,049 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:54,049 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:54,049 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:54,049 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:54,049 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:54,049 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:54,049 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:54,049 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:54,049 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:54,049 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:54,049 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:54,049 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:54,049 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,049 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,049 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,049 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,065 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:54,066 - src.hyperparameter_tuning - ERROR - Trial 9 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:54,079 - src.hyperparameter_tuning - INFO - Trial 10: 모델 타입 = xgboost
2025-06-24 09:27:54,082 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:54,083 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:54,083 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:54,083 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:54,083 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:54,083 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:54,083 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:54,083 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:54,083 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:54,083 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:54,083 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:54,083 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:54,083 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:54,083 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:54,083 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:54,083 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:54,083 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:54,083 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:54,084 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,084 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,084 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,084 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,084 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,084 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:54,084 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:54,084 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:54,085 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:54,085 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:54,088 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:54,090 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,090 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:54,090 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:54,090 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:54,090 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:54,090 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:54,090 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,092 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,094 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:54,094 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,094 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,094 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,094 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,094 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,094 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,094 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:54,094 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,094 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,095 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:54,095 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:54,095 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,095 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,095 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:54,095 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:54,095 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,095 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,096 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,096 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:54,096 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:54,096 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:54,096 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:54,096 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:54,096 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:54,096 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:54,096 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:54,096 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:54,096 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:54,097 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,097 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:54,097 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:54,097 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,097 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,097 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,097 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,097 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,097 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,098 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,098 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,098 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:54,098 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,098 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:54,098 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,098 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,098 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:54,098 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,098 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,098 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,099 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,099 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,099 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,099 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,099 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,099 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,099 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,099 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,100 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:54,100 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,100 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:54,100 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,100 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:54,100 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:54,100 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:54,100 - src.models.xgboost_model - INFO -   n_estimators: 948
2025-06-24 09:27:54,100 - src.models.xgboost_model - INFO -   max_depth: 11
2025-06-24 09:27:54,100 - src.models.xgboost_model - INFO -   learning_rate: 0.028477486830279865
2025-06-24 09:27:54,100 - src.models.xgboost_model - INFO -   subsample: 0.9729161367647149
2025-06-24 09:27:54,100 - src.models.xgboost_model - INFO -   colsample_bytree: 0.8085360047450805
2025-06-24 09:27:54,100 - src.models.xgboost_model - INFO -   min_child_weight: 7
2025-06-24 09:27:54,100 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:54,100 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:54,100 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:54,100 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:54,100 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:54,100 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:54,100 - src.models.xgboost_model - INFO -   reg_alpha: 1.3686680646913267e-08
2025-06-24 09:27:54,100 - src.models.xgboost_model - INFO -   reg_lambda: 0.004077450220493048
2025-06-24 09:27:54,100 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:54,100 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:54,100 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:54,135 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:54,135 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:54,135 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:54,135 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,135 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,135 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,135 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,135 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,135 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,136 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,136 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,136 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,136 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,136 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,136 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:54,137 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:54,137 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:54,137 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:54,137 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:54,137 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,137 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:54,137 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:54,137 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:54,137 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:54,137 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:54,137 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:54,137 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:54,137 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,138 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,138 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,138 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,138 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:54,138 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:54,138 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:54,138 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:54,138 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:54,138 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:54,138 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:54,138 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:54,138 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:54,138 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:54,138 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:54,138 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:54,138 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:54,139 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:54,139 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:54,139 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,139 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,139 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,139 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,155 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:54,155 - src.hyperparameter_tuning - ERROR - Trial 10 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:54,169 - src.hyperparameter_tuning - INFO - Trial 11: 모델 타입 = xgboost
2025-06-24 09:27:54,172 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:54,172 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:54,172 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:54,172 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:54,172 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:54,172 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:54,172 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:54,172 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:54,172 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:54,173 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:54,173 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:54,173 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:54,173 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:54,173 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:54,173 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:54,173 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:54,173 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:54,173 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:54,174 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,174 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,174 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,174 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,174 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,174 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:54,174 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:54,174 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:54,174 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:54,174 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:54,178 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:54,180 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,180 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:54,180 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:54,180 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:54,180 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:54,180 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:54,180 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,182 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,184 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:54,184 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,184 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,184 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,184 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,184 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,184 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,184 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:54,184 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,184 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,185 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:54,185 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:54,185 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,185 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,185 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:54,185 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:54,185 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,185 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,185 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,185 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:54,186 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:54,186 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:54,186 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:54,186 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:54,186 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:54,186 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:54,186 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:54,186 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:54,186 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:54,186 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,186 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:54,186 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:54,186 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,187 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,187 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,187 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,187 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,187 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,187 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,188 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,188 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:54,188 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,188 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:54,188 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,188 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,188 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:54,188 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,188 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,188 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,188 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,189 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,189 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,189 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,189 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,189 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,189 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,189 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,189 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:54,189 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,189 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:54,189 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,189 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:54,190 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:54,190 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:54,190 - src.models.xgboost_model - INFO -   n_estimators: 838
2025-06-24 09:27:54,190 - src.models.xgboost_model - INFO -   max_depth: 3
2025-06-24 09:27:54,190 - src.models.xgboost_model - INFO -   learning_rate: 0.26817078508151854
2025-06-24 09:27:54,190 - src.models.xgboost_model - INFO -   subsample: 0.9481474318740984
2025-06-24 09:27:54,190 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7971457481268196
2025-06-24 09:27:54,190 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 09:27:54,190 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:54,190 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:54,190 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:54,190 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:54,190 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:54,190 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:54,190 - src.models.xgboost_model - INFO -   reg_alpha: 1.018249387319176e-06
2025-06-24 09:27:54,190 - src.models.xgboost_model - INFO -   reg_lambda: 3.975631426149656e-05
2025-06-24 09:27:54,190 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:54,190 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:54,190 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:54,198 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:54,198 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:54,198 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:54,198 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,198 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,198 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,198 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,198 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,199 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,199 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,199 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,199 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,199 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,199 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,199 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:54,200 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:54,200 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:54,200 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:54,200 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:54,200 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,200 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:54,200 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:54,200 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:54,200 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:54,200 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:54,200 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:54,200 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:54,201 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,201 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,201 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,201 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,201 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:54,201 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:54,201 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:54,201 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:54,201 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:54,201 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:54,201 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:54,201 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:54,202 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:54,202 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:54,202 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:54,202 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:54,202 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:54,202 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:54,202 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:54,202 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,202 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,202 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,202 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,218 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:54,218 - src.hyperparameter_tuning - ERROR - Trial 11 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:54,232 - src.hyperparameter_tuning - INFO - Trial 12: 모델 타입 = xgboost
2025-06-24 09:27:54,235 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:54,235 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:54,235 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:54,235 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:54,235 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:54,235 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:54,235 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:54,236 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:54,236 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:54,236 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:54,236 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:54,236 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:54,236 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:54,236 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:54,236 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:54,236 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:54,236 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:54,236 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:54,237 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,237 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,237 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,237 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,237 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,237 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:54,237 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:54,237 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:54,237 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:54,237 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:54,241 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:54,243 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,243 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:54,243 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:54,243 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:54,243 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:54,243 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:54,243 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,245 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,247 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:54,247 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,247 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,247 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,247 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,247 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,247 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,247 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:54,247 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,247 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,248 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:54,248 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:54,248 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,248 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,248 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:54,248 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:54,248 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,248 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,248 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,248 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:54,249 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:54,249 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:54,249 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:54,249 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:54,249 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:54,249 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:54,249 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:54,249 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:54,249 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:54,249 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,249 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:54,249 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:54,249 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,250 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,250 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,250 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,250 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,250 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,250 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,251 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,251 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:54,251 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,251 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:54,251 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,251 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,251 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:54,251 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,251 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,251 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,251 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,252 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,252 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,252 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,252 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,252 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,252 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,252 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,252 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:54,252 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,252 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:54,252 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,252 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:54,253 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:54,253 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:54,253 - src.models.xgboost_model - INFO -   n_estimators: 234
2025-06-24 09:27:54,253 - src.models.xgboost_model - INFO -   max_depth: 15
2025-06-24 09:27:54,253 - src.models.xgboost_model - INFO -   learning_rate: 0.25883506810244084
2025-06-24 09:27:54,253 - src.models.xgboost_model - INFO -   subsample: 0.8884170683398009
2025-06-24 09:27:54,253 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7874820875551369
2025-06-24 09:27:54,253 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 09:27:54,253 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:54,253 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:54,253 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:54,253 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:54,253 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:54,253 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:54,253 - src.models.xgboost_model - INFO -   reg_alpha: 1.6858448300255918e-06
2025-06-24 09:27:54,253 - src.models.xgboost_model - INFO -   reg_lambda: 0.00038695297511260837
2025-06-24 09:27:54,253 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:54,253 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:54,253 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:54,262 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:54,262 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:54,262 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:54,262 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,262 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,263 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,263 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,263 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,263 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,263 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,263 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,264 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,264 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,264 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,264 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:54,265 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:54,265 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:54,265 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:54,265 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:54,265 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,265 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:54,265 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:54,265 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:54,265 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:54,265 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:54,265 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:54,265 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:54,265 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,266 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,266 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,266 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,266 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:54,266 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:54,266 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:54,266 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:54,266 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:54,266 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:54,266 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:54,266 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:54,266 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:54,266 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:54,266 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:54,266 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:54,266 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:54,267 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:54,267 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:54,267 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,267 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,267 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,267 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,283 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:54,283 - src.hyperparameter_tuning - ERROR - Trial 12 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:54,297 - src.hyperparameter_tuning - INFO - Trial 13: 모델 타입 = xgboost
2025-06-24 09:27:54,300 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:54,301 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:54,301 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:54,301 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:54,301 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:54,301 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:54,301 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:54,301 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:54,301 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:54,301 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:54,302 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:54,302 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:54,302 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:54,302 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:54,302 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:54,302 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:54,302 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:54,302 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:54,303 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,303 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,303 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,303 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,303 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,303 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:54,303 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:54,303 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:54,303 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:54,303 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:54,306 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:54,308 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,308 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:54,308 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:54,308 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:54,308 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:54,308 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:54,308 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,310 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,312 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:54,312 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,312 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,312 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,312 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,312 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,312 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,313 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:54,313 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,313 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,313 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:54,313 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:54,313 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,313 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,313 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:54,313 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:54,313 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,314 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,314 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,314 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:54,315 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:54,315 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:54,315 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:54,315 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:54,315 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:54,315 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:54,315 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:54,315 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:54,315 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:54,315 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,315 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:54,315 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:54,315 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,315 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,315 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,315 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,315 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,316 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,316 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,316 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,316 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:54,316 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,316 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:54,316 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,316 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,316 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:54,316 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,316 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,317 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,317 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,317 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,317 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,317 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,317 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,317 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,317 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,317 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,318 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:54,318 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,318 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:54,318 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,318 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:54,318 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:54,318 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:54,318 - src.models.xgboost_model - INFO -   n_estimators: 844
2025-06-24 09:27:54,318 - src.models.xgboost_model - INFO -   max_depth: 11
2025-06-24 09:27:54,318 - src.models.xgboost_model - INFO -   learning_rate: 0.15995102405445347
2025-06-24 09:27:54,318 - src.models.xgboost_model - INFO -   subsample: 0.9997449754566204
2025-06-24 09:27:54,318 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6021809558214184
2025-06-24 09:27:54,318 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 09:27:54,318 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:54,318 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:54,318 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:54,318 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:54,318 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:54,318 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:54,318 - src.models.xgboost_model - INFO -   reg_alpha: 3.9514246158876435e-07
2025-06-24 09:27:54,318 - src.models.xgboost_model - INFO -   reg_lambda: 3.429292381773519e-07
2025-06-24 09:27:54,318 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:54,318 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:54,319 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:54,340 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:54,340 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:54,340 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:54,340 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,340 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,340 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,340 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,340 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,341 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,341 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,341 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,341 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,341 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,341 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,341 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:54,342 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:54,342 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:54,342 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:54,342 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:54,342 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,342 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:54,342 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:54,342 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:54,342 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:54,342 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:54,342 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:54,342 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:54,343 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,343 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,343 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,343 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,343 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:54,343 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:54,343 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:54,343 - src.training - INFO -   accuracy: 0.984
2025-06-24 09:27:54,344 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:54,344 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:54,344 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:54,344 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:54,344 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:54,344 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:54,344 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:54,344 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:54,344 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:54,344 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:54,344 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.984, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:54,344 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,344 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,344 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,344 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,361 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:54,361 - src.hyperparameter_tuning - ERROR - Trial 13 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:54,374 - src.hyperparameter_tuning - INFO - Trial 14: 모델 타입 = xgboost
2025-06-24 09:27:54,377 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:54,378 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:54,378 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:54,378 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:54,378 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:54,378 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:54,378 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:54,378 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:54,378 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:54,379 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:54,379 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:54,379 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:54,379 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:54,379 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:54,379 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:54,379 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:54,379 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:54,379 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:54,380 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,380 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,380 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,380 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,380 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,380 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:54,380 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:54,380 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:54,380 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:54,380 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:54,384 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:54,386 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,386 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:54,386 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:54,386 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:54,386 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:54,386 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:54,386 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,388 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,390 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:54,390 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,390 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,390 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,390 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,390 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,390 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,390 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:54,390 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,390 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,391 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:54,391 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:54,391 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,391 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,391 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:54,391 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:54,391 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,392 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,392 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,392 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:54,392 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:54,392 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:54,393 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:54,393 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:54,393 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:54,393 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:54,393 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:54,393 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:54,393 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:54,393 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,393 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:54,393 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:54,393 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,393 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,393 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,393 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,393 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,394 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,394 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,394 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,394 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:54,394 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,394 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:54,394 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,394 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,394 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:54,394 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,394 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,394 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,395 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,395 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,395 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,395 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,395 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,395 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,395 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,395 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,396 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:54,396 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,396 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:54,396 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,396 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:54,396 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:54,396 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:54,396 - src.models.xgboost_model - INFO -   n_estimators: 199
2025-06-24 09:27:54,396 - src.models.xgboost_model - INFO -   max_depth: 9
2025-06-24 09:27:54,396 - src.models.xgboost_model - INFO -   learning_rate: 0.17080659935001277
2025-06-24 09:27:54,396 - src.models.xgboost_model - INFO -   subsample: 0.9115356811308601
2025-06-24 09:27:54,396 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7337344348736515
2025-06-24 09:27:54,396 - src.models.xgboost_model - INFO -   min_child_weight: 6
2025-06-24 09:27:54,396 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:54,396 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:54,396 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:54,396 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:54,396 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:54,396 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:54,396 - src.models.xgboost_model - INFO -   reg_alpha: 4.4977900234236005e-08
2025-06-24 09:27:54,396 - src.models.xgboost_model - INFO -   reg_lambda: 1.6381830181950573e-05
2025-06-24 09:27:54,396 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:54,396 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:54,397 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:54,406 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:54,406 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:54,406 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:54,406 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,406 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,406 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,406 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,406 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,407 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,407 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,407 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,407 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,407 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,407 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,407 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:54,408 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:54,408 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:54,408 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:54,408 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:54,408 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,408 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:54,408 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:54,408 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:54,408 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:54,408 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:54,408 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:54,408 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:54,409 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,409 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,409 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,409 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,409 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:54,409 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:54,409 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:54,409 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:54,409 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:54,409 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:54,409 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:54,409 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:54,409 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:54,410 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:54,410 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:54,410 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:54,410 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:54,410 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:54,410 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:54,410 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,410 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,410 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,410 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,427 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:54,427 - src.hyperparameter_tuning - ERROR - Trial 14 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:54,441 - src.hyperparameter_tuning - INFO - Trial 15: 모델 타입 = xgboost
2025-06-24 09:27:54,444 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:54,444 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:54,444 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:54,444 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:54,444 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:54,444 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:54,444 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:54,444 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:54,444 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:54,445 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:54,445 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:54,445 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:54,445 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:54,445 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:54,445 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:54,445 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:54,445 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:54,445 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:54,446 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,446 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,446 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,446 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,446 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,446 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:54,446 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:54,446 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:54,446 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:54,446 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:54,450 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:54,452 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,452 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:54,452 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:54,452 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:54,452 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:54,452 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:54,452 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,454 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,456 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:54,456 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,456 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,456 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,456 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,456 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,456 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,456 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:54,456 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,456 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,456 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:54,456 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:54,456 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,457 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,457 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:54,457 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:54,457 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,457 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,457 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,457 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:54,458 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:54,458 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:54,458 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:54,458 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:54,458 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:54,458 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:54,458 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:54,458 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:54,458 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:54,458 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,458 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:54,458 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:54,458 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,458 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,459 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,459 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,459 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,459 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,459 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,459 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,459 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:54,460 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,460 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:54,460 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,460 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,460 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:54,460 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,460 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,460 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,460 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,460 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,460 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,461 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,461 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,461 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,461 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,461 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,461 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:54,461 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,461 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:54,461 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,461 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:54,462 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:54,462 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:54,462 - src.models.xgboost_model - INFO -   n_estimators: 768
2025-06-24 09:27:54,462 - src.models.xgboost_model - INFO -   max_depth: 13
2025-06-24 09:27:54,462 - src.models.xgboost_model - INFO -   learning_rate: 0.16625944364237574
2025-06-24 09:27:54,462 - src.models.xgboost_model - INFO -   subsample: 0.7634072550781038
2025-06-24 09:27:54,462 - src.models.xgboost_model - INFO -   colsample_bytree: 0.857356555876742
2025-06-24 09:27:54,462 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 09:27:54,462 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:54,462 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:54,462 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:54,462 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:54,462 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:54,462 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:54,462 - src.models.xgboost_model - INFO -   reg_alpha: 0.001837758412974711
2025-06-24 09:27:54,462 - src.models.xgboost_model - INFO -   reg_lambda: 1.3790926312136672e-08
2025-06-24 09:27:54,462 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:54,462 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:54,462 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:54,471 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:54,471 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:54,471 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:54,471 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,471 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,471 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,471 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,471 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,471 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,472 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,472 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,472 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,472 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,472 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,472 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:54,473 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:54,473 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:54,473 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:54,473 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:54,473 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,473 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:54,473 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:54,473 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:54,473 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:54,473 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:54,473 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:54,473 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:54,473 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,474 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,474 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,474 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,474 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:54,474 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:54,474 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:54,474 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:54,474 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:54,474 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:54,474 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:54,474 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:54,474 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:54,474 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:54,474 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:54,474 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:54,474 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:54,475 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:54,475 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:54,475 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,475 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,475 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,475 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,492 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:54,492 - src.hyperparameter_tuning - ERROR - Trial 15 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:54,505 - src.hyperparameter_tuning - INFO - Trial 16: 모델 타입 = xgboost
2025-06-24 09:27:54,509 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:54,509 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:54,509 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:54,509 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:54,509 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:54,509 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:54,509 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:54,509 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:54,509 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:54,510 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:54,510 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:54,510 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:54,510 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:54,510 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:54,510 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:54,510 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:54,510 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:54,510 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:54,511 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,511 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,511 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,511 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,511 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,511 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:54,511 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:54,511 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:54,511 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:54,511 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:54,515 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:54,517 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,517 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:54,517 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:54,517 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:54,517 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:54,517 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:54,517 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,519 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,521 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:54,521 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,521 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,521 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,521 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,521 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,521 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,521 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:54,521 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,521 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,521 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:54,521 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:54,521 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,521 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,521 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:54,521 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:54,521 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,522 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,522 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,522 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:54,523 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:54,523 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:54,523 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:54,523 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:54,523 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:54,523 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:54,523 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:54,523 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:54,523 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:54,523 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,523 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:54,523 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:54,523 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,523 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,524 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,524 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,524 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,524 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,524 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,524 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,524 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:54,524 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,525 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:54,525 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,525 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,525 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:54,525 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,525 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,525 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,525 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,525 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,525 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,525 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,526 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,526 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,526 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,526 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,526 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:54,526 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,526 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:54,526 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,526 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:54,527 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:54,527 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:54,527 - src.models.xgboost_model - INFO -   n_estimators: 520
2025-06-24 09:27:54,527 - src.models.xgboost_model - INFO -   max_depth: 4
2025-06-24 09:27:54,527 - src.models.xgboost_model - INFO -   learning_rate: 0.03167502366659872
2025-06-24 09:27:54,527 - src.models.xgboost_model - INFO -   subsample: 0.8503991699305872
2025-06-24 09:27:54,527 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7019847524469807
2025-06-24 09:27:54,527 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 09:27:54,527 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:54,527 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:54,527 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:54,527 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:54,527 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:54,527 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:54,527 - src.models.xgboost_model - INFO -   reg_alpha: 2.754291235426171e-07
2025-06-24 09:27:54,527 - src.models.xgboost_model - INFO -   reg_lambda: 0.0021118373797918487
2025-06-24 09:27:54,527 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:54,527 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:54,527 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:54,556 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:54,556 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:54,556 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:54,556 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,556 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,557 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,558 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,558 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:54,558 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:54,559 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:54,559 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:54,559 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:54,559 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,559 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:54,559 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:54,559 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:54,559 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:54,559 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:54,559 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:54,559 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:54,559 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,559 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,560 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,560 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,560 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:54,560 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:54,560 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:54,560 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:27:54,560 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:54,560 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:54,560 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:54,560 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:54,560 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:54,560 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:54,560 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:54,560 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:54,560 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:54,560 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:54,561 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:54,561 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,561 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,561 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,561 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,577 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:54,578 - src.hyperparameter_tuning - ERROR - Trial 16 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:54,592 - src.hyperparameter_tuning - INFO - Trial 17: 모델 타입 = xgboost
2025-06-24 09:27:54,596 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:54,596 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:54,596 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:54,596 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:54,596 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:54,596 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:54,596 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:54,596 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:54,596 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:54,597 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:54,597 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:54,597 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:54,597 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:54,597 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:54,597 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:54,597 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:54,597 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:54,597 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:54,598 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,598 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,598 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,598 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,598 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,598 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:54,598 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:54,598 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:54,598 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:54,598 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:54,602 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:54,604 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,604 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:54,604 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:54,604 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:54,604 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:54,604 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:54,604 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,606 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,608 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:54,608 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,608 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,608 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,608 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,608 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,608 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,608 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:54,608 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,608 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,608 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:54,608 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:54,608 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,608 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,608 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:54,608 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:54,608 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,609 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,609 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,609 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:54,610 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:54,610 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:54,610 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:54,610 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:54,610 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:54,610 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:54,610 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:54,610 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:54,610 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:54,610 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,610 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:54,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:54,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,611 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,611 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,611 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,611 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,611 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,611 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,611 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:54,611 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:54,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,612 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,612 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:54,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,612 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,613 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,613 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,613 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,613 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,613 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:54,613 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,613 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:54,613 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,613 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:54,614 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:54,614 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:54,614 - src.models.xgboost_model - INFO -   n_estimators: 970
2025-06-24 09:27:54,614 - src.models.xgboost_model - INFO -   max_depth: 9
2025-06-24 09:27:54,614 - src.models.xgboost_model - INFO -   learning_rate: 0.2754554257172804
2025-06-24 09:27:54,614 - src.models.xgboost_model - INFO -   subsample: 0.9340956836065549
2025-06-24 09:27:54,614 - src.models.xgboost_model - INFO -   colsample_bytree: 0.769400478413884
2025-06-24 09:27:54,614 - src.models.xgboost_model - INFO -   min_child_weight: 5
2025-06-24 09:27:54,614 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:54,614 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:54,614 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:54,614 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:54,614 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:54,614 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:54,614 - src.models.xgboost_model - INFO -   reg_alpha: 7.639371274654815e-06
2025-06-24 09:27:54,614 - src.models.xgboost_model - INFO -   reg_lambda: 0.04296215514985972
2025-06-24 09:27:54,614 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:54,614 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:54,614 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:54,621 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:54,621 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:54,621 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:54,621 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,621 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,621 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,622 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,622 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,622 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,622 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,622 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,622 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,622 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,622 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,622 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:54,623 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:54,623 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:54,623 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:54,623 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:54,623 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,623 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:54,623 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:54,623 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:54,624 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:54,624 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:54,624 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:54,624 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:54,624 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,624 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,624 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,625 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,625 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:54,625 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:54,625 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:54,625 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:54,625 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:54,625 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:54,625 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:54,625 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:54,625 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:54,625 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:54,625 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:54,625 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:54,625 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:54,625 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:54,625 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:54,625 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,625 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,625 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,625 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,642 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:54,642 - src.hyperparameter_tuning - ERROR - Trial 17 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:54,656 - src.hyperparameter_tuning - INFO - Trial 18: 모델 타입 = xgboost
2025-06-24 09:27:54,660 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:54,661 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:54,661 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:54,661 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:54,661 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:54,661 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:54,661 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:54,661 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:54,661 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:54,661 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:54,661 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:54,661 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:54,661 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:54,662 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:54,662 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:54,662 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:54,662 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:54,662 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:54,662 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,662 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,663 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,663 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,663 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,663 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:54,663 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:54,663 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:54,663 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:54,663 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:54,666 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:54,668 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,668 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:54,668 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:54,668 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:54,668 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:54,668 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:54,668 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,670 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,672 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:54,672 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,672 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,672 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,672 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,672 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,672 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,672 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:54,672 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,672 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,673 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:54,673 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:54,673 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,673 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,673 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:54,673 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:54,673 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,674 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,674 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,674 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:54,674 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:54,675 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:54,675 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:54,675 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:54,675 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:54,675 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:54,675 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:54,675 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:54,675 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:54,675 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,675 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:54,675 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:54,675 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,675 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,675 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,675 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,675 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,676 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,676 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,676 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,676 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:54,676 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:54,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,676 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,676 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:54,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,677 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,677 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,677 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,677 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,678 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:54,678 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,678 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:54,678 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,678 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:54,678 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:54,678 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:54,678 - src.models.xgboost_model - INFO -   n_estimators: 320
2025-06-24 09:27:54,678 - src.models.xgboost_model - INFO -   max_depth: 12
2025-06-24 09:27:54,678 - src.models.xgboost_model - INFO -   learning_rate: 0.036046969689776914
2025-06-24 09:27:54,678 - src.models.xgboost_model - INFO -   subsample: 0.6026168324121943
2025-06-24 09:27:54,678 - src.models.xgboost_model - INFO -   colsample_bytree: 0.8416634198004798
2025-06-24 09:27:54,678 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 09:27:54,678 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:54,678 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:54,678 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:54,678 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:54,678 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:54,678 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:54,678 - src.models.xgboost_model - INFO -   reg_alpha: 9.919978178114084e-08
2025-06-24 09:27:54,678 - src.models.xgboost_model - INFO -   reg_lambda: 0.00010765713633373472
2025-06-24 09:27:54,678 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:54,678 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:54,679 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:54,708 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:54,708 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:54,708 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:54,708 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,708 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,709 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,709 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,710 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,710 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,710 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:54,710 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:54,711 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:54,711 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:54,711 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:54,711 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,711 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:54,711 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:54,711 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:54,711 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:54,711 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:54,711 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:54,711 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:54,711 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,711 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,712 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,712 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,712 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:54,712 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:54,712 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:54,712 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:27:54,712 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:54,712 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:54,712 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:54,712 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:54,712 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:54,712 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:54,712 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:54,712 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:54,712 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:54,713 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:54,713 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:54,713 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,713 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,713 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,713 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,730 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:54,730 - src.hyperparameter_tuning - ERROR - Trial 18 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:54,744 - src.hyperparameter_tuning - INFO - Trial 19: 모델 타입 = xgboost
2025-06-24 09:27:54,748 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:54,749 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:54,749 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:54,749 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:54,749 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:54,749 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:54,749 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:54,749 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:54,749 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:54,749 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:54,749 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:54,749 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:54,749 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:54,749 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:54,749 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:54,749 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:54,749 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:54,749 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:54,750 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,750 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,750 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,750 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,750 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,750 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:54,750 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:54,750 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:54,751 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:54,751 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:54,754 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:54,756 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,756 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:54,756 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:54,756 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:54,756 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:54,756 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:54,756 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,758 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,760 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:54,760 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,760 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,760 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,760 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,760 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,760 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,760 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:54,760 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,760 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,761 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:54,761 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:54,761 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,761 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,761 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:54,761 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:54,761 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,762 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,762 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,762 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:54,762 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:54,762 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:54,762 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:54,762 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:54,762 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:54,762 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:54,762 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:54,762 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:54,762 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:54,763 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,763 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:54,763 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:54,763 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,763 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,763 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,763 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,763 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,763 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,764 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,764 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,764 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:54,764 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,764 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:54,764 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,764 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,764 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:54,764 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,764 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,764 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,765 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,765 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,765 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,765 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,765 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,765 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,765 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,765 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,766 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:54,766 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,766 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:54,766 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,766 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:54,766 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:54,766 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:54,766 - src.models.xgboost_model - INFO -   n_estimators: 735
2025-06-24 09:27:54,766 - src.models.xgboost_model - INFO -   max_depth: 8
2025-06-24 09:27:54,766 - src.models.xgboost_model - INFO -   learning_rate: 0.11744851804282604
2025-06-24 09:27:54,766 - src.models.xgboost_model - INFO -   subsample: 0.858058025655211
2025-06-24 09:27:54,766 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6296618535752112
2025-06-24 09:27:54,766 - src.models.xgboost_model - INFO -   min_child_weight: 9
2025-06-24 09:27:54,766 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:54,766 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:54,766 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:54,766 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:54,766 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:54,766 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:54,766 - src.models.xgboost_model - INFO -   reg_alpha: 0.0005256761664787865
2025-06-24 09:27:54,766 - src.models.xgboost_model - INFO -   reg_lambda: 2.721927782819717e-06
2025-06-24 09:27:54,766 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:54,766 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:54,766 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:54,778 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:54,778 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:54,778 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:54,778 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,778 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,779 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,779 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,779 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,779 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,779 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,779 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,780 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,780 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,780 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,780 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:54,781 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:54,781 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:54,781 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:54,781 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:54,781 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,781 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:54,781 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:54,781 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:54,781 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:54,781 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:54,781 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:54,781 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:54,781 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,782 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,782 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,782 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,782 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:54,782 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:54,782 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:54,782 - src.training - INFO -   accuracy: 0.972
2025-06-24 09:27:54,782 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:54,782 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:54,782 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:54,782 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:54,782 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:54,782 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:54,782 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:54,782 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:54,782 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:54,783 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:54,783 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.972, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:54,783 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,783 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,783 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,783 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,800 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:54,800 - src.hyperparameter_tuning - ERROR - Trial 19 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:54,814 - src.hyperparameter_tuning - INFO - Trial 20: 모델 타입 = xgboost
2025-06-24 09:27:54,818 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:54,819 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:54,819 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:54,819 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:54,819 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:54,819 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:54,819 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:54,819 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:54,819 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:54,819 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:54,819 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:54,819 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:54,819 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:54,819 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:54,819 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:54,819 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:54,819 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:54,819 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:54,820 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,820 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,820 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,820 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,820 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,820 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:54,820 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:54,820 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:54,820 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:54,820 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:54,824 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:54,826 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,826 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:54,826 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:54,826 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:54,826 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:54,826 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:54,826 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,828 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,830 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:54,830 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,830 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,830 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,830 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,830 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,830 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,830 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:54,830 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,830 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,831 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:54,831 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:54,831 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,831 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,831 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:54,831 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:54,831 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,831 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,831 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,831 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:54,832 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:54,832 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:54,832 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:54,832 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:54,832 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:54,832 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:54,832 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:54,832 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:54,832 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:54,832 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,832 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:54,832 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:54,832 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,833 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,833 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,833 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,833 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,833 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,833 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,834 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,834 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:54,834 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,834 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:54,834 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,834 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,834 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:54,834 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,834 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,834 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,834 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,835 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,835 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,835 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,835 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,835 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,835 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,835 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,835 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:54,835 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,835 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:54,835 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,835 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:54,836 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:54,836 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:54,836 - src.models.xgboost_model - INFO -   n_estimators: 524
2025-06-24 09:27:54,836 - src.models.xgboost_model - INFO -   max_depth: 15
2025-06-24 09:27:54,836 - src.models.xgboost_model - INFO -   learning_rate: 0.19533630974741553
2025-06-24 09:27:54,836 - src.models.xgboost_model - INFO -   subsample: 0.8048690303422982
2025-06-24 09:27:54,836 - src.models.xgboost_model - INFO -   colsample_bytree: 0.9780383022354938
2025-06-24 09:27:54,836 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 09:27:54,836 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:54,836 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:54,836 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:54,836 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:54,836 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:54,836 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:54,836 - src.models.xgboost_model - INFO -   reg_alpha: 3.100303355334906e-06
2025-06-24 09:27:54,836 - src.models.xgboost_model - INFO -   reg_lambda: 0.0031512146598649143
2025-06-24 09:27:54,836 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:54,836 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:54,836 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:54,845 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:54,845 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:54,845 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:54,845 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,845 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,845 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,845 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,846 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,846 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,846 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:54,847 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:54,847 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:54,847 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:54,847 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:54,847 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,847 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:54,847 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:54,847 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:54,847 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:54,848 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:54,848 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:54,848 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:54,848 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,848 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,848 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,848 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,849 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:54,849 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:54,849 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:54,849 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:54,849 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:54,849 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:54,849 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:54,849 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:54,849 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:54,849 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:54,849 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:54,849 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:54,849 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:54,849 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:54,849 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:54,849 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,849 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,849 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,849 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,866 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:54,866 - src.hyperparameter_tuning - ERROR - Trial 20 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:54,881 - src.hyperparameter_tuning - INFO - Trial 21: 모델 타입 = xgboost
2025-06-24 09:27:54,885 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:54,886 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:54,886 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:54,886 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:54,886 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:54,886 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:54,886 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:54,886 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:54,886 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:54,886 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:54,886 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:54,886 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:54,886 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:54,886 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:54,886 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:54,886 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:54,886 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:54,887 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:54,887 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,887 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,887 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,887 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,887 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,888 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:54,888 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:54,888 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:54,888 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:54,888 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:54,891 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:54,893 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,893 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:54,893 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:54,893 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:54,893 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:54,893 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:54,893 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,895 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,897 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:54,897 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,897 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,897 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,897 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,897 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,897 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,897 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:54,897 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,897 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,898 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:54,898 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:54,898 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,898 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,898 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:54,898 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:54,898 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,898 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,898 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,899 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:54,899 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:54,899 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:54,899 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:54,899 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:54,899 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:54,899 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:54,899 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:54,899 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:54,899 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:54,899 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,899 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:54,900 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:54,900 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,900 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,900 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,901 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,901 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,901 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:54,901 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,901 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:54,901 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,901 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,901 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:54,901 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,901 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,901 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,901 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,902 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,902 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,902 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,902 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,902 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,902 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,902 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,902 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:54,902 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,902 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:54,902 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,903 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:54,903 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:54,903 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:54,903 - src.models.xgboost_model - INFO -   n_estimators: 460
2025-06-24 09:27:54,903 - src.models.xgboost_model - INFO -   max_depth: 5
2025-06-24 09:27:54,903 - src.models.xgboost_model - INFO -   learning_rate: 0.07870183784266177
2025-06-24 09:27:54,903 - src.models.xgboost_model - INFO -   subsample: 0.7055818053995003
2025-06-24 09:27:54,903 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7130366546802293
2025-06-24 09:27:54,903 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 09:27:54,903 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:54,903 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:54,903 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:54,903 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:54,903 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:54,903 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:54,903 - src.models.xgboost_model - INFO -   reg_alpha: 5.925825400469547e-05
2025-06-24 09:27:54,903 - src.models.xgboost_model - INFO -   reg_lambda: 0.14245949703092106
2025-06-24 09:27:54,903 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:54,903 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:54,903 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:54,917 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:54,917 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:54,917 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:54,917 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,917 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,918 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,918 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,918 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,918 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,918 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,918 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,919 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,919 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,919 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:54,920 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:54,920 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:54,920 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:54,920 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:54,920 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,920 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:54,920 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:54,920 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:54,920 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:54,920 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:54,920 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:54,920 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:54,920 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,921 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,921 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,921 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,921 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:54,921 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:54,921 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:54,921 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:54,921 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:54,921 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:54,921 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:54,921 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:54,921 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:54,921 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:54,921 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:54,921 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:54,921 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:54,922 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:54,922 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:54,922 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,922 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,922 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,922 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,939 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:54,939 - src.hyperparameter_tuning - ERROR - Trial 21 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:54,953 - src.hyperparameter_tuning - INFO - Trial 22: 모델 타입 = xgboost
2025-06-24 09:27:54,957 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:54,958 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:54,958 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:54,958 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:54,958 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:54,958 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:54,958 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:54,958 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:54,958 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:54,959 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:54,959 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:54,959 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:54,959 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:54,959 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:54,959 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:54,959 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:54,959 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:54,959 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:54,960 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,960 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,960 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:54,960 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:54,960 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,960 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:54,960 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:54,960 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:54,960 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:54,960 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:54,963 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:54,965 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,965 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:54,965 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:54,965 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:54,966 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:54,966 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:54,966 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:54,968 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:54,969 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:54,969 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,969 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,969 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:54,970 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:54,970 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,970 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:54,970 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:54,970 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,970 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,970 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:54,970 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:54,970 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,970 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,970 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:54,970 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:54,970 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,971 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,971 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:54,971 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:54,972 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:54,972 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:54,972 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:54,972 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:54,972 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:54,972 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:54,972 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:54,972 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:54,972 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:54,972 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,972 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:54,972 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:54,972 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,972 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,972 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,972 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,973 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,973 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,973 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,973 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,973 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:54,973 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,973 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:54,973 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,973 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,973 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:54,973 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,973 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,974 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,974 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,974 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,974 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,974 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,974 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,974 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,975 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,975 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,975 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:54,975 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,975 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:54,975 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,975 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:54,975 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:54,975 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:54,975 - src.models.xgboost_model - INFO -   n_estimators: 401
2025-06-24 09:27:54,975 - src.models.xgboost_model - INFO -   max_depth: 3
2025-06-24 09:27:54,975 - src.models.xgboost_model - INFO -   learning_rate: 0.04398189955114847
2025-06-24 09:27:54,975 - src.models.xgboost_model - INFO -   subsample: 0.7488306146704025
2025-06-24 09:27:54,975 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6893181261975687
2025-06-24 09:27:54,975 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 09:27:54,975 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:54,975 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:54,975 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:54,975 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:54,975 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:54,975 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:54,975 - src.models.xgboost_model - INFO -   reg_alpha: 0.020211660841900077
2025-06-24 09:27:54,975 - src.models.xgboost_model - INFO -   reg_lambda: 0.020797603391813763
2025-06-24 09:27:54,975 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:54,975 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:54,976 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:54,995 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:54,995 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:54,995 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:54,995 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:54,995 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,995 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:54,996 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:54,996 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:54,996 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:54,996 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:54,996 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:54,996 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:54,996 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:54,996 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,997 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:54,997 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:54,997 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:54,997 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:54,997 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:54,997 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,997 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:54,997 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:54,997 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:54,998 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:54,998 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:54,998 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:54,998 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:54,998 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,998 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,998 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,999 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:54,999 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:54,999 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:54,999 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:54,999 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:27:54,999 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:54,999 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:54,999 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:54,999 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:54,999 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:54,999 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:54,999 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:54,999 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:54,999 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:54,999 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:54,999 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:54,999 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,999 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:54,999 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:54,999 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,016 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:55,016 - src.hyperparameter_tuning - ERROR - Trial 22 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:55,031 - src.hyperparameter_tuning - INFO - Trial 23: 모델 타입 = xgboost
2025-06-24 09:27:55,035 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:55,036 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:55,036 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:55,036 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:55,036 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:55,036 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:55,036 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:55,036 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:55,036 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:55,036 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:55,036 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:55,036 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:55,036 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:55,036 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:55,036 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:55,037 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:55,037 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:55,037 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:55,037 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:55,037 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:55,037 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:55,037 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:55,038 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:55,038 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:55,038 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:55,038 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:55,038 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:55,038 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:55,041 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:55,043 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:55,043 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:55,043 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:55,043 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:55,043 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:55,043 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:55,043 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:55,045 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:55,047 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:55,047 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:55,047 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:55,047 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:55,047 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:55,047 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:55,047 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:55,047 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:55,047 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,047 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,048 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:55,048 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:55,048 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,048 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,048 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:55,048 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:55,048 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,048 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:55,049 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:55,049 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:55,049 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:55,049 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:55,049 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:55,049 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:55,049 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:55,049 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:55,049 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:55,049 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:55,049 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:55,049 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,049 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:55,050 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:55,050 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,050 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,050 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,050 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,050 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,050 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,051 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,051 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,051 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:55,051 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,051 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:55,051 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,051 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,051 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:55,051 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:55,051 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,051 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,052 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,052 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,052 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,052 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,052 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,052 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,052 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:55,052 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,052 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:55,053 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,053 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:55,053 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,053 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:55,053 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:55,053 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:55,053 - src.models.xgboost_model - INFO -   n_estimators: 583
2025-06-24 09:27:55,053 - src.models.xgboost_model - INFO -   max_depth: 5
2025-06-24 09:27:55,053 - src.models.xgboost_model - INFO -   learning_rate: 0.09701544808702593
2025-06-24 09:27:55,053 - src.models.xgboost_model - INFO -   subsample: 0.6073248792362046
2025-06-24 09:27:55,053 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7512970916485808
2025-06-24 09:27:55,053 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 09:27:55,053 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:55,053 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:55,053 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:55,053 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:55,053 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:55,053 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:55,053 - src.models.xgboost_model - INFO -   reg_alpha: 0.00015087809760065368
2025-06-24 09:27:55,053 - src.models.xgboost_model - INFO -   reg_lambda: 0.23203295015878606
2025-06-24 09:27:55,053 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:55,053 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:55,053 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:55,067 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:55,067 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:55,067 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:55,067 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:55,067 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,067 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,068 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,068 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,068 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,068 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,068 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,068 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,068 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:55,068 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,068 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:55,069 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:55,069 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:55,069 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:55,069 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:55,069 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,069 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:55,069 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:55,069 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:55,070 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:55,070 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:55,070 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:55,070 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:55,070 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,070 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,070 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,071 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,071 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:55,071 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:55,071 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:55,071 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:27:55,071 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:55,071 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:55,071 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:55,071 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:55,071 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:55,071 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:55,071 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:55,071 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:55,071 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:55,071 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:55,071 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:55,071 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,071 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,071 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,071 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,089 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:55,089 - src.hyperparameter_tuning - ERROR - Trial 23 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:55,104 - src.hyperparameter_tuning - INFO - Trial 24: 모델 타입 = xgboost
2025-06-24 09:27:55,108 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:55,109 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:55,109 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:55,109 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:55,109 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:55,109 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:55,109 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:55,109 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:55,109 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:55,109 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:55,109 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:55,109 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:55,109 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:55,109 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:55,109 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:55,109 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:55,109 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:55,109 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:55,110 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:55,110 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:55,110 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:55,110 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:55,111 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:55,111 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:55,111 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:55,111 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:55,111 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:55,111 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:55,114 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:55,116 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:55,116 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:55,116 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:55,116 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:55,116 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:55,116 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:55,116 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:55,118 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:55,120 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:55,120 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:55,120 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:55,120 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:55,120 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:55,120 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:55,120 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:55,121 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:55,121 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,121 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,121 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:55,121 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:55,121 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,121 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,121 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:55,121 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:55,121 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,122 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:55,122 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:55,122 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:55,123 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:55,123 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:55,123 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:55,123 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:55,123 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:55,123 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:55,123 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:55,123 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:55,123 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:55,123 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,123 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:55,123 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:55,123 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,123 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,123 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,123 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,123 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,124 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,124 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,124 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,124 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:55,124 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,124 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:55,124 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,124 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,124 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:55,124 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:55,124 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,124 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,125 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,125 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,125 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,125 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,125 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,125 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,125 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:55,125 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,126 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:55,126 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,126 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:55,126 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,126 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:55,126 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:55,126 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:55,126 - src.models.xgboost_model - INFO -   n_estimators: 252
2025-06-24 09:27:55,126 - src.models.xgboost_model - INFO -   max_depth: 6
2025-06-24 09:27:55,126 - src.models.xgboost_model - INFO -   learning_rate: 0.07488893191233491
2025-06-24 09:27:55,126 - src.models.xgboost_model - INFO -   subsample: 0.6512724702232536
2025-06-24 09:27:55,126 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6568950498440635
2025-06-24 09:27:55,126 - src.models.xgboost_model - INFO -   min_child_weight: 6
2025-06-24 09:27:55,126 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:55,126 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:55,126 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:55,126 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:55,126 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:55,126 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:55,126 - src.models.xgboost_model - INFO -   reg_alpha: 1.6584643769529482e-07
2025-06-24 09:27:55,126 - src.models.xgboost_model - INFO -   reg_lambda: 0.0005348881786784441
2025-06-24 09:27:55,126 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:55,126 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:55,127 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:55,142 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:55,142 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:55,142 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:55,142 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:55,142 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,142 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,143 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,143 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,143 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,143 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,143 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,143 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,143 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:55,143 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,144 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:55,144 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:55,144 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:55,144 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:55,144 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:55,144 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,144 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:55,144 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:55,144 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:55,145 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:55,145 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:55,145 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:55,145 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:55,145 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,145 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,145 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,146 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,146 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:55,146 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:55,146 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:55,146 - src.training - INFO -   accuracy: 0.984
2025-06-24 09:27:55,146 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:55,146 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:55,146 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:55,146 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:55,146 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:55,146 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:55,146 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:55,146 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:55,146 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:55,146 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:55,146 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.984, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:55,146 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,146 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,146 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,146 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,164 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:55,164 - src.hyperparameter_tuning - ERROR - Trial 24 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:55,179 - src.hyperparameter_tuning - INFO - Trial 25: 모델 타입 = xgboost
2025-06-24 09:27:55,183 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:55,184 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:55,184 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:55,184 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:55,184 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:55,184 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:55,184 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:55,184 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:55,184 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:55,185 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:55,185 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:55,185 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:55,185 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:55,185 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:55,185 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:55,185 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:55,185 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:55,185 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:55,186 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:55,186 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:55,186 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:55,186 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:55,186 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:55,186 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:55,186 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:55,186 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:55,187 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:55,187 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:55,190 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:55,192 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:55,192 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:55,192 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:55,192 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:55,192 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:55,192 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:55,192 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:55,195 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:55,196 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:55,197 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:55,197 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:55,197 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:55,197 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:55,197 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:55,197 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:55,197 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:55,197 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,197 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,197 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:55,197 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:55,197 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,197 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,197 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:55,198 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:55,198 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,198 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:55,198 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:55,198 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:55,199 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:55,199 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:55,199 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:55,199 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:55,199 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:55,199 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:55,199 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:55,199 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:55,199 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:55,199 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,199 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:55,199 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:55,199 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,200 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,200 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,200 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,200 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,200 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,201 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,201 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,201 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:55,201 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,201 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:55,201 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,201 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,201 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:55,201 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:55,201 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,202 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,202 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,202 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,202 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,202 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,202 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,203 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,203 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:55,203 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,203 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:55,203 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,203 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:55,203 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,203 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:55,204 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:55,204 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:55,204 - src.models.xgboost_model - INFO -   n_estimators: 467
2025-06-24 09:27:55,204 - src.models.xgboost_model - INFO -   max_depth: 5
2025-06-24 09:27:55,204 - src.models.xgboost_model - INFO -   learning_rate: 0.13745541553982266
2025-06-24 09:27:55,204 - src.models.xgboost_model - INFO -   subsample: 0.8716844621710428
2025-06-24 09:27:55,204 - src.models.xgboost_model - INFO -   colsample_bytree: 0.701870398920289
2025-06-24 09:27:55,204 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 09:27:55,204 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:55,204 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:55,204 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:55,204 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:55,204 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:55,204 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:55,204 - src.models.xgboost_model - INFO -   reg_alpha: 0.8842742611236626
2025-06-24 09:27:55,204 - src.models.xgboost_model - INFO -   reg_lambda: 0.47831211750168423
2025-06-24 09:27:55,204 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:55,204 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:55,204 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:55,219 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:55,219 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:55,219 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:55,219 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:55,219 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,220 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,220 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,220 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,220 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,220 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,220 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,221 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,221 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:55,221 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,221 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:55,230 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:55,230 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:55,230 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:55,230 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:55,230 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,230 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:55,230 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:55,230 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:55,231 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:55,231 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:55,231 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:55,231 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:55,231 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,231 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,232 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,232 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,232 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:55,232 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:55,232 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:55,232 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:55,232 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:55,232 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:55,232 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:55,232 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:55,232 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:55,232 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:55,232 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:55,232 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:55,232 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:55,232 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:55,232 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:55,232 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,232 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,232 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,232 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,250 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:55,250 - src.hyperparameter_tuning - ERROR - Trial 25 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:55,265 - src.hyperparameter_tuning - INFO - Trial 26: 모델 타입 = xgboost
2025-06-24 09:27:55,269 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:55,270 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:55,270 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:55,270 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:55,270 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:55,270 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:55,270 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:55,270 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:55,270 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:55,270 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:55,270 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:55,270 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:55,270 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:55,270 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:55,270 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:55,270 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:55,270 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:55,270 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:55,271 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:55,271 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:55,271 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:55,271 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:55,271 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:55,271 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:55,271 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:55,271 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:55,272 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:55,272 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:55,275 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:55,277 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:55,277 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:55,277 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:55,277 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:55,277 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:55,277 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:55,277 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:55,279 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:55,281 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:55,281 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:55,281 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:55,281 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:55,281 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:55,281 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:55,281 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:55,281 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:55,281 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,281 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,282 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:55,282 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:55,282 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,282 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,282 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:55,282 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:55,282 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,283 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:55,283 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:55,283 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:55,283 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:55,283 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:55,283 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:55,283 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:55,283 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:55,283 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:55,284 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:55,284 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:55,284 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:55,284 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,284 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:55,284 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:55,284 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,284 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,284 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,284 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,284 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,284 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,285 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,285 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,285 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:55,285 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,285 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:55,285 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,285 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,285 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:55,285 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:55,285 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,285 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,286 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,286 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,286 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,286 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,286 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,286 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,286 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:55,286 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,287 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:55,287 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,287 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:55,287 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,287 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:55,287 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:55,287 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:55,287 - src.models.xgboost_model - INFO -   n_estimators: 93
2025-06-24 09:27:55,287 - src.models.xgboost_model - INFO -   max_depth: 7
2025-06-24 09:27:55,287 - src.models.xgboost_model - INFO -   learning_rate: 0.21590200607321333
2025-06-24 09:27:55,287 - src.models.xgboost_model - INFO -   subsample: 0.8295815448711918
2025-06-24 09:27:55,287 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6390144737460547
2025-06-24 09:27:55,287 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 09:27:55,287 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:55,287 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:55,287 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:55,287 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:55,287 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:55,287 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:55,287 - src.models.xgboost_model - INFO -   reg_alpha: 1.1306482876280548e-08
2025-06-24 09:27:55,287 - src.models.xgboost_model - INFO -   reg_lambda: 0.022773054823943602
2025-06-24 09:27:55,287 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:55,287 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:55,287 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:55,297 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:55,297 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:55,297 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:55,297 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:55,297 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,298 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,299 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:55,299 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,299 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:55,299 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:55,299 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:55,299 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:55,299 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:55,299 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,299 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:55,299 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:55,299 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:55,300 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:55,300 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:55,300 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:55,300 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:55,300 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,300 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,300 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,301 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,301 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:55,301 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:55,301 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:55,301 - src.training - INFO -   accuracy: 0.984
2025-06-24 09:27:55,301 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:55,301 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:55,301 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:55,301 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:55,301 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:55,301 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:55,301 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:55,301 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:55,301 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:55,301 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:55,301 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.984, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:55,301 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,301 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,301 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,301 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,319 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:55,319 - src.hyperparameter_tuning - ERROR - Trial 26 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:55,334 - src.hyperparameter_tuning - INFO - Trial 27: 모델 타입 = xgboost
2025-06-24 09:27:55,338 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:55,338 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:55,338 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:55,338 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:55,338 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:55,338 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:55,338 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:55,338 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:55,338 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:55,339 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:55,339 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:55,339 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:55,339 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:55,339 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:55,339 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:55,339 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:55,339 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:55,339 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:55,340 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:55,340 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:55,340 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:55,340 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:55,340 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:55,340 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:55,340 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:55,340 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:55,340 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:55,340 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:55,344 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:55,346 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:55,346 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:55,346 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:55,346 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:55,346 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:55,346 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:55,346 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:55,348 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:55,350 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:55,350 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:55,350 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:55,350 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:55,350 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:55,350 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:55,350 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:55,350 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:55,350 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,350 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,351 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:55,351 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:55,351 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,351 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,351 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:55,351 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:55,351 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,351 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:55,351 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:55,351 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:55,352 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:55,352 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:55,352 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:55,352 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:55,352 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:55,352 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:55,352 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:55,352 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:55,352 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:55,352 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,352 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:55,352 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:55,352 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,353 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,353 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,353 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,353 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,353 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,353 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,353 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,354 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:55,354 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,354 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:55,354 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,354 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,354 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:55,354 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:55,354 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,354 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,354 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,354 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,355 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,355 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,355 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,355 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,355 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:55,355 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,355 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:55,355 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,355 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:55,355 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,355 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:55,356 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:55,356 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:55,356 - src.models.xgboost_model - INFO -   n_estimators: 716
2025-06-24 09:27:55,356 - src.models.xgboost_model - INFO -   max_depth: 4
2025-06-24 09:27:55,356 - src.models.xgboost_model - INFO -   learning_rate: 0.017810439777166672
2025-06-24 09:27:55,356 - src.models.xgboost_model - INFO -   subsample: 0.7862901903405964
2025-06-24 09:27:55,356 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7488621218277184
2025-06-24 09:27:55,356 - src.models.xgboost_model - INFO -   min_child_weight: 5
2025-06-24 09:27:55,356 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:55,356 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:55,356 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:55,356 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:55,356 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:55,356 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:55,356 - src.models.xgboost_model - INFO -   reg_alpha: 0.0007703591702435432
2025-06-24 09:27:55,356 - src.models.xgboost_model - INFO -   reg_lambda: 8.051535046703718
2025-06-24 09:27:55,356 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:55,356 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:55,356 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:55,400 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:55,400 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:55,400 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:55,400 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:55,400 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,400 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,400 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,400 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,401 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,401 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,401 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,401 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,401 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:55,401 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,401 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:55,402 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:55,402 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:55,402 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:55,402 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:55,402 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,402 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:55,402 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:55,402 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:55,402 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:55,402 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:55,402 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:55,402 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:55,403 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,403 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,403 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,403 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,403 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:55,403 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:55,403 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:55,404 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:55,404 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:55,404 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:55,404 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:55,404 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:55,404 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:55,404 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:55,404 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:55,404 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:55,404 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:55,404 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:55,404 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:55,404 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,404 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,404 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,404 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,422 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:55,422 - src.hyperparameter_tuning - ERROR - Trial 27 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:55,437 - src.hyperparameter_tuning - INFO - Trial 28: 모델 타입 = xgboost
2025-06-24 09:27:55,441 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:55,441 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:55,441 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:55,442 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:55,442 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:55,442 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:55,442 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:55,442 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:55,442 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:55,442 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:55,442 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:55,442 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:55,442 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:55,442 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:55,442 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:55,442 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:55,442 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:55,442 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:55,443 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:55,443 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:55,443 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:55,443 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:55,443 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:55,443 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:55,443 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:55,443 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:55,443 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:55,443 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:55,447 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:55,449 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:55,449 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:55,449 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:55,449 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:55,449 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:55,449 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:55,449 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:55,451 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:55,453 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:55,453 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:55,453 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:55,453 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:55,453 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:55,453 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:55,453 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:55,453 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:55,453 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,453 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,454 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:55,454 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:55,454 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,454 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,454 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:55,454 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:55,454 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,454 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:55,454 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:55,454 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:55,455 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:55,455 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:55,455 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:55,455 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:55,455 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:55,455 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:55,455 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:55,455 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:55,455 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:55,455 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,455 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:55,455 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:55,455 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,456 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,456 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,456 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,456 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,456 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,456 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,457 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,457 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:55,457 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,457 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:55,457 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,457 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,457 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:55,457 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:55,457 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,457 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,457 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,458 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,458 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,458 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,458 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,458 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,458 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:55,458 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,458 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:55,458 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,458 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:55,458 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,458 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:55,459 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:55,459 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:55,459 - src.models.xgboost_model - INFO -   n_estimators: 444
2025-06-24 09:27:55,459 - src.models.xgboost_model - INFO -   max_depth: 8
2025-06-24 09:27:55,459 - src.models.xgboost_model - INFO -   learning_rate: 0.0804240885230043
2025-06-24 09:27:55,459 - src.models.xgboost_model - INFO -   subsample: 0.9228113692867211
2025-06-24 09:27:55,459 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6805505706097182
2025-06-24 09:27:55,459 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 09:27:55,459 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:55,459 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:55,459 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:55,459 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:55,459 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:55,459 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:55,459 - src.models.xgboost_model - INFO -   reg_alpha: 7.233857828150096e-06
2025-06-24 09:27:55,459 - src.models.xgboost_model - INFO -   reg_lambda: 2.480253684313045e-06
2025-06-24 09:27:55,459 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:55,459 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:55,459 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:55,478 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:55,478 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:55,478 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:55,478 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:55,478 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,478 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,478 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,478 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,478 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,479 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,479 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,479 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,479 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:55,479 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,479 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:55,480 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:55,480 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:55,480 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:55,480 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:55,480 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,480 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:55,480 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:55,480 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:55,480 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:55,480 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:55,480 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:55,480 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:55,480 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,481 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,481 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,481 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,481 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:55,481 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:55,481 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:55,481 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:27:55,481 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:55,481 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:55,481 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:55,481 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:55,481 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:55,481 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:55,481 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:55,481 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:55,481 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:55,482 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:55,482 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:55,482 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,482 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,482 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,482 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,500 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:55,500 - src.hyperparameter_tuning - ERROR - Trial 28 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:55,515 - src.hyperparameter_tuning - INFO - Trial 29: 모델 타입 = xgboost
2025-06-24 09:27:55,519 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:55,520 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:55,520 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:55,520 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:55,520 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:55,520 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:55,520 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:55,520 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:55,520 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:55,521 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:55,521 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:55,521 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:55,521 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:55,521 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:55,521 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:55,521 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:55,521 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:55,521 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:55,522 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:55,522 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:55,522 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:55,522 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:55,522 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:55,522 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:55,522 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:55,522 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:55,522 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:55,522 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:55,525 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:55,527 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:55,527 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:55,527 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:55,527 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:55,527 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:55,527 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:55,527 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:55,529 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:55,531 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:55,531 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:55,531 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:55,531 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:55,531 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:55,531 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:55,532 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:55,532 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:55,532 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,532 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,532 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:55,532 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:55,532 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,532 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,532 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:55,532 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:55,532 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,533 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:55,533 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:55,533 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:55,534 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:55,534 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:55,534 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:55,534 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:55,534 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:55,534 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:55,534 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:55,534 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:55,534 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:55,534 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,534 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:55,534 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:55,534 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,534 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,534 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,534 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,534 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,535 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,535 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,535 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,535 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:55,535 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,535 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:55,535 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,535 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,535 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:55,535 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:55,535 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,536 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,536 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,536 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,536 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,536 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,536 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,536 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,536 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:55,537 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,537 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:55,537 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,537 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:55,537 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,537 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:55,537 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:55,537 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:55,537 - src.models.xgboost_model - INFO -   n_estimators: 567
2025-06-24 09:27:55,537 - src.models.xgboost_model - INFO -   max_depth: 10
2025-06-24 09:27:55,537 - src.models.xgboost_model - INFO -   learning_rate: 0.04970917336815857
2025-06-24 09:27:55,537 - src.models.xgboost_model - INFO -   subsample: 0.9800957308963963
2025-06-24 09:27:55,537 - src.models.xgboost_model - INFO -   colsample_bytree: 0.66594978983778
2025-06-24 09:27:55,537 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 09:27:55,537 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:55,537 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:55,537 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:55,537 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:55,537 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:55,537 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:55,537 - src.models.xgboost_model - INFO -   reg_alpha: 6.316657494967782e-07
2025-06-24 09:27:55,537 - src.models.xgboost_model - INFO -   reg_lambda: 8.666468151872799e-06
2025-06-24 09:27:55,537 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:55,537 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:55,538 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:55,570 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:55,570 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:55,570 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:55,570 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:55,570 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,570 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,570 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,570 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,570 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,570 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,571 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,571 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,571 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:55,571 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,571 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:55,572 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:55,572 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:55,572 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:55,572 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:55,572 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,572 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:55,572 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:55,572 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:55,572 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:55,572 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:55,572 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:55,572 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:55,572 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,573 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,573 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,573 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,573 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:55,573 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:55,573 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:55,573 - src.training - INFO -   accuracy: 0.984
2025-06-24 09:27:55,573 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:55,573 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:55,573 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:55,573 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:55,573 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:55,573 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:55,573 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:55,573 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:55,573 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:55,574 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:55,574 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.984, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:55,574 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,574 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,574 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,574 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,592 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:55,592 - src.hyperparameter_tuning - ERROR - Trial 29 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:55,607 - src.hyperparameter_tuning - INFO - Trial 30: 모델 타입 = xgboost
2025-06-24 09:27:55,611 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:55,612 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:55,612 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:55,612 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:55,612 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:55,612 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:55,612 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:55,612 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:55,612 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:55,612 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:55,612 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:55,613 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:55,613 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:55,613 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:55,613 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:55,613 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:55,613 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:55,613 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:55,613 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:55,614 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:55,614 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:55,614 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:55,614 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:55,614 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:55,614 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:55,614 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:55,614 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:55,614 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:55,617 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:55,619 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:55,619 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:55,619 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:55,619 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:55,619 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:55,619 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:55,619 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:55,621 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:55,623 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:55,623 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:55,623 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:55,623 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:55,623 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:55,623 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:55,623 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:55,623 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:55,623 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,624 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,624 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:55,624 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:55,624 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,624 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,624 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:55,624 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:55,624 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,625 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:55,625 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:55,625 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:55,626 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:55,626 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:55,626 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:55,626 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:55,626 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:55,626 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:55,626 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:55,626 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:55,626 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:55,626 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,626 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:55,626 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:55,626 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,626 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,626 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,626 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,626 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,627 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,627 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,627 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,627 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:55,627 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,627 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:55,627 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,627 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,627 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:55,627 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:55,627 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,628 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,628 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,628 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,628 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,628 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,628 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,628 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,628 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:55,628 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,629 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:55,629 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,629 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:55,629 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,629 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:55,629 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:55,629 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:55,629 - src.models.xgboost_model - INFO -   n_estimators: 799
2025-06-24 09:27:55,629 - src.models.xgboost_model - INFO -   max_depth: 3
2025-06-24 09:27:55,629 - src.models.xgboost_model - INFO -   learning_rate: 0.13488959138550238
2025-06-24 09:27:55,629 - src.models.xgboost_model - INFO -   subsample: 0.7340508610504258
2025-06-24 09:27:55,629 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6009230104184364
2025-06-24 09:27:55,629 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 09:27:55,629 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:55,629 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:55,629 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:55,629 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:55,629 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:55,629 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:55,629 - src.models.xgboost_model - INFO -   reg_alpha: 5.89013926932394e-08
2025-06-24 09:27:55,629 - src.models.xgboost_model - INFO -   reg_lambda: 6.320050440064079e-07
2025-06-24 09:27:55,629 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:55,629 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:55,630 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:55,642 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:55,642 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:55,642 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:55,642 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:55,642 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,642 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,643 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,643 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,643 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,643 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,643 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,643 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,643 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:55,643 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:55,644 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:55,644 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:55,644 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:55,644 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:55,644 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,644 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:55,644 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:55,644 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:55,645 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:55,645 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:55,645 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:55,645 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:55,645 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,645 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,645 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,646 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,646 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:55,646 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:55,646 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:55,646 - src.training - INFO -   accuracy: 0.984
2025-06-24 09:27:55,646 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:55,646 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:55,646 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:55,646 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:55,646 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:55,646 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:55,646 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:55,646 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:55,646 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:55,646 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:55,646 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.984, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:55,646 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,646 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,646 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,646 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,664 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:55,664 - src.hyperparameter_tuning - ERROR - Trial 30 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:55,679 - src.hyperparameter_tuning - INFO - Trial 31: 모델 타입 = xgboost
2025-06-24 09:27:55,683 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:55,684 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:55,684 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:55,684 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:55,684 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:55,684 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:55,684 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:55,684 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:55,684 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:55,685 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:55,685 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:55,685 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:55,685 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:55,685 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:55,685 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:55,685 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:55,685 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:55,685 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:55,686 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:55,686 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:55,686 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:55,686 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:55,686 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:55,686 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:55,686 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:55,686 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:55,686 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:55,686 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:55,689 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:55,691 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:55,692 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:55,692 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:55,692 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:55,692 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:55,692 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:55,692 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:55,694 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:55,695 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:55,696 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:55,696 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:55,696 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:55,696 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:55,696 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:55,696 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:55,696 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:55,696 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,696 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,696 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:55,696 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:55,696 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,696 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,696 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:55,696 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:55,696 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,697 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:55,697 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:55,697 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:55,698 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:55,698 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:55,698 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:55,698 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:55,698 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:55,698 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:55,698 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:55,698 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:55,698 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:55,698 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,698 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:55,698 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:55,698 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,698 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,698 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,699 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,699 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,699 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,699 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,699 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,699 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:55,699 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,700 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:55,700 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,700 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,700 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:55,700 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:55,700 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,700 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,700 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,700 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,700 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,700 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,701 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,701 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,701 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:55,701 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,701 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:55,701 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,701 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:55,701 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,701 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:55,702 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:55,702 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:55,702 - src.models.xgboost_model - INFO -   n_estimators: 373
2025-06-24 09:27:55,702 - src.models.xgboost_model - INFO -   max_depth: 10
2025-06-24 09:27:55,702 - src.models.xgboost_model - INFO -   learning_rate: 0.025262873302905067
2025-06-24 09:27:55,702 - src.models.xgboost_model - INFO -   subsample: 0.8375673911058672
2025-06-24 09:27:55,702 - src.models.xgboost_model - INFO -   colsample_bytree: 0.647393749185171
2025-06-24 09:27:55,702 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 09:27:55,702 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:55,702 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:55,702 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:55,702 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:55,702 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:55,702 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:55,702 - src.models.xgboost_model - INFO -   reg_alpha: 0.15452868534580036
2025-06-24 09:27:55,702 - src.models.xgboost_model - INFO -   reg_lambda: 6.474372455238996
2025-06-24 09:27:55,702 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:55,702 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:55,702 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:55,748 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:55,748 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:55,748 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:55,748 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:55,748 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,748 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,748 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,748 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,748 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,748 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,749 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,749 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,749 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:55,749 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,749 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:55,750 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:55,750 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:55,750 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:55,750 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:55,750 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,750 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:55,750 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:55,750 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:55,750 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:55,750 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:55,750 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:55,750 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:55,751 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,751 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,751 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,751 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,751 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:55,751 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:55,751 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:55,752 - src.training - INFO -   accuracy: 0.984
2025-06-24 09:27:55,752 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:55,752 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:55,752 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:55,752 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:55,752 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:55,752 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:55,752 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:55,752 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:55,752 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:55,752 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:55,752 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.984, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:55,752 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,752 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,752 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,752 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,770 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:55,770 - src.hyperparameter_tuning - ERROR - Trial 31 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:55,786 - src.hyperparameter_tuning - INFO - Trial 32: 모델 타입 = xgboost
2025-06-24 09:27:55,790 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:55,790 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:55,790 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:55,790 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:55,790 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:55,790 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:55,790 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:55,790 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:55,790 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:55,791 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:55,791 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:55,791 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:55,791 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:55,791 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:55,791 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:55,791 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:55,791 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:55,791 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:55,792 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:55,792 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:55,792 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:55,792 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:55,792 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:55,792 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:55,792 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:55,792 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:55,792 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:55,792 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:55,796 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:55,798 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:55,798 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:55,798 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:55,798 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:55,798 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:55,798 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:55,798 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:55,800 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:55,802 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:55,802 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:55,802 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:55,802 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:55,802 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:55,802 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:55,802 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:55,802 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:55,802 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,802 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,802 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:55,802 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:55,802 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,803 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,803 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:55,803 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:55,803 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,803 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:55,803 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:55,803 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:55,804 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:55,804 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:55,804 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:55,804 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:55,804 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:55,804 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:55,804 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:55,804 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:55,804 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:55,804 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,804 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:55,804 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:55,804 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,804 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,805 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,805 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,805 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,805 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,805 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,805 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,805 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:55,805 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,806 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:55,806 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,806 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,806 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:55,806 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:55,806 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,806 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,806 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,806 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,806 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,807 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,807 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,807 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,807 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:55,807 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,807 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:55,807 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,807 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:55,807 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,807 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:55,808 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:55,808 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:55,808 - src.models.xgboost_model - INFO -   n_estimators: 314
2025-06-24 09:27:55,808 - src.models.xgboost_model - INFO -   max_depth: 6
2025-06-24 09:27:55,808 - src.models.xgboost_model - INFO -   learning_rate: 0.02174606293132475
2025-06-24 09:27:55,808 - src.models.xgboost_model - INFO -   subsample: 0.7965463627014362
2025-06-24 09:27:55,808 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6756877771165838
2025-06-24 09:27:55,808 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 09:27:55,808 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:55,808 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:55,808 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:55,808 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:55,808 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:55,808 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:55,808 - src.models.xgboost_model - INFO -   reg_alpha: 6.688191458684811
2025-06-24 09:27:55,808 - src.models.xgboost_model - INFO -   reg_lambda: 1.278137745006047
2025-06-24 09:27:55,808 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:55,808 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:55,808 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:55,854 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:55,855 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:55,855 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:55,855 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:55,855 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,855 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,855 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,855 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,855 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,855 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,856 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,856 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,856 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:55,856 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,856 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:55,857 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:55,857 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:55,857 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:55,857 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:55,857 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,857 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:55,857 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:55,857 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:55,857 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:55,857 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:55,857 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:55,857 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:55,857 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,858 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,858 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,858 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,858 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:55,858 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:55,858 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:55,858 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:55,858 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:55,858 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:55,858 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:55,858 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:55,858 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:55,858 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:55,858 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:55,858 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:55,858 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:55,859 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:55,859 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:55,859 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,859 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,859 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,859 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,877 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:55,877 - src.hyperparameter_tuning - ERROR - Trial 32 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:55,892 - src.hyperparameter_tuning - INFO - Trial 33: 모델 타입 = xgboost
2025-06-24 09:27:55,896 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:55,897 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:55,897 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:55,897 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:55,897 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:55,897 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:55,897 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:55,897 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:55,897 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:55,898 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:55,898 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:55,898 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:55,898 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:55,898 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:55,898 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:55,898 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:55,898 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:55,898 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:55,899 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:55,899 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:55,899 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:55,899 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:55,899 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:55,899 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:55,899 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:55,899 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:55,899 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:55,899 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:55,902 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:55,904 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:55,904 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:55,904 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:55,904 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:55,904 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:55,904 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:55,904 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:55,907 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:55,908 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:55,908 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:55,908 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:55,909 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:55,909 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:55,909 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:55,909 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:55,909 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:55,909 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,909 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,909 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:55,909 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:55,909 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,909 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,909 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:55,909 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:55,909 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,910 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:55,910 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:55,910 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:55,911 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:55,911 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:55,911 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:55,911 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:55,911 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:55,911 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:55,911 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:55,911 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:55,911 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:55,911 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,911 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:55,911 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:55,911 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,911 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,911 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,911 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,912 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,912 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,912 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,912 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,912 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:55,912 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,912 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:55,912 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,912 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,913 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:55,913 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:55,913 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,913 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,913 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,913 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,913 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,913 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,913 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,914 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,914 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:55,914 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,914 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:55,914 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,914 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:55,914 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,914 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:55,914 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:55,914 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:55,914 - src.models.xgboost_model - INFO -   n_estimators: 668
2025-06-24 09:27:55,914 - src.models.xgboost_model - INFO -   max_depth: 14
2025-06-24 09:27:55,915 - src.models.xgboost_model - INFO -   learning_rate: 0.040993008605745
2025-06-24 09:27:55,915 - src.models.xgboost_model - INFO -   subsample: 0.8843190881003888
2025-06-24 09:27:55,915 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7202324585461473
2025-06-24 09:27:55,915 - src.models.xgboost_model - INFO -   min_child_weight: 5
2025-06-24 09:27:55,915 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:55,915 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:55,915 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:55,915 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:55,915 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:55,915 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:55,915 - src.models.xgboost_model - INFO -   reg_alpha: 0.019121490795512428
2025-06-24 09:27:55,915 - src.models.xgboost_model - INFO -   reg_lambda: 1.3187741955337704
2025-06-24 09:27:55,915 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:55,915 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:55,915 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:55,938 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:55,938 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:55,938 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:55,938 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:55,938 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,939 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,939 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,939 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,939 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,939 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,939 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,939 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,940 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:55,940 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,940 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:55,940 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:55,940 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:55,940 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:55,941 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:55,941 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,941 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:55,941 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:55,941 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:55,941 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:55,941 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:55,941 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:55,941 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:55,941 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,941 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,942 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,942 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:55,942 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:55,942 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:55,942 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:55,942 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:55,942 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:55,942 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:55,942 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:55,942 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:55,942 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:55,942 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:55,942 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:55,942 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:55,942 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:55,942 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:55,942 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:55,942 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,942 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,942 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,942 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,961 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:55,961 - src.hyperparameter_tuning - ERROR - Trial 33 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:55,976 - src.hyperparameter_tuning - INFO - Trial 34: 모델 타입 = xgboost
2025-06-24 09:27:55,980 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:55,981 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:55,981 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:55,981 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:55,981 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:55,981 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:55,981 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:55,981 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:55,981 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:55,981 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:55,981 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:55,982 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:55,982 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:55,982 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:55,982 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:55,982 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:55,982 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:55,982 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:55,982 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:55,983 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:55,983 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:55,983 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:55,983 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:55,983 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:55,983 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:55,983 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:55,983 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:55,983 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:55,986 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:55,988 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:55,989 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:55,989 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:55,989 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:55,989 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:55,989 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:55,989 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:55,991 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:55,994 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:55,994 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:55,994 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:55,994 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:55,994 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:55,994 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:55,994 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:55,994 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:55,994 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,994 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,995 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:55,995 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:55,995 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,995 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,995 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:55,995 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:55,995 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,995 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:55,995 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:55,995 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:55,996 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:55,996 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:55,997 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:55,997 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:55,997 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:55,997 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:55,997 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:55,997 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:55,997 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:55,997 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,997 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:55,997 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:55,997 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,997 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,997 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,997 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,998 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,998 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:55,998 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:55,998 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:55,998 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:55,998 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,999 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:55,999 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,999 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:55,999 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:55,999 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:55,999 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:55,999 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:55,999 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:55,999 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:55,999 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:55,999 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,000 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,000 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,000 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:56,000 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,000 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:56,000 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,000 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:56,000 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,000 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:56,001 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:56,001 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:56,001 - src.models.xgboost_model - INFO -   n_estimators: 600
2025-06-24 09:27:56,001 - src.models.xgboost_model - INFO -   max_depth: 8
2025-06-24 09:27:56,001 - src.models.xgboost_model - INFO -   learning_rate: 0.060139188644410736
2025-06-24 09:27:56,001 - src.models.xgboost_model - INFO -   subsample: 0.8190445679231486
2025-06-24 09:27:56,001 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6276136571831136
2025-06-24 09:27:56,001 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 09:27:56,001 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:56,001 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:56,001 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:56,001 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:56,001 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:56,001 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:56,001 - src.models.xgboost_model - INFO -   reg_alpha: 0.00010997174612556153
2025-06-24 09:27:56,001 - src.models.xgboost_model - INFO -   reg_lambda: 2.9142244270257804
2025-06-24 09:27:56,001 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:56,001 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:56,001 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:56,141 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:56,142 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:56,142 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:56,142 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:56,142 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,142 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,143 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,143 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,143 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,143 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,143 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,144 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,144 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:56,144 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,144 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:56,145 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:56,145 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:56,145 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:56,145 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:56,145 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,145 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:56,145 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:56,145 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:56,145 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:56,146 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:56,146 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:56,146 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:56,146 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,146 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,146 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,147 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,147 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:56,147 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:56,147 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:56,147 - src.training - INFO -   accuracy: 0.984
2025-06-24 09:27:56,147 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:56,147 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:56,147 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:56,147 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:56,147 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:56,147 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:56,147 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:56,147 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:56,147 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:56,148 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:56,148 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.984, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:56,148 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,148 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,148 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,148 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,167 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:56,167 - src.hyperparameter_tuning - ERROR - Trial 34 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:56,183 - src.hyperparameter_tuning - INFO - Trial 35: 모델 타입 = xgboost
2025-06-24 09:27:56,187 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:56,188 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:56,188 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:56,188 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:56,188 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:56,188 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:56,188 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:56,188 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:56,188 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:56,189 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:56,189 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:56,189 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:56,189 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:56,189 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:56,189 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:56,189 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:56,189 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:56,189 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:56,190 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:56,190 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:56,190 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:56,190 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:56,190 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:56,190 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:56,190 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:56,190 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:56,190 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:56,190 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:56,194 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:56,196 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:56,196 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:56,196 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:56,196 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:56,196 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:56,196 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:56,196 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:56,198 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:56,200 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:56,200 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:56,200 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:56,200 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:56,200 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:56,200 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:56,200 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:56,200 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:56,200 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,200 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,201 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:56,201 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:56,201 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,201 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,201 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:56,201 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:56,201 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,202 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:56,202 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:56,202 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:56,202 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:56,202 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:56,203 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:56,203 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:56,203 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:56,203 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:56,203 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:56,203 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:56,203 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:56,203 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,203 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:56,203 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:56,203 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,203 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,203 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,203 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,203 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,204 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,204 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,204 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,204 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:56,204 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,204 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:56,204 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,204 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,204 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:56,204 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:56,204 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,204 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,205 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,205 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,205 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,205 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,205 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,205 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,205 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:56,205 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:56,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,206 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:56,206 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,206 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:56,206 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:56,206 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:56,206 - src.models.xgboost_model - INFO -   n_estimators: 501
2025-06-24 09:27:56,206 - src.models.xgboost_model - INFO -   max_depth: 13
2025-06-24 09:27:56,206 - src.models.xgboost_model - INFO -   learning_rate: 0.09364149573021768
2025-06-24 09:27:56,206 - src.models.xgboost_model - INFO -   subsample: 0.7741645444647017
2025-06-24 09:27:56,206 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6556360654745068
2025-06-24 09:27:56,206 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 09:27:56,206 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:56,206 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:56,206 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:56,206 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:56,206 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:56,206 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:56,206 - src.models.xgboost_model - INFO -   reg_alpha: 0.4301485373653154
2025-06-24 09:27:56,206 - src.models.xgboost_model - INFO -   reg_lambda: 0.24084197435865054
2025-06-24 09:27:56,206 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:56,206 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:56,207 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:56,223 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:56,223 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:56,223 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:56,223 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:56,223 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,223 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,223 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,223 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,224 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,224 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,224 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,224 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,224 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:56,224 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,224 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:56,225 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:56,225 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:56,225 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:56,225 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:56,225 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,225 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:56,225 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:56,225 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:56,225 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:56,225 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:56,225 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:56,225 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:56,226 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,226 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,226 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,226 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,226 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:56,227 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:56,227 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:56,227 - src.training - INFO -   accuracy: 0.984
2025-06-24 09:27:56,227 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:56,227 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:56,227 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:56,227 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:56,227 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:56,227 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:56,227 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:56,227 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:56,227 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:56,227 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:56,227 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.984, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:56,227 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,227 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,227 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,227 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,245 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:56,246 - src.hyperparameter_tuning - ERROR - Trial 35 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:56,261 - src.hyperparameter_tuning - INFO - Trial 36: 모델 타입 = xgboost
2025-06-24 09:27:56,265 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:56,265 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:56,266 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:56,266 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:56,266 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:56,266 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:56,266 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:56,266 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:56,266 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:56,266 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:56,266 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:56,266 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:56,266 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:56,266 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:56,266 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:56,266 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:56,266 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:56,266 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:56,267 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:56,267 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:56,267 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:56,267 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:56,267 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:56,267 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:56,267 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:56,267 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:56,267 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:56,267 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:56,271 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:56,273 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:56,273 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:56,273 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:56,273 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:56,273 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:56,273 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:56,273 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:56,275 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:56,277 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:56,277 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:56,277 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:56,277 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:56,277 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:56,277 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:56,277 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:56,277 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:56,277 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,277 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,278 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:56,278 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:56,278 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,278 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,278 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:56,278 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:56,278 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,278 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:56,278 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:56,278 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:56,279 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:56,279 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:56,279 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:56,279 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:56,279 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:56,279 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:56,279 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:56,279 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:56,279 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:56,279 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,279 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:56,279 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:56,279 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,280 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,280 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,280 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,280 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,280 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,280 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,281 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,281 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:56,281 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,281 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:56,281 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,281 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,281 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:56,281 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:56,281 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,281 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,281 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,282 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,282 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,282 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,282 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,282 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,282 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:56,282 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,282 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:56,282 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,282 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:56,282 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,282 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:56,283 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:56,283 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:56,283 - src.models.xgboost_model - INFO -   n_estimators: 424
2025-06-24 09:27:56,283 - src.models.xgboost_model - INFO -   max_depth: 7
2025-06-24 09:27:56,283 - src.models.xgboost_model - INFO -   learning_rate: 0.014888463560777308
2025-06-24 09:27:56,283 - src.models.xgboost_model - INFO -   subsample: 0.694338834099599
2025-06-24 09:27:56,283 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6875943380135292
2025-06-24 09:27:56,283 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 09:27:56,283 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:56,283 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:56,283 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:56,283 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:56,283 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:56,283 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:56,283 - src.models.xgboost_model - INFO -   reg_alpha: 1.743190789530439e-05
2025-06-24 09:27:56,283 - src.models.xgboost_model - INFO -   reg_lambda: 0.05548526724430413
2025-06-24 09:27:56,283 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:56,283 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:56,283 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:56,341 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:56,341 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:56,341 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:56,341 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:56,341 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,341 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,342 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,342 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:56,342 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,342 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:56,344 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:56,344 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:56,344 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:56,344 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:56,344 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,344 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:56,344 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:56,344 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:56,345 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:56,345 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:56,345 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:56,345 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:56,345 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,345 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,345 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,346 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,346 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:56,346 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:56,346 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:56,346 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:27:56,346 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:56,346 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:56,346 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:56,346 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:56,346 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:56,346 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:56,346 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:56,346 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:56,346 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:56,346 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:56,346 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:56,346 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,346 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,346 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,346 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,365 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:56,365 - src.hyperparameter_tuning - ERROR - Trial 36 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:56,380 - src.hyperparameter_tuning - INFO - Trial 37: 모델 타입 = xgboost
2025-06-24 09:27:56,384 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:56,385 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:56,385 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:56,385 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:56,385 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:56,385 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:56,385 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:56,385 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:56,385 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:56,386 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:56,386 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:56,386 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:56,386 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:56,386 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:56,386 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:56,386 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:56,386 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:56,386 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:56,387 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:56,387 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:56,387 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:56,387 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:56,387 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:56,387 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:56,387 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:56,387 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:56,387 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:56,387 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:56,390 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:56,392 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:56,392 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:56,392 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:56,392 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:56,392 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:56,392 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:56,392 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:56,394 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:56,396 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:56,396 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:56,396 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:56,396 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:56,396 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:56,396 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:56,396 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:56,397 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:56,397 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,397 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,397 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:56,397 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:56,397 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,397 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,397 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:56,397 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:56,397 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,398 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:56,398 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:56,398 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:56,399 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:56,399 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:56,399 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:56,399 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:56,399 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:56,399 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:56,399 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:56,399 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:56,399 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:56,399 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,399 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:56,399 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:56,399 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,399 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,399 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,400 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,400 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,400 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,400 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:56,400 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,400 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:56,400 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,400 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,400 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:56,400 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:56,400 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,401 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,401 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,401 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,401 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,401 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,401 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,401 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,401 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:56,401 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,402 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:56,402 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,402 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:56,402 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,402 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:56,402 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:56,402 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:56,402 - src.models.xgboost_model - INFO -   n_estimators: 342
2025-06-24 09:27:56,402 - src.models.xgboost_model - INFO -   max_depth: 12
2025-06-24 09:27:56,402 - src.models.xgboost_model - INFO -   learning_rate: 0.011106177733945734
2025-06-24 09:27:56,402 - src.models.xgboost_model - INFO -   subsample: 0.6414109605820982
2025-06-24 09:27:56,402 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7582904913624
2025-06-24 09:27:56,402 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 09:27:56,402 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:56,402 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:56,402 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:56,402 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:56,402 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:56,402 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:56,402 - src.models.xgboost_model - INFO -   reg_alpha: 0.007901658723927483
2025-06-24 09:27:56,402 - src.models.xgboost_model - INFO -   reg_lambda: 0.011666773143898272
2025-06-24 09:27:56,402 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:56,402 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:56,403 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:56,470 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:56,470 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:56,470 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:56,471 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:56,471 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,471 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,471 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,471 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,471 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,471 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,472 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,472 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,472 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:56,472 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,472 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:56,473 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:56,473 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:56,473 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:56,473 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:56,473 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,473 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:56,473 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:56,473 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:56,473 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:56,473 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:56,473 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:56,473 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:56,473 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,474 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,474 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,474 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,474 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:56,474 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:56,474 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:56,474 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:56,474 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:56,474 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:56,474 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:56,474 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:56,474 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:56,474 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:56,474 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:56,474 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:56,474 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:56,475 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:56,475 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:56,475 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,475 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,475 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,475 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,494 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:56,494 - src.hyperparameter_tuning - ERROR - Trial 37 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:56,509 - src.hyperparameter_tuning - INFO - Trial 38: 모델 타입 = xgboost
2025-06-24 09:27:56,513 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:56,514 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:56,514 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:56,514 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:56,514 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:56,514 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:56,514 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:56,514 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:56,514 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:56,515 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:56,515 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:56,515 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:56,515 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:56,515 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:56,515 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:56,515 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:56,515 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:56,515 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:56,516 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:56,516 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:56,516 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:56,516 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:56,516 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:56,516 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:56,516 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:56,516 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:56,516 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:56,516 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:56,519 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:56,521 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:56,521 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:56,521 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:56,521 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:56,521 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:56,521 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:56,521 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:56,523 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:56,525 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:56,525 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:56,525 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:56,525 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:56,525 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:56,525 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:56,525 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:56,526 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:56,526 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,526 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,526 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:56,526 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:56,526 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,526 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,526 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:56,526 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:56,526 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,527 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:56,527 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:56,527 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:56,528 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:56,528 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:56,528 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:56,528 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:56,528 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:56,528 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:56,528 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:56,528 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:56,528 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:56,528 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,528 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:56,528 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:56,528 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,528 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,528 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,528 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,528 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,529 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,529 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,529 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,529 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:56,529 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,529 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:56,529 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,529 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,529 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:56,529 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:56,529 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,530 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,530 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,530 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,530 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,530 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,530 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,530 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,530 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:56,531 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,531 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:56,531 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,531 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:56,531 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,531 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:56,531 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:56,531 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:56,531 - src.models.xgboost_model - INFO -   n_estimators: 880
2025-06-24 09:27:56,531 - src.models.xgboost_model - INFO -   max_depth: 5
2025-06-24 09:27:56,531 - src.models.xgboost_model - INFO -   learning_rate: 0.06750932168685053
2025-06-24 09:27:56,531 - src.models.xgboost_model - INFO -   subsample: 0.904688600178765
2025-06-24 09:27:56,531 - src.models.xgboost_model - INFO -   colsample_bytree: 0.621663737839185
2025-06-24 09:27:56,531 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 09:27:56,531 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:56,531 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:56,531 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:56,531 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:56,531 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:56,531 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:56,531 - src.models.xgboost_model - INFO -   reg_alpha: 1.3895347834722849
2025-06-24 09:27:56,532 - src.models.xgboost_model - INFO -   reg_lambda: 0.5146821339084064
2025-06-24 09:27:56,532 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:56,532 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:56,532 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:56,552 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:56,552 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:56,552 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:56,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:56,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,553 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,553 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,554 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:56,554 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,554 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:56,554 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:56,554 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:56,554 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:56,554 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:56,554 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,555 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:56,555 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:56,555 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:56,555 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:56,555 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:56,555 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:56,555 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:56,555 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,555 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,555 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,556 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,556 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:56,556 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:56,556 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:56,556 - src.training - INFO -   accuracy: 0.984
2025-06-24 09:27:56,556 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:56,556 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:56,556 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:56,556 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:56,556 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:56,556 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:56,556 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:56,556 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:56,556 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:56,556 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:56,556 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.984, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:56,556 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,556 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,556 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,556 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,575 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:56,575 - src.hyperparameter_tuning - ERROR - Trial 38 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:56,591 - src.hyperparameter_tuning - INFO - Trial 39: 모델 타입 = xgboost
2025-06-24 09:27:56,595 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:56,595 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:56,595 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:56,595 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:56,595 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:56,595 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:56,595 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:56,595 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:56,595 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:56,596 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:56,596 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:56,596 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:56,596 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:56,596 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:56,596 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:56,596 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:56,596 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:56,596 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:56,597 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:56,597 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:56,597 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:56,597 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:56,597 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:56,597 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:56,597 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:56,597 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:56,597 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:56,597 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:56,601 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:56,603 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:56,603 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:56,603 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:56,603 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:56,603 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:56,603 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:56,603 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:56,605 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:56,607 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:56,607 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:56,607 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:56,607 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:56,607 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:56,607 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:56,607 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:56,607 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:56,607 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,607 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,608 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:56,608 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:56,608 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,608 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,608 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:56,608 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:56,608 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,608 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:56,608 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:56,608 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:56,609 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:56,609 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:56,609 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:56,609 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:56,609 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:56,609 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:56,609 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:56,609 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:56,609 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:56,609 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,609 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:56,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:56,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,610 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,610 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,610 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,610 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,610 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,610 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,611 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:56,611 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,611 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:56,611 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,611 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,611 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:56,611 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:56,611 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,611 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,611 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,611 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,612 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:56,612 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:56,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,612 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:56,612 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,612 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:56,613 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:56,613 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:56,613 - src.models.xgboost_model - INFO -   n_estimators: 678
2025-06-24 09:27:56,613 - src.models.xgboost_model - INFO -   max_depth: 4
2025-06-24 09:27:56,613 - src.models.xgboost_model - INFO -   learning_rate: 0.21222299187051066
2025-06-24 09:27:56,613 - src.models.xgboost_model - INFO -   subsample: 0.9458829506563314
2025-06-24 09:27:56,613 - src.models.xgboost_model - INFO -   colsample_bytree: 0.8247641928574576
2025-06-24 09:27:56,613 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 09:27:56,613 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:56,613 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:56,613 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:56,613 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:56,613 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:56,613 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:56,613 - src.models.xgboost_model - INFO -   reg_alpha: 3.219062241102895e-08
2025-06-24 09:27:56,613 - src.models.xgboost_model - INFO -   reg_lambda: 3.343806676566346
2025-06-24 09:27:56,613 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:56,613 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:56,613 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:56,621 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:56,621 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:56,621 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:56,621 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:56,621 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,622 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,622 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,622 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,622 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,622 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,622 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,623 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,623 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:56,623 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,623 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:56,623 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:56,624 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:56,624 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:56,624 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:56,624 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,624 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:56,624 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:56,624 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:56,624 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:56,624 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:56,624 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:56,624 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:56,624 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,624 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,625 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,625 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,625 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:56,625 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:56,625 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:56,625 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:27:56,625 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:56,625 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:56,625 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:56,625 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:56,625 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:56,625 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:56,625 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:56,625 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:56,625 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:56,625 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:56,626 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:56,626 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,626 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,626 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,626 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,645 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:56,645 - src.hyperparameter_tuning - ERROR - Trial 39 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:56,661 - src.hyperparameter_tuning - INFO - Trial 40: 모델 타입 = xgboost
2025-06-24 09:27:56,664 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:56,665 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:56,665 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:56,665 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:56,665 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:56,665 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:56,665 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:56,665 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:56,665 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:56,666 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:56,666 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:56,666 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:56,666 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:56,666 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:56,666 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:56,666 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:56,666 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:56,666 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:56,667 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:56,667 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:56,667 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:56,667 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:56,667 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:56,667 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:56,667 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:56,667 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:56,667 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:56,667 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:56,671 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:56,673 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:56,673 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:56,673 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:56,673 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:56,673 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:56,673 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:56,673 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:56,675 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:56,677 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:56,677 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:56,677 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:56,677 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:56,677 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:56,677 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:56,677 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:56,677 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:56,677 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,677 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,677 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:56,677 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:56,677 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,677 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,677 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:56,677 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:56,678 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,678 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:56,678 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:56,678 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:56,679 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:56,679 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:56,679 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:56,679 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:56,679 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:56,679 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:56,679 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:56,679 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:56,679 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:56,679 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,679 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:56,679 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:56,679 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,679 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,680 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,680 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,680 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,680 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,680 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,680 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,680 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:56,680 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,681 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:56,681 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,681 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,681 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:56,681 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:56,681 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,681 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,681 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,681 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,681 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,682 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,682 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,682 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,682 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:56,682 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:56,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,682 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:56,682 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,682 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:56,683 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:56,683 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:56,683 - src.models.xgboost_model - INFO -   n_estimators: 618
2025-06-24 09:27:56,683 - src.models.xgboost_model - INFO -   max_depth: 10
2025-06-24 09:27:56,683 - src.models.xgboost_model - INFO -   learning_rate: 0.05198302781935729
2025-06-24 09:27:56,683 - src.models.xgboost_model - INFO -   subsample: 0.8564381057543136
2025-06-24 09:27:56,683 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7365843039252995
2025-06-24 09:27:56,683 - src.models.xgboost_model - INFO -   min_child_weight: 7
2025-06-24 09:27:56,683 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:56,683 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:56,683 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:56,683 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:56,683 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:56,683 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:56,683 - src.models.xgboost_model - INFO -   reg_alpha: 4.205711048449931e-06
2025-06-24 09:27:56,683 - src.models.xgboost_model - INFO -   reg_lambda: 3.585773527491845e-08
2025-06-24 09:27:56,683 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:56,683 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:56,683 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:56,710 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:56,710 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:56,710 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:56,711 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:56,711 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,711 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,711 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,711 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,711 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,711 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,712 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,712 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,712 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:56,712 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,712 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:56,714 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:56,714 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:56,714 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:56,714 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:56,714 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,714 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:56,714 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:56,714 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:56,715 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:56,715 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:56,715 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:56,715 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:56,715 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,715 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,715 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,716 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,716 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:56,716 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:56,716 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:56,716 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:56,716 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:56,716 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:56,716 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:56,716 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:56,716 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:56,716 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:56,716 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:56,716 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:56,716 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:56,716 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:56,717 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:56,717 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,717 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,717 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,717 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,735 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:56,735 - src.hyperparameter_tuning - ERROR - Trial 40 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:56,752 - src.hyperparameter_tuning - INFO - Trial 41: 모델 타입 = xgboost
2025-06-24 09:27:56,755 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:56,756 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:56,756 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:56,756 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:56,756 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:56,756 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:56,756 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:56,756 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:56,756 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:56,757 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:56,757 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:56,757 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:56,757 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:56,757 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:56,757 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:56,757 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:56,757 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:56,757 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:56,758 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:56,758 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:56,758 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:56,758 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:56,758 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:56,758 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:56,758 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:56,758 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:56,758 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:56,758 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:56,762 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:56,764 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:56,764 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:56,764 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:56,764 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:56,764 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:56,764 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:56,764 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:56,766 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:56,768 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:56,768 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:56,768 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:56,768 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:56,768 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:56,768 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:56,768 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:56,768 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:56,768 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,768 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,769 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:56,769 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:56,769 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,769 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,769 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:56,769 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:56,769 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,770 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:56,770 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:56,770 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:56,770 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:56,771 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:56,771 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:56,771 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:56,771 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:56,771 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:56,771 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:56,771 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:56,771 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:56,771 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,771 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:56,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:56,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,771 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,771 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,771 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,772 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:56,772 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,772 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:56,772 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,772 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,772 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:56,772 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:56,772 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,773 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,774 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:56,774 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,774 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:56,774 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,774 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:56,774 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,774 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:56,774 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:56,774 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:56,774 - src.models.xgboost_model - INFO -   n_estimators: 369
2025-06-24 09:27:56,774 - src.models.xgboost_model - INFO -   max_depth: 4
2025-06-24 09:27:56,774 - src.models.xgboost_model - INFO -   learning_rate: 0.1076240804087041
2025-06-24 09:27:56,774 - src.models.xgboost_model - INFO -   subsample: 0.6763025298115524
2025-06-24 09:27:56,774 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6627347900135979
2025-06-24 09:27:56,774 - src.models.xgboost_model - INFO -   min_child_weight: 6
2025-06-24 09:27:56,774 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:56,774 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:56,774 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:56,774 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:56,774 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:56,774 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:56,775 - src.models.xgboost_model - INFO -   reg_alpha: 2.9005208564701332e-08
2025-06-24 09:27:56,775 - src.models.xgboost_model - INFO -   reg_lambda: 1.59985066458589
2025-06-24 09:27:56,775 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:56,775 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:56,775 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:56,785 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:56,785 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:56,785 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:56,785 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:56,785 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,786 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,786 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,786 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,786 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,786 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,786 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,786 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,787 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:56,787 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,787 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:56,787 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:56,787 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:56,787 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:56,787 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:56,788 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,788 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:56,788 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:56,788 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:56,788 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:56,788 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:56,788 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:56,788 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:56,788 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,789 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,789 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,789 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,789 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:56,789 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:56,789 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:56,789 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:27:56,789 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:56,789 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:56,789 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:56,789 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:56,789 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:56,789 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:56,789 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:56,789 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:56,789 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:56,790 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:56,790 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:56,790 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,790 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,790 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,790 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,809 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:56,809 - src.hyperparameter_tuning - ERROR - Trial 41 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:56,826 - src.hyperparameter_tuning - INFO - Trial 42: 모델 타입 = xgboost
2025-06-24 09:27:56,830 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:56,830 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:56,830 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:56,831 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:56,831 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:56,831 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:56,831 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:56,831 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:56,831 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:56,831 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:56,831 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:56,831 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:56,831 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:56,831 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:56,831 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:56,831 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:56,831 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:56,831 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:56,832 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:56,832 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:56,832 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:56,833 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:56,833 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:56,833 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:56,833 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:56,833 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:56,833 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:56,833 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:56,836 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:56,838 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:56,838 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:56,838 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:56,838 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:56,838 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:56,839 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:56,839 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:56,841 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:56,843 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:56,843 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:56,843 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:56,843 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:56,843 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:56,843 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:56,843 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:56,843 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:56,843 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,843 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,843 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:56,844 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:56,844 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,844 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,844 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:56,844 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:56,844 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,844 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:56,844 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:56,844 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:56,845 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:56,845 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:56,845 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:56,845 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:56,845 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:56,845 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:56,845 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:56,845 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:56,845 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:56,845 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,845 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:56,845 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:56,845 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,846 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,846 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,847 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,847 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,847 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:56,847 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,847 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:56,847 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,847 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,848 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:56,848 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:56,848 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,848 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,848 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,848 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,848 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,849 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,849 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,849 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,849 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:56,849 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,849 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:56,849 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,849 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:56,849 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,849 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:56,850 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:56,850 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:56,850 - src.models.xgboost_model - INFO -   n_estimators: 271
2025-06-24 09:27:56,850 - src.models.xgboost_model - INFO -   max_depth: 6
2025-06-24 09:27:56,850 - src.models.xgboost_model - INFO -   learning_rate: 0.13429211658836965
2025-06-24 09:27:56,850 - src.models.xgboost_model - INFO -   subsample: 0.8080684433645796
2025-06-24 09:27:56,850 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6971511938015964
2025-06-24 09:27:56,850 - src.models.xgboost_model - INFO -   min_child_weight: 10
2025-06-24 09:27:56,850 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:56,850 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:56,850 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:56,850 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:56,850 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:56,850 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:56,850 - src.models.xgboost_model - INFO -   reg_alpha: 1.2343027946286545e-06
2025-06-24 09:27:56,850 - src.models.xgboost_model - INFO -   reg_lambda: 0.4775527568543944
2025-06-24 09:27:56,850 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:56,850 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:56,850 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:56,862 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:56,863 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:56,863 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:56,863 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:56,863 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,863 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,863 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,864 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,864 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,864 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:56,864 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,864 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:56,865 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:56,865 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:56,865 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:56,865 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:56,865 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,865 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:56,865 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:56,865 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:56,865 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:56,865 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:56,865 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:56,865 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:56,866 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,866 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,866 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,866 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,866 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:56,866 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:56,866 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:56,866 - src.training - INFO -   accuracy: 0.972
2025-06-24 09:27:56,866 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:56,866 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:56,866 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:56,867 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:56,867 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:56,867 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:56,867 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:56,867 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:56,867 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:56,867 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:56,867 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.972, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:56,867 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,867 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,867 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,867 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,887 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:56,887 - src.hyperparameter_tuning - ERROR - Trial 42 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:56,902 - src.hyperparameter_tuning - INFO - Trial 43: 모델 타입 = xgboost
2025-06-24 09:27:56,906 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:56,907 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:56,907 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:56,907 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:56,907 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:56,907 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:56,907 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:56,907 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:56,907 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:56,908 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:56,908 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:56,908 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:56,908 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:56,908 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:56,908 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:56,908 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:56,908 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:56,908 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:56,909 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:56,909 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:56,909 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:56,909 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:56,909 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:56,909 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:56,909 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:56,909 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:56,909 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:56,909 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:56,912 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:56,914 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:56,914 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:56,914 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:56,914 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:56,915 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:56,915 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:56,915 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:56,917 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:56,918 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:56,918 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:56,918 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:56,919 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:56,919 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:56,919 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:56,919 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:56,919 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:56,919 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,919 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,919 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:56,919 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:56,919 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,919 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,919 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:56,919 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:56,919 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,920 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:56,920 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:56,920 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:56,921 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:56,921 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:56,921 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:56,921 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:56,921 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:56,921 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:56,921 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:56,921 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:56,921 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:56,921 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,921 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:56,921 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:56,921 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,921 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,921 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,921 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,922 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,922 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,922 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,922 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,922 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:56,922 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,922 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:56,922 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,922 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,922 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:56,922 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:56,922 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,923 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,923 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,923 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,923 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,923 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,923 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,924 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:56,924 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,924 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:56,924 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,924 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:56,924 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,924 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:56,924 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:56,924 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:56,924 - src.models.xgboost_model - INFO -   n_estimators: 164
2025-06-24 09:27:56,924 - src.models.xgboost_model - INFO -   max_depth: 3
2025-06-24 09:27:56,924 - src.models.xgboost_model - INFO -   learning_rate: 0.08809079171602548
2025-06-24 09:27:56,924 - src.models.xgboost_model - INFO -   subsample: 0.6270147255078318
2025-06-24 09:27:56,924 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6398538218149827
2025-06-24 09:27:56,924 - src.models.xgboost_model - INFO -   min_child_weight: 7
2025-06-24 09:27:56,924 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:56,924 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:56,924 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:56,925 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:56,925 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:56,925 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:56,925 - src.models.xgboost_model - INFO -   reg_alpha: 1.588159572221995e-08
2025-06-24 09:27:56,925 - src.models.xgboost_model - INFO -   reg_lambda: 4.710562529570451
2025-06-24 09:27:56,925 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:56,925 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:56,925 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:56,938 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:56,938 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:56,938 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:56,938 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:56,938 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,938 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,938 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,938 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,939 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,939 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,939 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,939 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,939 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:56,939 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,939 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:56,940 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:56,940 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:56,940 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:56,940 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:56,940 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,940 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:56,940 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:56,940 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:56,940 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:56,940 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:56,940 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:56,940 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:56,941 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,941 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,941 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,941 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:56,941 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:56,941 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:56,941 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:56,941 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:56,941 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:56,942 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:56,942 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:56,942 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:56,942 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:56,942 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:56,942 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:56,942 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:56,942 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:56,942 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:56,942 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:56,942 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,942 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,942 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,942 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,961 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:56,962 - src.hyperparameter_tuning - ERROR - Trial 43 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:56,978 - src.hyperparameter_tuning - INFO - Trial 44: 모델 타입 = xgboost
2025-06-24 09:27:56,982 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:56,982 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:56,982 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:56,982 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:56,982 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:56,982 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:56,982 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:56,982 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:56,982 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:56,983 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:56,983 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:56,983 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:56,983 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:56,983 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:56,983 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:56,983 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:56,983 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:56,983 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:56,984 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:56,984 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:56,984 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:56,984 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:56,984 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:56,984 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:56,984 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:56,984 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:56,984 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:56,984 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:56,988 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:56,990 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:56,990 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:56,990 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:56,990 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:56,990 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:56,990 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:56,990 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:56,992 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:56,994 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:56,994 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:56,994 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:56,994 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:56,994 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:56,994 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:56,994 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:56,994 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:56,994 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,994 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,995 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:56,995 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:56,995 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,995 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,995 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:56,995 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:56,995 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,995 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:56,995 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:56,995 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:56,996 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:56,996 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:56,996 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:56,996 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:56,996 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:56,996 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:56,996 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:56,996 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:56,996 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:56,996 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,996 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:56,996 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:56,996 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,997 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,997 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,997 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,997 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,997 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,997 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,997 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,998 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:56,998 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,998 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:56,998 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,998 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,998 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:56,998 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:56,998 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,998 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:56,998 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:56,998 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:56,999 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:56,999 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:56,999 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:56,999 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:56,999 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:56,999 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:56,999 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:56,999 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,999 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:56,999 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:56,999 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:57,000 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:57,000 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:57,000 - src.models.xgboost_model - INFO -   n_estimators: 553
2025-06-24 09:27:57,000 - src.models.xgboost_model - INFO -   max_depth: 14
2025-06-24 09:27:57,000 - src.models.xgboost_model - INFO -   learning_rate: 0.0627062981779422
2025-06-24 09:27:57,000 - src.models.xgboost_model - INFO -   subsample: 0.7604324091183771
2025-06-24 09:27:57,000 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7127611342766016
2025-06-24 09:27:57,000 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 09:27:57,000 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:57,000 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:57,000 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:57,000 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:57,000 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:57,000 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:57,000 - src.models.xgboost_model - INFO -   reg_alpha: 1.3665097608208182e-07
2025-06-24 09:27:57,000 - src.models.xgboost_model - INFO -   reg_lambda: 0.12470993335985998
2025-06-24 09:27:57,000 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:57,000 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:57,000 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:57,018 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:57,018 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:57,018 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:57,018 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:57,018 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,019 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,019 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,019 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,019 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,019 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,019 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,019 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,020 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:57,020 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,020 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:57,020 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:57,020 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:57,021 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:57,021 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:57,021 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,021 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:57,021 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:57,021 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:57,021 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:57,021 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:57,021 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:57,021 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:57,021 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,021 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,022 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,022 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,022 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:57,022 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:57,022 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:57,022 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:57,022 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:57,022 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:57,022 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:57,022 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:57,022 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:57,022 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:57,022 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:57,022 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:57,022 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:57,022 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:57,022 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:57,022 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,022 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,022 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,022 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,042 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:57,042 - src.hyperparameter_tuning - ERROR - Trial 44 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:57,058 - src.hyperparameter_tuning - INFO - Trial 45: 모델 타입 = xgboost
2025-06-24 09:27:57,062 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:57,063 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:57,063 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:57,063 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:57,063 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:57,063 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:57,063 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:57,063 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:57,063 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:57,063 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:57,063 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:57,063 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:57,063 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:57,063 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:57,063 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:57,063 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:57,063 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:57,063 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:57,064 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:57,064 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:57,064 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:57,065 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:57,065 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:57,065 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:57,065 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:57,065 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:57,065 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:57,065 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:57,068 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:57,070 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:57,070 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:57,070 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:57,070 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:57,070 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:57,070 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:57,070 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:57,072 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:57,074 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:57,074 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:57,074 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:57,074 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:57,074 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:57,074 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:57,075 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:57,075 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:57,075 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,075 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,075 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:57,075 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:57,075 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,075 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,075 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:57,075 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:57,075 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,076 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:57,076 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:57,076 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:57,077 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:57,077 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:57,077 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:57,077 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:57,077 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:57,077 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:57,077 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:57,077 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:57,077 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:57,077 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,077 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:57,077 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:57,077 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,077 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,077 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,077 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,078 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:57,078 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,078 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:57,078 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,078 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,079 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:57,079 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:57,079 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,079 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,079 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,079 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,079 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,079 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,079 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,080 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,080 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:57,080 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,080 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:57,080 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,080 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:57,080 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,080 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:57,080 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:57,081 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:57,081 - src.models.xgboost_model - INFO -   n_estimators: 494
2025-06-24 09:27:57,081 - src.models.xgboost_model - INFO -   max_depth: 3
2025-06-24 09:27:57,081 - src.models.xgboost_model - INFO -   learning_rate: 0.11422611121472559
2025-06-24 09:27:57,081 - src.models.xgboost_model - INFO -   subsample: 0.8767679257799672
2025-06-24 09:27:57,081 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6756203282568491
2025-06-24 09:27:57,081 - src.models.xgboost_model - INFO -   min_child_weight: 5
2025-06-24 09:27:57,081 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:57,081 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:57,081 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:57,081 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:57,081 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:57,081 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:57,081 - src.models.xgboost_model - INFO -   reg_alpha: 3.1298607191768083e-07
2025-06-24 09:27:57,081 - src.models.xgboost_model - INFO -   reg_lambda: 7.334888586850769e-05
2025-06-24 09:27:57,081 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:57,081 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:57,081 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:57,093 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:57,093 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:57,093 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:57,093 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:57,093 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,093 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,094 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,094 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,094 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,094 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,094 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,094 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,094 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:57,094 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,095 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:57,095 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:57,095 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:57,095 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:57,095 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:57,095 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,095 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:57,095 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:57,095 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:57,096 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:57,096 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:57,096 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:57,096 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:57,096 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,096 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,096 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,097 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,097 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:57,097 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:57,097 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:57,097 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:57,097 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:57,097 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:57,097 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:57,097 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:57,097 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:57,097 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:57,097 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:57,097 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:57,097 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:57,097 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:57,097 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:57,097 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,097 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,097 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,097 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,117 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:57,117 - src.hyperparameter_tuning - ERROR - Trial 45 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:57,133 - src.hyperparameter_tuning - INFO - Trial 46: 모델 타입 = xgboost
2025-06-24 09:27:57,137 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:57,137 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:57,137 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:57,137 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:57,137 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:57,137 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:57,137 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:57,137 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:57,137 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:57,138 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:57,138 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:57,138 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:57,138 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:57,138 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:57,138 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:57,138 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:57,138 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:57,138 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:57,139 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:57,139 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:57,139 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:57,139 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:57,139 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:57,139 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:57,139 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:57,139 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:57,139 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:57,139 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:57,143 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:57,145 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:57,145 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:57,145 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:57,145 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:57,145 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:57,145 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:57,145 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:57,147 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:57,149 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:57,149 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:57,149 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:57,149 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:57,149 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:57,149 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:57,149 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:57,149 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:57,149 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,149 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,150 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:57,150 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:57,150 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,150 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,150 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:57,150 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:57,150 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,150 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:57,150 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:57,150 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:57,151 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:57,151 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:57,151 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:57,151 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:57,151 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:57,151 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:57,151 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:57,151 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:57,151 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:57,151 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,151 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:57,151 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:57,151 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,152 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,152 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,152 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,152 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,152 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,152 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,152 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,153 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:57,153 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,153 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:57,153 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,153 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,153 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:57,153 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:57,153 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,153 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,153 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,153 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,154 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,154 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,154 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,154 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,154 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:57,154 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,154 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:57,154 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,154 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:57,154 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,154 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:57,155 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:57,155 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:57,155 - src.models.xgboost_model - INFO -   n_estimators: 394
2025-06-24 09:27:57,155 - src.models.xgboost_model - INFO -   max_depth: 4
2025-06-24 09:27:57,155 - src.models.xgboost_model - INFO -   learning_rate: 0.24336618057064013
2025-06-24 09:27:57,155 - src.models.xgboost_model - INFO -   subsample: 0.9001275835219629
2025-06-24 09:27:57,155 - src.models.xgboost_model - INFO -   colsample_bytree: 0.8893506055014104
2025-06-24 09:27:57,155 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 09:27:57,155 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:57,155 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:57,155 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:57,155 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:57,155 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:57,155 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:57,155 - src.models.xgboost_model - INFO -   reg_alpha: 0.0012794749252556005
2025-06-24 09:27:57,155 - src.models.xgboost_model - INFO -   reg_lambda: 0.0008826355019954863
2025-06-24 09:27:57,155 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:57,155 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:57,155 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:57,164 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:57,164 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:57,164 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:57,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:57,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,164 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,165 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:57,165 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,165 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:57,166 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:57,166 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:57,166 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:57,166 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:57,166 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,166 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:57,166 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:57,166 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:57,166 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:57,166 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:57,166 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:57,167 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:57,167 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,167 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,167 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,167 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,168 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:57,168 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:57,168 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:57,168 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:57,168 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:57,168 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:57,168 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:57,168 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:57,168 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:57,168 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:57,168 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:57,168 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:57,168 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:57,168 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:57,168 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:57,168 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,168 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,168 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,168 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,188 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:57,188 - src.hyperparameter_tuning - ERROR - Trial 46 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:57,204 - src.hyperparameter_tuning - INFO - Trial 47: 모델 타입 = xgboost
2025-06-24 09:27:57,208 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:57,209 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:57,209 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:57,209 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:57,209 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:57,209 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:57,209 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:57,209 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:57,209 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:57,209 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:57,209 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:57,209 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:57,209 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:57,209 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:57,209 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:57,209 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:57,209 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:57,209 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:57,210 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:57,210 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:57,210 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:57,210 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:57,210 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:57,211 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:57,211 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:57,211 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:57,211 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:57,211 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:57,214 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:57,216 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:57,216 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:57,216 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:57,216 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:57,216 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:57,216 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:57,216 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:57,218 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:57,220 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:57,220 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:57,220 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:57,220 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:57,220 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:57,220 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:57,220 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:57,220 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:57,220 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,220 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,221 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:57,221 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:57,221 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,221 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,221 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:57,221 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:57,221 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,222 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:57,222 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:57,222 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:57,223 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:57,223 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:57,223 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:57,223 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:57,223 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:57,223 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:57,223 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:57,223 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:57,223 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:57,223 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,223 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:57,223 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:57,223 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,223 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,223 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,223 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,223 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,224 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,224 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,224 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,224 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:57,224 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,224 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:57,224 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,224 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,224 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:57,224 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:57,224 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,225 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,225 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,225 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,225 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,225 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,225 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,225 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,225 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:57,225 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,226 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:57,226 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,226 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:57,226 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,226 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:57,226 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:57,226 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:57,226 - src.models.xgboost_model - INFO -   n_estimators: 298
2025-06-24 09:27:57,226 - src.models.xgboost_model - INFO -   max_depth: 11
2025-06-24 09:27:57,226 - src.models.xgboost_model - INFO -   learning_rate: 0.29798215010771406
2025-06-24 09:27:57,226 - src.models.xgboost_model - INFO -   subsample: 0.9661743588899239
2025-06-24 09:27:57,226 - src.models.xgboost_model - INFO -   colsample_bytree: 0.778358810756072
2025-06-24 09:27:57,226 - src.models.xgboost_model - INFO -   min_child_weight: 8
2025-06-24 09:27:57,226 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:57,226 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:57,226 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:57,226 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:57,226 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:57,226 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:57,226 - src.models.xgboost_model - INFO -   reg_alpha: 6.949241088266816e-08
2025-06-24 09:27:57,226 - src.models.xgboost_model - INFO -   reg_lambda: 9.259217630906102
2025-06-24 09:27:57,226 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:57,226 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:57,227 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:57,238 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:57,238 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:57,238 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:57,238 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:57,238 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,238 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,238 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,238 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,238 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,239 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,239 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,239 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,239 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:57,239 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,239 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:57,240 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:57,240 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:57,240 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:57,240 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:57,240 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,240 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:57,240 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:57,240 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:57,240 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:57,240 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:57,240 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:57,240 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:57,241 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,241 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,241 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,241 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,241 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:57,241 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:57,242 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:57,242 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:57,242 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:57,242 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:57,242 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:57,242 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:57,242 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:57,242 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:57,242 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:57,242 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:57,242 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:57,242 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:57,242 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:57,242 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,242 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,242 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,242 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,261 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:57,262 - src.hyperparameter_tuning - ERROR - Trial 47 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:57,278 - src.hyperparameter_tuning - INFO - Trial 48: 모델 타입 = xgboost
2025-06-24 09:27:57,282 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:57,283 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:57,283 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:57,283 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:57,283 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:57,283 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:57,283 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:57,283 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:57,283 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:57,283 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:57,283 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:57,283 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:57,283 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:57,283 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:57,283 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:57,283 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:57,283 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:57,283 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:57,284 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:57,284 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:57,284 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:57,284 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:57,284 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:57,284 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:57,284 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:57,285 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:57,285 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:57,285 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:57,288 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:57,290 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:57,290 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:57,290 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:57,290 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:57,290 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:57,290 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:57,290 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:57,292 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:57,294 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:57,294 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:57,294 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:57,294 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:57,294 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:57,294 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:57,294 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:57,294 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:57,294 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,295 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,295 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:57,295 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:57,295 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,295 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,295 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:57,295 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:57,295 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,296 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:57,296 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:57,296 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:57,297 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:57,297 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:57,297 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:57,297 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:57,297 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:57,297 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:57,297 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:57,297 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:57,297 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:57,297 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,297 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:57,297 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:57,297 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,297 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,297 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,298 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:57,298 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:57,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,298 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,298 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:57,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:57,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,299 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,299 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,299 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,299 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,299 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,299 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,299 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:57,299 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,300 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:57,300 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,300 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:57,300 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,300 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:57,300 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:57,300 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:57,300 - src.models.xgboost_model - INFO -   n_estimators: 189
2025-06-24 09:27:57,300 - src.models.xgboost_model - INFO -   max_depth: 6
2025-06-24 09:27:57,300 - src.models.xgboost_model - INFO -   learning_rate: 0.1418689101868712
2025-06-24 09:27:57,300 - src.models.xgboost_model - INFO -   subsample: 0.6752502540594851
2025-06-24 09:27:57,300 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6139781114763024
2025-06-24 09:27:57,300 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 09:27:57,300 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:57,300 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:57,300 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:57,300 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:57,300 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:57,300 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:57,300 - src.models.xgboost_model - INFO -   reg_alpha: 6.399531868419384e-07
2025-06-24 09:27:57,300 - src.models.xgboost_model - INFO -   reg_lambda: 0.006050576339212821
2025-06-24 09:27:57,300 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:57,300 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:57,301 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:57,310 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:57,310 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:57,310 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:57,310 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:57,310 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,311 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,311 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,311 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,311 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,311 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,311 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,312 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:57,312 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:57,312 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:57,313 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:57,313 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:57,313 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:57,313 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,313 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:57,313 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:57,313 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:57,313 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:57,313 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:57,313 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:57,313 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:57,313 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,313 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,314 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,314 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,314 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:57,314 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:57,314 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:57,314 - src.training - INFO -   accuracy: 0.988
2025-06-24 09:27:57,314 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:57,314 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:57,314 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:57,314 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:57,314 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:57,314 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:57,314 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:57,314 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:57,314 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:57,314 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:57,314 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.988, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:57,314 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,315 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,315 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,315 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,334 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:57,334 - src.hyperparameter_tuning - ERROR - Trial 48 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:57,351 - src.hyperparameter_tuning - INFO - Trial 49: 모델 타입 = xgboost
2025-06-24 09:27:57,355 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:57,355 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:57,355 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:57,355 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:57,355 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:57,355 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:57,355 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:57,355 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:57,355 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:57,356 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:57,356 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:57,356 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:57,356 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:57,356 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:57,356 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:57,356 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:57,356 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:57,356 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:57,357 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:57,357 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:57,357 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:57,357 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:57,357 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:57,357 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:57,357 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:57,357 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:57,357 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:57,357 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:57,361 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:57,363 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:57,363 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:57,363 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:57,363 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:57,363 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:57,363 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:57,363 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:57,365 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:57,367 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:57,367 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:57,367 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:57,367 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:57,367 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:57,367 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:57,367 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:57,367 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:57,367 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,367 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,367 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:57,367 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:57,367 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,367 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,368 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:57,368 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:57,368 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,368 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:57,368 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:57,368 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:57,369 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:57,369 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:57,369 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:57,369 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:57,369 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:57,369 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:57,369 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:57,369 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:57,369 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:57,369 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,369 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:57,369 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:57,369 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,369 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,370 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,370 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,370 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,370 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,370 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,370 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,370 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:57,370 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:57,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,371 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,371 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:57,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:57,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,371 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,371 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,371 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,372 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,372 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,372 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,372 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:57,372 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,372 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:57,372 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,372 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:57,372 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,372 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:57,373 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:57,373 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:57,373 - src.models.xgboost_model - INFO -   n_estimators: 430
2025-06-24 09:27:57,373 - src.models.xgboost_model - INFO -   max_depth: 5
2025-06-24 09:27:57,373 - src.models.xgboost_model - INFO -   learning_rate: 0.1804892664511068
2025-06-24 09:27:57,373 - src.models.xgboost_model - INFO -   subsample: 0.7240973217947033
2025-06-24 09:27:57,373 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7319174857634566
2025-06-24 09:27:57,373 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 09:27:57,373 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:57,373 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:57,373 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:57,373 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:57,373 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:57,373 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:57,373 - src.models.xgboost_model - INFO -   reg_alpha: 0.0032312321183842947
2025-06-24 09:27:57,373 - src.models.xgboost_model - INFO -   reg_lambda: 0.6941288572073859
2025-06-24 09:27:57,373 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:57,373 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:57,373 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:57,388 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:57,388 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:57,388 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:57,388 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:57,388 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,389 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,389 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,389 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,389 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,389 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,389 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,389 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,390 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:57,390 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,390 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:57,392 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:57,392 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:57,392 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:57,392 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:57,392 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,392 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:57,392 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:57,392 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:57,393 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:57,393 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:57,393 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:57,393 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:57,393 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,393 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,393 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,394 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,394 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:57,394 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:57,394 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:57,394 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:57,394 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:57,394 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:57,394 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:57,394 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:57,394 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:57,394 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:57,394 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:57,394 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:57,394 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:57,394 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:57,394 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:57,394 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,394 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,394 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,394 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,414 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:57,414 - src.hyperparameter_tuning - ERROR - Trial 49 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:57,430 - src.hyperparameter_tuning - INFO - Trial 50: 모델 타입 = xgboost
2025-06-24 09:27:57,434 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:57,435 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:57,435 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:57,435 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:57,435 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:57,435 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:57,435 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:57,435 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:57,435 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:57,436 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:57,436 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:57,436 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:57,436 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:57,436 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:57,436 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:57,436 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:57,436 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:57,436 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:57,437 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:57,437 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:57,437 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:57,437 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:57,437 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:57,437 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:57,437 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:57,437 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:57,437 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:57,437 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:57,440 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:57,442 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:57,442 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:57,442 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:57,443 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:57,443 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:57,443 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:57,443 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:57,445 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:57,447 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:57,447 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:57,447 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:57,447 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:57,447 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:57,447 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:57,447 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:57,447 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:57,447 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,447 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,447 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:57,447 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:57,447 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,447 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,447 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:57,447 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:57,448 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,448 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:57,448 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:57,448 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:57,449 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:57,449 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:57,449 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:57,449 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:57,449 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:57,449 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:57,449 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:57,449 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:57,449 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:57,449 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,449 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:57,449 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:57,449 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,449 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,450 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,450 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,450 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,450 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,450 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,450 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,451 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:57,451 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,451 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:57,451 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,451 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,451 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:57,451 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:57,451 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,451 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,451 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,451 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,452 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,452 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,452 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,452 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,452 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:57,452 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,452 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:57,452 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,452 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:57,452 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,452 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:57,453 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:57,453 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:57,453 - src.models.xgboost_model - INFO -   n_estimators: 541
2025-06-24 09:27:57,453 - src.models.xgboost_model - INFO -   max_depth: 9
2025-06-24 09:27:57,453 - src.models.xgboost_model - INFO -   learning_rate: 0.07125957809364941
2025-06-24 09:27:57,453 - src.models.xgboost_model - INFO -   subsample: 0.8312032021181727
2025-06-24 09:27:57,453 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6494404050180482
2025-06-24 09:27:57,453 - src.models.xgboost_model - INFO -   min_child_weight: 5
2025-06-24 09:27:57,453 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:57,453 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:57,453 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:57,453 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:57,453 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:57,453 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:57,453 - src.models.xgboost_model - INFO -   reg_alpha: 3.5845850004506444e-05
2025-06-24 09:27:57,453 - src.models.xgboost_model - INFO -   reg_lambda: 0.06397004500862312
2025-06-24 09:27:57,453 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:57,453 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:57,453 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:57,466 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:57,467 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:57,467 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:57,467 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:57,467 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,467 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,467 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,467 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,467 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,468 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,468 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,468 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,468 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:57,468 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,468 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:57,469 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:57,469 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:57,469 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:57,469 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:57,469 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,469 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:57,469 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:57,469 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:57,469 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:57,469 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:57,469 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:57,469 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:57,469 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,470 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,470 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,470 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,470 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:57,470 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:57,470 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:57,470 - src.training - INFO -   accuracy: 0.984
2025-06-24 09:27:57,470 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:57,470 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:57,470 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:57,470 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:57,470 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:57,470 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:57,470 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:57,470 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:57,470 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:57,471 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:57,471 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.984, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:57,471 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,471 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,471 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,471 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,491 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:57,491 - src.hyperparameter_tuning - ERROR - Trial 50 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:57,508 - src.hyperparameter_tuning - INFO - Trial 51: 모델 타입 = xgboost
2025-06-24 09:27:57,512 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:57,513 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:57,513 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:57,513 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:57,513 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:57,513 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:57,513 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:57,513 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:57,513 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:57,514 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:57,514 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:57,514 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:57,514 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:57,514 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:57,514 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:57,514 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:57,514 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:57,514 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:57,515 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:57,515 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:57,515 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:57,515 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:57,515 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:57,515 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:57,515 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:57,515 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:57,515 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:57,515 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:57,518 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:57,520 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:57,520 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:57,520 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:57,520 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:57,520 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:57,520 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:57,520 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:57,522 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:57,524 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:57,524 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:57,524 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:57,524 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:57,524 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:57,524 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:57,525 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:57,525 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:57,525 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,525 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,525 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:57,525 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:57,525 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,525 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,525 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:57,525 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:57,525 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,526 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:57,526 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:57,526 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:57,527 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:57,527 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:57,527 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:57,527 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:57,527 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:57,527 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:57,527 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:57,527 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:57,527 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:57,527 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,527 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:57,527 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:57,527 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,527 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,527 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,527 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,527 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,528 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,528 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,528 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,528 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:57,528 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,528 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:57,528 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,528 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,528 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:57,528 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:57,528 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,529 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,529 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,529 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,529 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,529 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,529 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,529 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,529 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:57,530 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,530 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:57,530 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,530 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:57,530 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,530 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:57,530 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:57,530 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:57,530 - src.models.xgboost_model - INFO -   n_estimators: 658
2025-06-24 09:27:57,530 - src.models.xgboost_model - INFO -   max_depth: 7
2025-06-24 09:27:57,530 - src.models.xgboost_model - INFO -   learning_rate: 0.034601828263179514
2025-06-24 09:27:57,530 - src.models.xgboost_model - INFO -   subsample: 0.7872784986272265
2025-06-24 09:27:57,530 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6726462554343288
2025-06-24 09:27:57,530 - src.models.xgboost_model - INFO -   min_child_weight: 9
2025-06-24 09:27:57,530 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:57,530 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:57,530 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:57,530 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:57,530 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:57,530 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:57,530 - src.models.xgboost_model - INFO -   reg_alpha: 0.07767750626699792
2025-06-24 09:27:57,530 - src.models.xgboost_model - INFO -   reg_lambda: 2.5813054874658548
2025-06-24 09:27:57,530 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:57,530 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:57,531 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:57,556 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:57,556 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:57,556 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:57,556 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:57,556 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,557 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,558 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:57,558 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:57,558 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:57,559 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:57,559 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:57,559 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:57,559 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,559 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:57,559 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:57,559 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:57,559 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:57,559 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:57,559 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:57,559 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:57,559 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,559 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,560 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,560 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,560 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:57,560 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:57,560 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:57,560 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:57,560 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:57,560 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:57,560 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:57,560 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:57,560 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:57,560 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:57,560 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:57,560 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:57,560 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:57,560 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:57,561 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:57,561 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,561 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,561 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,561 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,580 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:57,580 - src.hyperparameter_tuning - ERROR - Trial 51 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:57,597 - src.hyperparameter_tuning - INFO - Trial 52: 모델 타입 = xgboost
2025-06-24 09:27:57,601 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:57,602 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:57,602 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:57,602 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:57,602 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:57,602 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:57,602 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:57,602 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:57,602 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:57,602 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:57,603 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:57,603 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:57,603 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:57,603 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:57,603 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:57,603 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:57,603 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:57,603 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:57,604 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:57,604 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:57,604 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:57,604 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:57,604 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:57,604 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:57,604 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:57,604 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:57,604 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:57,604 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:57,607 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:57,609 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:57,609 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:57,609 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:57,609 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:57,609 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:57,609 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:57,609 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:57,611 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:57,613 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:57,613 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:57,613 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:57,613 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:57,613 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:57,613 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:57,614 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:57,614 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:57,614 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,614 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,614 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:57,614 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:57,614 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,614 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,614 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:57,614 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:57,614 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,615 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:57,615 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:57,615 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:57,616 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:57,616 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:57,616 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:57,616 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:57,616 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:57,616 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:57,616 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:57,616 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:57,616 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:57,616 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,616 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:57,616 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:57,616 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,616 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,616 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,616 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,617 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,617 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,617 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,617 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,617 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:57,617 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:57,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,618 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,618 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:57,618 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:57,618 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,618 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,618 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,618 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,618 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,618 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,618 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,619 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,619 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:57,619 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,619 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:57,619 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,619 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:57,619 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,619 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:57,620 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:57,620 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:57,620 - src.models.xgboost_model - INFO -   n_estimators: 731
2025-06-24 09:27:57,620 - src.models.xgboost_model - INFO -   max_depth: 8
2025-06-24 09:27:57,620 - src.models.xgboost_model - INFO -   learning_rate: 0.045264804556252265
2025-06-24 09:27:57,620 - src.models.xgboost_model - INFO -   subsample: 0.8441633309961236
2025-06-24 09:27:57,620 - src.models.xgboost_model - INFO -   colsample_bytree: 0.9952454433996614
2025-06-24 09:27:57,620 - src.models.xgboost_model - INFO -   min_child_weight: 6
2025-06-24 09:27:57,620 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:57,620 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:57,620 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:57,620 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:57,620 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:57,620 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:57,620 - src.models.xgboost_model - INFO -   reg_alpha: 4.125247890869154
2025-06-24 09:27:57,620 - src.models.xgboost_model - INFO -   reg_lambda: 0.2451609055333755
2025-06-24 09:27:57,620 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:57,620 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:57,620 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:57,641 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:57,641 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:57,641 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:57,641 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:57,641 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,641 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,641 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,641 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,642 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,642 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,642 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,642 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,642 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:57,642 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,642 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:57,643 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:57,643 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:57,643 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:57,643 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:57,643 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,643 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:57,643 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:57,643 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:57,644 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:57,644 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:57,644 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:57,644 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:57,644 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,644 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,644 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,645 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,645 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:57,645 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:57,645 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:57,645 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:57,645 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:57,645 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:57,645 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:57,645 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:57,645 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:57,645 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:57,645 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:57,645 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:57,645 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:57,645 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:57,645 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:57,645 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,645 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,645 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,645 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,665 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:57,665 - src.hyperparameter_tuning - ERROR - Trial 52 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:57,682 - src.hyperparameter_tuning - INFO - Trial 53: 모델 타입 = xgboost
2025-06-24 09:27:57,686 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:57,687 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:57,687 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:57,687 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:57,687 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:57,687 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:57,687 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:57,687 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:57,687 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:57,688 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:57,688 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:57,688 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:57,688 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:57,688 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:57,688 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:57,688 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:57,688 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:57,688 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:57,689 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:57,689 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:57,689 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:57,689 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:57,689 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:57,689 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:57,689 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:57,689 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:57,689 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:57,689 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:57,692 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:57,694 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:57,694 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:57,694 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:57,694 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:57,694 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:57,694 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:57,694 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:57,696 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:57,698 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:57,698 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:57,698 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:57,698 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:57,699 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:57,699 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:57,699 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:57,699 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:57,699 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,699 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,699 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:57,699 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:57,699 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,699 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,699 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:57,699 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:57,699 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,700 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:57,700 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:57,700 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:57,701 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:57,701 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:57,701 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:57,701 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:57,701 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:57,701 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:57,701 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:57,701 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:57,701 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:57,701 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,701 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:57,701 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:57,701 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,701 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,701 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,701 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,702 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,702 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,702 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,702 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,702 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:57,702 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,703 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:57,703 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,703 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,703 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:57,703 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:57,703 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,703 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,703 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,703 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,703 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,703 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,704 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,704 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,704 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:57,704 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,704 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:57,704 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,704 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:57,704 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,704 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:57,705 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:57,705 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:57,705 - src.models.xgboost_model - INFO -   n_estimators: 878
2025-06-24 09:27:57,705 - src.models.xgboost_model - INFO -   max_depth: 12
2025-06-24 09:27:57,705 - src.models.xgboost_model - INFO -   learning_rate: 0.05717610201554704
2025-06-24 09:27:57,705 - src.models.xgboost_model - INFO -   subsample: 0.8658342387347022
2025-06-24 09:27:57,705 - src.models.xgboost_model - INFO -   colsample_bytree: 0.703959850414281
2025-06-24 09:27:57,705 - src.models.xgboost_model - INFO -   min_child_weight: 10
2025-06-24 09:27:57,705 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:57,705 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:57,705 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:57,705 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:57,705 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:57,705 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:57,705 - src.models.xgboost_model - INFO -   reg_alpha: 0.20464324584873575
2025-06-24 09:27:57,705 - src.models.xgboost_model - INFO -   reg_lambda: 1.84901540098007
2025-06-24 09:27:57,705 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:57,705 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:57,705 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:57,724 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:57,724 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:57,724 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:57,724 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:57,724 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,724 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,725 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,725 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,725 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,725 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,725 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,725 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,725 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:57,725 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,726 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:57,726 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:57,726 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:57,726 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:57,726 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:57,726 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,726 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:57,726 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:57,726 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:57,727 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:57,727 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:57,727 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:57,727 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:57,727 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,727 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,727 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,728 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,728 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:57,728 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:57,728 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:57,728 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:57,728 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:57,728 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:57,728 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:57,728 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:57,728 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:57,728 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:57,728 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:57,728 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:57,728 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:57,728 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:57,728 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:57,728 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,728 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,728 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,728 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,749 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:57,749 - src.hyperparameter_tuning - ERROR - Trial 53 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:57,766 - src.hyperparameter_tuning - INFO - Trial 54: 모델 타입 = xgboost
2025-06-24 09:27:57,769 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:57,770 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:57,770 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:57,770 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:57,770 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:57,770 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:57,770 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:57,770 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:57,770 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:57,771 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:57,771 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:57,771 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:57,771 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:57,771 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:57,771 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:57,771 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:57,771 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:57,771 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:57,772 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:57,772 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:57,772 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:57,772 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:57,772 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:57,772 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:57,772 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:57,772 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:57,772 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:57,772 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:57,775 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:57,777 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:57,778 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:57,778 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:57,778 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:57,778 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:57,778 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:57,778 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:57,780 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:57,782 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:57,782 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:57,782 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:57,782 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:57,782 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:57,782 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:57,782 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:57,782 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:57,782 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,782 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,782 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:57,782 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:57,782 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,782 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,783 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:57,783 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:57,783 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,783 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:57,783 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:57,783 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:57,784 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:57,784 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:57,784 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:57,784 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:57,784 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:57,784 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:57,784 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:57,784 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:57,784 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:57,784 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,784 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:57,784 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:57,784 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,784 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,785 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,785 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,785 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,785 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,785 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,785 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,785 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:57,785 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,786 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:57,786 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,786 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,786 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:57,786 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:57,786 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,786 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,786 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,786 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,786 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,787 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,787 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,787 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,787 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:57,787 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,787 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:57,787 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,787 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:57,787 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,787 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:57,788 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:57,788 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:57,788 - src.models.xgboost_model - INFO -   n_estimators: 630
2025-06-24 09:27:57,788 - src.models.xgboost_model - INFO -   max_depth: 4
2025-06-24 09:27:57,788 - src.models.xgboost_model - INFO -   learning_rate: 0.10355452708216979
2025-06-24 09:27:57,788 - src.models.xgboost_model - INFO -   subsample: 0.9997004443796105
2025-06-24 09:27:57,788 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6338705715259689
2025-06-24 09:27:57,788 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 09:27:57,788 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:57,788 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:57,788 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:57,788 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:57,788 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:57,788 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:57,788 - src.models.xgboost_model - INFO -   reg_alpha: 0.00023122038720601063
2025-06-24 09:27:57,788 - src.models.xgboost_model - INFO -   reg_lambda: 0.7623950102138848
2025-06-24 09:27:57,788 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:57,788 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:57,788 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:57,812 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:57,812 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:57,812 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:57,812 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:57,812 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,812 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,812 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,813 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,813 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,813 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,813 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,813 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,813 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:57,813 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,813 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:57,814 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:57,814 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:57,814 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:57,814 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:57,814 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,814 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:57,814 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:57,814 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:57,814 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:57,815 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:57,815 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:57,815 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:57,815 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,815 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,815 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,815 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,816 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:57,816 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:57,816 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:57,816 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:27:57,816 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:57,816 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:57,816 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:57,816 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:57,816 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:57,816 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:57,816 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:57,816 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:57,816 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:57,816 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:57,816 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:57,816 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,816 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,816 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,816 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,837 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:57,837 - src.hyperparameter_tuning - ERROR - Trial 54 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:57,854 - src.hyperparameter_tuning - INFO - Trial 55: 모델 타입 = xgboost
2025-06-24 09:27:57,858 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:57,858 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:57,858 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:57,858 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:57,858 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:57,858 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:57,858 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:57,858 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:57,858 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:57,859 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:57,859 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:57,859 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:57,859 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:57,859 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:57,859 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:57,859 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:57,859 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:57,859 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:57,860 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:57,860 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:57,860 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:57,860 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:57,860 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:57,860 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:57,860 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:57,860 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:57,860 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:57,860 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:57,864 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:57,866 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:57,866 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:57,866 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:57,866 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:57,866 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:57,866 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:57,866 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:57,868 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:57,870 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:57,870 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:57,870 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:57,870 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:57,870 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:57,870 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:57,870 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:57,870 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:57,870 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,870 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,871 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:57,871 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:57,871 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,871 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,871 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:57,871 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:57,871 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,871 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:57,871 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:57,871 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:57,872 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:57,872 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:57,872 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:57,872 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:57,872 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:57,872 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:57,872 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:57,872 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:57,872 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:57,872 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,872 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:57,872 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:57,873 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,873 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,873 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,873 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,873 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,873 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,874 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:57,874 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,874 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:57,874 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,874 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,874 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:57,874 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:57,874 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,874 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,875 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,875 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,875 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,875 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,875 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,875 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,875 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:57,875 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,876 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:57,876 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,876 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:57,876 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,876 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:57,876 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:57,876 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:57,876 - src.models.xgboost_model - INFO -   n_estimators: 765
2025-06-24 09:27:57,876 - src.models.xgboost_model - INFO -   max_depth: 15
2025-06-24 09:27:57,876 - src.models.xgboost_model - INFO -   learning_rate: 0.0872695500305814
2025-06-24 09:27:57,876 - src.models.xgboost_model - INFO -   subsample: 0.8117310893244194
2025-06-24 09:27:57,876 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6153983721169413
2025-06-24 09:27:57,876 - src.models.xgboost_model - INFO -   min_child_weight: 7
2025-06-24 09:27:57,876 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:57,876 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:57,876 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:57,876 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:57,876 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:57,876 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:57,876 - src.models.xgboost_model - INFO -   reg_alpha: 2.0146033362193987
2025-06-24 09:27:57,876 - src.models.xgboost_model - INFO -   reg_lambda: 2.5893596931027907e-05
2025-06-24 09:27:57,876 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:57,876 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:57,876 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:57,889 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:57,889 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:57,889 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:57,889 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:57,889 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,890 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,890 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,890 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,890 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,890 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,890 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,890 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,891 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:57,891 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,891 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:57,891 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:57,891 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:57,891 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:57,892 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:57,892 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,892 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:57,892 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:57,892 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:57,892 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:57,892 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:57,892 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:57,892 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:57,892 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,892 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,893 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,893 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,893 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:57,893 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:57,893 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:57,893 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:57,893 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:57,893 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:57,893 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:57,893 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:57,893 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:57,893 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:57,893 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:57,893 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:57,893 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:57,894 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:57,894 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:57,894 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,894 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,894 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,894 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,915 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:57,915 - src.hyperparameter_tuning - ERROR - Trial 55 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:57,932 - src.hyperparameter_tuning - INFO - Trial 56: 모델 타입 = xgboost
2025-06-24 09:27:57,936 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:57,937 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:57,937 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:57,937 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:57,937 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:57,937 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:57,937 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:57,937 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:57,937 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:57,938 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:57,938 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:57,938 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:57,938 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:57,938 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:57,938 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:57,938 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:57,938 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:57,938 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:57,939 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:57,939 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:57,939 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:57,939 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:57,939 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:57,939 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:57,939 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:57,939 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:57,939 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:57,939 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:57,943 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:57,945 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:57,945 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:57,945 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:57,945 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:57,945 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:57,945 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:57,945 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:57,947 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:57,949 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:57,949 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:57,949 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:57,949 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:57,949 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:57,949 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:57,949 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:57,949 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:57,949 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,949 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,950 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:57,950 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:57,950 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,950 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,950 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:57,950 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:57,950 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,951 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:57,951 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:57,951 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:57,951 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:57,951 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:57,951 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:57,951 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:57,951 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:57,951 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:57,951 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:57,952 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:57,952 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:57,952 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,952 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:57,952 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:57,952 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,952 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,952 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,952 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,952 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,952 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,953 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,953 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,953 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:57,953 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,953 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:57,953 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,953 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,953 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:57,953 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:57,953 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,953 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,954 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,954 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:57,954 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,955 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:57,955 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,955 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:57,955 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,955 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:57,955 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:57,955 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:57,955 - src.models.xgboost_model - INFO -   n_estimators: 474
2025-06-24 09:27:57,955 - src.models.xgboost_model - INFO -   max_depth: 7
2025-06-24 09:27:57,955 - src.models.xgboost_model - INFO -   learning_rate: 0.15955110994063237
2025-06-24 09:27:57,955 - src.models.xgboost_model - INFO -   subsample: 0.9199729455787573
2025-06-24 09:27:57,955 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6885712835817486
2025-06-24 09:27:57,955 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 09:27:57,955 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:57,955 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:57,955 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:57,955 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:57,955 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:57,955 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:57,955 - src.models.xgboost_model - INFO -   reg_alpha: 2.1688355302711294e-08
2025-06-24 09:27:57,955 - src.models.xgboost_model - INFO -   reg_lambda: 0.00013027514822087265
2025-06-24 09:27:57,955 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:57,955 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:57,956 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:57,971 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:57,971 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:57,971 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:57,971 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:57,971 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,972 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:57,972 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:57,972 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:57,972 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:57,972 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:57,972 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:57,973 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:57,973 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:57,973 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,973 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:57,974 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:57,974 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:57,974 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:57,974 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:57,974 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,974 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:57,974 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:57,974 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:57,974 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:57,974 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:57,974 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:57,974 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:57,974 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,974 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,975 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,975 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:57,975 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:57,975 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:57,975 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:57,975 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:27:57,975 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:57,975 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:57,975 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:57,975 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:57,975 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:57,975 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:57,975 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:57,975 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:57,975 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:57,976 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:57,976 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:57,976 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,976 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,976 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:57,976 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:57,996 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:57,996 - src.hyperparameter_tuning - ERROR - Trial 56 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:58,013 - src.hyperparameter_tuning - INFO - Trial 57: 모델 타입 = xgboost
2025-06-24 09:27:58,017 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:58,018 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:58,018 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:58,018 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:58,018 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:58,018 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:58,018 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:58,018 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:58,018 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:58,019 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:58,019 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:58,019 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:58,019 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:58,019 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:58,019 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:58,019 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:58,019 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:58,019 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:58,020 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:58,020 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:58,020 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:58,020 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:58,020 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:58,020 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:58,020 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:58,020 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:58,020 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:58,020 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:58,024 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:58,026 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:58,026 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:58,026 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:58,026 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:58,026 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:58,026 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:58,026 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:58,028 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:58,030 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:58,030 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:58,030 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:58,030 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:58,030 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:58,030 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:58,030 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:58,030 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:58,030 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,030 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,031 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:58,031 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:58,031 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,031 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,031 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:58,031 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:58,031 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,031 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:58,031 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:58,031 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:58,032 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:58,032 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:58,032 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:58,032 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:58,032 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:58,032 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:58,032 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:58,032 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:58,032 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:58,032 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,032 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:58,033 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:58,033 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,033 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,033 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,033 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,033 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,033 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,034 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,034 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,034 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:58,034 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,034 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:58,034 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,034 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,034 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:58,034 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:58,034 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,034 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,035 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,035 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,035 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,035 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,035 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,035 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,035 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:58,035 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,036 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:58,036 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,036 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:58,036 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,036 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:58,036 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:58,036 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:58,036 - src.models.xgboost_model - INFO -   n_estimators: 803
2025-06-24 09:27:58,036 - src.models.xgboost_model - INFO -   max_depth: 5
2025-06-24 09:27:58,036 - src.models.xgboost_model - INFO -   learning_rate: 0.12328464824387185
2025-06-24 09:27:58,036 - src.models.xgboost_model - INFO -   subsample: 0.7393575197608402
2025-06-24 09:27:58,036 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7168277374943876
2025-06-24 09:27:58,036 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 09:27:58,036 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:58,036 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:58,036 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:58,036 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:58,036 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:58,036 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:58,036 - src.models.xgboost_model - INFO -   reg_alpha: 0.04913346947062682
2025-06-24 09:27:58,037 - src.models.xgboost_model - INFO -   reg_lambda: 8.091670889329816e-06
2025-06-24 09:27:58,037 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:58,037 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:58,037 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:58,047 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:58,048 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:58,048 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:58,048 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:58,048 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,048 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,048 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,048 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,048 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,048 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,049 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,049 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,049 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:58,049 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,049 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:58,050 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:58,050 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:58,050 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:58,050 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:58,050 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,050 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:58,050 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:58,050 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:58,050 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:58,050 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:58,050 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:58,050 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:58,051 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,051 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,051 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,051 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,052 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:58,052 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:58,052 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:58,052 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:27:58,052 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:58,052 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:58,052 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:58,052 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:58,052 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:58,052 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:58,052 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:58,052 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:58,052 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:58,052 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:58,052 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:58,052 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,052 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,052 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,052 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,073 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:58,073 - src.hyperparameter_tuning - ERROR - Trial 57 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:58,090 - src.hyperparameter_tuning - INFO - Trial 58: 모델 타입 = xgboost
2025-06-24 09:27:58,094 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:58,095 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:58,095 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:58,095 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:58,095 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:58,095 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:58,095 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:58,095 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:58,095 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:58,096 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:58,096 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:58,096 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:58,096 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:58,096 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:58,096 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:58,096 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:58,096 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:58,096 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:58,097 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:58,097 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:58,097 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:58,097 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:58,097 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:58,097 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:58,097 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:58,097 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:58,097 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:58,097 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:58,100 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:58,102 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:58,102 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:58,102 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:58,102 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:58,102 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:58,102 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:58,102 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:58,105 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:58,107 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:58,107 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:58,107 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:58,107 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:58,107 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:58,107 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:58,107 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:58,107 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:58,107 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,107 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,107 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:58,107 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:58,107 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,107 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,107 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:58,107 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:58,107 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,108 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:58,108 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:58,108 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:58,109 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:58,109 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:58,109 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:58,109 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:58,109 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:58,109 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:58,109 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:58,109 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:58,109 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:58,109 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,109 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:58,109 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:58,109 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,109 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,109 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,110 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:58,110 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:58,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,111 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,111 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:58,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:58,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,111 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,111 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,111 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,112 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,112 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,112 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,112 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:58,112 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,112 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:58,112 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,112 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:58,112 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,112 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:58,113 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:58,113 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:58,113 - src.models.xgboost_model - INFO -   n_estimators: 713
2025-06-24 09:27:58,113 - src.models.xgboost_model - INFO -   max_depth: 9
2025-06-24 09:27:58,113 - src.models.xgboost_model - INFO -   learning_rate: 0.02877890524381143
2025-06-24 09:27:58,113 - src.models.xgboost_model - INFO -   subsample: 0.7744968157211797
2025-06-24 09:27:58,113 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6613521579450681
2025-06-24 09:27:58,113 - src.models.xgboost_model - INFO -   min_child_weight: 8
2025-06-24 09:27:58,113 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:58,113 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:58,113 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:58,113 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:58,113 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:58,113 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:58,113 - src.models.xgboost_model - INFO -   reg_alpha: 1.264172185275746e-07
2025-06-24 09:27:58,113 - src.models.xgboost_model - INFO -   reg_lambda: 1.8438880988303907e-07
2025-06-24 09:27:58,113 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:58,113 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:58,113 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:58,143 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:58,143 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:58,143 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:58,143 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:58,143 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,143 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,144 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,144 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,144 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,144 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,144 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,144 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,144 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:58,144 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,145 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:58,145 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:58,145 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:58,145 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:58,145 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:58,145 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,145 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:58,145 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:58,146 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:58,146 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:58,146 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:58,146 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:58,146 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:58,146 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,146 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,147 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,147 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,147 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:58,147 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:58,147 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:58,147 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:58,147 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:58,147 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:58,147 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:58,147 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:58,147 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:58,147 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:58,147 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:58,147 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:58,147 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:58,148 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:58,148 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:58,148 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,148 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,148 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,148 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,169 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:58,169 - src.hyperparameter_tuning - ERROR - Trial 58 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:58,187 - src.hyperparameter_tuning - INFO - Trial 59: 모델 타입 = xgboost
2025-06-24 09:27:58,191 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:58,192 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:58,192 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:58,192 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:58,192 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:58,192 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:58,192 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:58,192 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:58,192 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:58,193 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:58,193 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:58,193 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:58,193 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:58,193 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:58,193 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:58,193 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:58,193 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:58,193 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:58,194 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:58,194 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:58,194 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:58,194 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:58,194 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:58,194 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:58,194 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:58,194 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:58,194 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:58,194 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:58,197 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:58,200 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:58,200 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:58,200 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:58,200 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:58,200 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:58,200 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:58,200 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:58,202 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:58,204 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:58,204 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:58,204 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:58,204 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:58,204 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:58,204 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:58,204 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:58,204 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:58,204 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,204 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,205 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:58,205 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:58,205 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,205 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,205 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:58,205 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:58,205 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,205 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:58,205 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:58,205 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:58,206 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:58,206 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:58,206 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:58,206 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:58,206 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:58,206 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:58,206 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:58,206 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:58,206 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:58,206 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,206 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:58,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:58,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,207 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,207 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,207 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,207 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,207 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,207 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,208 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,208 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:58,208 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,208 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:58,208 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,208 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,208 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:58,208 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:58,208 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,208 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,208 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,209 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,209 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,209 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,209 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,209 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,209 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:58,209 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:58,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,209 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:58,209 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,209 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:58,210 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:58,210 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:58,210 - src.models.xgboost_model - INFO -   n_estimators: 348
2025-06-24 09:27:58,210 - src.models.xgboost_model - INFO -   max_depth: 3
2025-06-24 09:27:58,210 - src.models.xgboost_model - INFO -   learning_rate: 0.0775060616033584
2025-06-24 09:27:58,210 - src.models.xgboost_model - INFO -   subsample: 0.822774978046291
2025-06-24 09:27:58,210 - src.models.xgboost_model - INFO -   colsample_bytree: 0.8032996697823546
2025-06-24 09:27:58,210 - src.models.xgboost_model - INFO -   min_child_weight: 9
2025-06-24 09:27:58,210 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:58,210 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:58,210 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:58,210 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:58,210 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:58,210 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:58,210 - src.models.xgboost_model - INFO -   reg_alpha: 1.0336394052983589e-08
2025-06-24 09:27:58,210 - src.models.xgboost_model - INFO -   reg_lambda: 0.02426337372106349
2025-06-24 09:27:58,210 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:58,210 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:58,210 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:58,223 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:58,223 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:58,223 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:58,223 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:58,223 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,224 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,224 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,224 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,224 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,224 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,224 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,224 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,225 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:58,225 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,225 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:58,225 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:58,225 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:58,225 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:58,225 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:58,226 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,226 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:58,226 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:58,226 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:58,226 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:58,226 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:58,226 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:58,226 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:58,226 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,227 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,227 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,227 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,227 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:58,227 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:58,227 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:58,227 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:58,227 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:58,227 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:58,227 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:58,227 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:58,227 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:58,227 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:58,227 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:58,227 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:58,227 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:58,228 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:58,228 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:58,228 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,228 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,228 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,228 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,249 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:58,249 - src.hyperparameter_tuning - ERROR - Trial 59 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:58,267 - src.hyperparameter_tuning - INFO - Trial 60: 모델 타입 = xgboost
2025-06-24 09:27:58,271 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:58,272 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:58,272 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:58,272 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:58,272 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:58,272 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:58,272 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:58,272 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:58,272 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:58,273 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:58,273 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:58,273 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:58,273 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:58,273 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:58,273 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:58,273 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:58,273 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:58,273 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:58,274 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:58,274 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:58,274 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:58,274 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:58,274 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:58,274 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:58,274 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:58,274 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:58,274 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:58,274 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:58,278 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:58,280 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:58,280 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:58,280 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:58,280 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:58,280 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:58,280 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:58,280 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:58,282 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:58,284 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:58,284 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:58,284 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:58,284 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:58,284 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:58,284 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:58,284 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:58,284 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:58,284 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,284 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,285 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:58,285 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:58,285 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,285 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,285 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:58,285 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:58,285 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,285 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:58,285 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:58,285 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:58,286 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:58,286 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:58,286 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:58,286 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:58,286 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:58,286 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:58,286 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:58,286 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:58,286 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:58,286 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,286 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:58,286 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:58,286 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,287 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,287 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,287 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,287 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,287 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,287 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,288 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,288 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:58,288 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,288 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:58,288 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,288 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,288 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:58,288 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:58,288 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,288 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,288 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,289 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,289 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,289 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,289 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,289 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,289 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:58,289 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,289 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:58,289 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,289 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:58,289 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,289 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:58,290 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:58,290 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:58,290 - src.models.xgboost_model - INFO -   n_estimators: 413
2025-06-24 09:27:58,290 - src.models.xgboost_model - INFO -   max_depth: 11
2025-06-24 09:27:58,290 - src.models.xgboost_model - INFO -   learning_rate: 0.053859474429395815
2025-06-24 09:27:58,290 - src.models.xgboost_model - INFO -   subsample: 0.7140694592116312
2025-06-24 09:27:58,290 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6437821525449181
2025-06-24 09:27:58,290 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 09:27:58,290 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:58,290 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:58,290 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:58,290 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:58,290 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:58,290 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:58,290 - src.models.xgboost_model - INFO -   reg_alpha: 0.010830516798855553
2025-06-24 09:27:58,290 - src.models.xgboost_model - INFO -   reg_lambda: 0.26017228321039604
2025-06-24 09:27:58,290 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:58,290 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:58,290 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:58,311 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:58,311 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:58,311 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:58,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:58,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,311 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,312 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,312 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,312 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,312 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,312 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,312 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:58,313 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,313 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:58,313 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:58,313 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:58,313 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:58,313 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:58,313 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,314 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:58,314 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:58,314 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:58,314 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:58,314 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:58,314 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:58,314 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:58,314 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,314 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,314 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,315 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,315 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:58,315 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:58,315 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:58,315 - src.training - INFO -   accuracy: 0.984
2025-06-24 09:27:58,315 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:58,315 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:58,315 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:58,315 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:58,315 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:58,315 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:58,315 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:58,315 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:58,315 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:58,315 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:58,315 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.984, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:58,315 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,315 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,315 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,315 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,336 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:58,336 - src.hyperparameter_tuning - ERROR - Trial 60 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:58,354 - src.hyperparameter_tuning - INFO - Trial 61: 모델 타입 = xgboost
2025-06-24 09:27:58,358 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:58,359 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:58,359 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:58,359 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:58,359 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:58,359 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:58,359 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:58,359 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:58,359 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:58,360 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:58,360 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:58,360 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:58,360 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:58,360 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:58,360 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:58,360 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:58,360 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:58,360 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:58,361 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:58,361 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:58,361 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:58,361 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:58,361 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:58,361 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:58,361 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:58,361 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:58,361 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:58,361 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:58,365 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:58,367 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:58,367 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:58,367 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:58,367 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:58,367 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:58,367 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:58,367 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:58,369 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:58,371 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:58,371 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:58,371 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:58,371 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:58,371 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:58,371 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:58,371 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:58,371 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:58,371 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,371 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,372 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:58,372 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:58,372 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,372 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,372 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:58,372 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:58,372 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,372 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:58,372 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:58,372 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:58,373 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:58,373 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:58,373 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:58,373 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:58,373 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:58,373 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:58,373 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:58,373 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:58,373 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:58,373 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,373 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:58,373 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:58,373 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,374 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,374 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,374 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,374 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,374 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,374 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,375 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,375 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:58,375 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,375 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:58,375 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,375 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,375 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:58,375 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:58,375 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,375 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,375 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,376 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,376 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,376 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,376 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,376 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,376 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:58,376 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,376 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:58,376 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,376 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:58,376 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,376 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:58,377 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:58,377 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:58,377 - src.models.xgboost_model - INFO -   n_estimators: 690
2025-06-24 09:27:58,377 - src.models.xgboost_model - INFO -   max_depth: 14
2025-06-24 09:27:58,377 - src.models.xgboost_model - INFO -   learning_rate: 0.014546989331885148
2025-06-24 09:27:58,377 - src.models.xgboost_model - INFO -   subsample: 0.6753294906853499
2025-06-24 09:27:58,377 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6085297963037174
2025-06-24 09:27:58,377 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 09:27:58,377 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:58,377 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:58,377 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:58,377 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:58,377 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:58,377 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:58,377 - src.models.xgboost_model - INFO -   reg_alpha: 0.0005269403362868235
2025-06-24 09:27:58,377 - src.models.xgboost_model - INFO -   reg_lambda: 1.5293803009834095e-06
2025-06-24 09:27:58,377 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:58,377 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:58,377 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:58,444 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:58,444 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:58,444 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:58,444 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:58,444 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,444 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,445 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,445 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,445 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,445 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,445 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,445 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,445 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:58,445 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,446 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:58,447 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:58,447 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:58,447 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:58,447 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:58,447 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,447 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:58,447 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:58,447 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:58,448 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:58,448 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:58,448 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:58,448 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:58,448 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,448 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,448 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,449 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,449 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:58,449 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:58,449 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:58,449 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:27:58,449 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:58,449 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:58,449 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:58,449 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:58,449 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:58,449 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:58,449 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:58,449 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:58,449 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:58,449 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:58,449 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:58,449 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,449 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,449 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,449 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,470 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:58,470 - src.hyperparameter_tuning - ERROR - Trial 61 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:58,488 - src.hyperparameter_tuning - INFO - Trial 62: 모델 타입 = xgboost
2025-06-24 09:27:58,491 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:58,492 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:58,492 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:58,492 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:58,492 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:58,492 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:58,492 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:58,492 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:58,492 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:58,493 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:58,493 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:58,493 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:58,493 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:58,493 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:58,493 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:58,493 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:58,493 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:58,493 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:58,494 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:58,494 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:58,494 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:58,494 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:58,494 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:58,494 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:58,494 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:58,494 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:58,494 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:58,494 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:58,497 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:58,499 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:58,499 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:58,499 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:58,499 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:58,499 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:58,499 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:58,499 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:58,501 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:58,503 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:58,503 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:58,503 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:58,504 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:58,504 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:58,504 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:58,504 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:58,504 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:58,504 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,504 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,504 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:58,504 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:58,504 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,504 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,504 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:58,504 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:58,504 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,505 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:58,505 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:58,505 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:58,506 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:58,506 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:58,506 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:58,506 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:58,506 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:58,506 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:58,506 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:58,506 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:58,506 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:58,506 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,506 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:58,506 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:58,506 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,506 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,506 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,506 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,507 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:58,507 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,507 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:58,507 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,507 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,507 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:58,507 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:58,507 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,508 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,508 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,508 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,508 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,508 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,508 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,508 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,509 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:58,509 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,509 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:58,509 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,509 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:58,509 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,509 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:58,509 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:58,509 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:58,509 - src.models.xgboost_model - INFO -   n_estimators: 584
2025-06-24 09:27:58,509 - src.models.xgboost_model - INFO -   max_depth: 15
2025-06-24 09:27:58,509 - src.models.xgboost_model - INFO -   learning_rate: 0.011529166424374461
2025-06-24 09:27:58,509 - src.models.xgboost_model - INFO -   subsample: 0.6196043318951782
2025-06-24 09:27:58,509 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6305394260320045
2025-06-24 09:27:58,509 - src.models.xgboost_model - INFO -   min_child_weight: 5
2025-06-24 09:27:58,509 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:58,509 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:58,509 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:58,509 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:58,509 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:58,509 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:58,509 - src.models.xgboost_model - INFO -   reg_alpha: 2.107485048565797e-05
2025-06-24 09:27:58,510 - src.models.xgboost_model - INFO -   reg_lambda: 7.1681666026899905e-06
2025-06-24 09:27:58,510 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:58,510 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:58,510 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:58,588 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:58,588 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:58,588 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:58,588 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:58,588 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,589 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,589 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,589 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,589 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,589 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,589 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,590 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,590 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:58,590 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,590 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:58,591 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:58,591 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:58,591 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:58,591 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:58,591 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,591 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:58,591 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:58,591 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:58,591 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:58,591 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:58,591 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:58,591 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:58,591 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,592 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,592 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,592 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,592 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:58,592 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:58,592 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:58,592 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:27:58,592 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:58,592 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:58,592 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:58,592 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:58,592 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:58,592 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:58,592 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:58,592 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:58,592 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:58,593 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:58,593 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:58,593 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,593 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,593 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,593 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,614 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:58,614 - src.hyperparameter_tuning - ERROR - Trial 62 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:58,631 - src.hyperparameter_tuning - INFO - Trial 63: 모델 타입 = xgboost
2025-06-24 09:27:58,635 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:58,636 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:58,636 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:58,636 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:58,636 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:58,636 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:58,636 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:58,636 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:58,636 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:58,636 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:58,636 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:58,636 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:58,636 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:58,636 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:58,636 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:58,636 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:58,636 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:58,636 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:58,637 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:58,637 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:58,637 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:58,637 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:58,637 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:58,637 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:58,637 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:58,637 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:58,637 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:58,637 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:58,641 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:58,643 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:58,643 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:58,643 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:58,643 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:58,643 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:58,643 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:58,643 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:58,645 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:58,647 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:58,647 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:58,647 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:58,647 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:58,647 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:58,647 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:58,647 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:58,647 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:58,647 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,647 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,648 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:58,648 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:58,648 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,648 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,648 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:58,648 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:58,648 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,648 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:58,648 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:58,648 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:58,649 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:58,649 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:58,649 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:58,649 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:58,649 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:58,649 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:58,649 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:58,649 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:58,649 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:58,649 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,649 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:58,649 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:58,649 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,650 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,650 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,650 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,650 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,650 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,650 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,651 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,651 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:58,651 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,651 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:58,651 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,651 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,651 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:58,651 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:58,651 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,651 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,651 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,652 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,652 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,652 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,652 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,652 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,652 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:58,652 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,652 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:58,652 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,652 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:58,652 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,652 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:58,653 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:58,653 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:58,653 - src.models.xgboost_model - INFO -   n_estimators: 522
2025-06-24 09:27:58,653 - src.models.xgboost_model - INFO -   max_depth: 14
2025-06-24 09:27:58,653 - src.models.xgboost_model - INFO -   learning_rate: 0.013137316922394032
2025-06-24 09:27:58,653 - src.models.xgboost_model - INFO -   subsample: 0.66030551920044
2025-06-24 09:27:58,653 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6666629197984876
2025-06-24 09:27:58,653 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 09:27:58,653 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:58,653 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:58,653 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:58,653 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:58,653 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:58,653 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:58,653 - src.models.xgboost_model - INFO -   reg_alpha: 8.094504252859514e-05
2025-06-24 09:27:58,653 - src.models.xgboost_model - INFO -   reg_lambda: 6.903878038959463e-07
2025-06-24 09:27:58,653 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:58,653 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:58,653 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:58,726 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:58,726 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:58,726 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:58,727 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:58,727 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,727 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,727 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,727 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,727 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,727 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,727 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,728 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,728 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:58,728 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,728 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:58,729 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:58,729 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:58,729 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:58,729 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:58,729 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,729 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:58,729 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:58,729 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:58,729 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:58,729 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:58,729 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:58,729 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:58,729 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,730 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,730 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,730 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,730 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:58,730 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:58,730 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:58,730 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:27:58,730 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:58,730 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:58,730 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:58,730 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:58,730 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:58,730 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:58,730 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:58,730 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:58,730 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:58,731 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:58,731 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:58,731 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,731 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,731 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,731 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,752 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:58,752 - src.hyperparameter_tuning - ERROR - Trial 63 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:58,770 - src.hyperparameter_tuning - INFO - Trial 64: 모델 타입 = xgboost
2025-06-24 09:27:58,774 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:58,774 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:58,774 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:58,774 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:58,774 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:58,774 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:58,774 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:58,774 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:58,774 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:58,775 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:58,775 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:58,775 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:58,775 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:58,775 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:58,775 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:58,775 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:58,775 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:58,775 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:58,776 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:58,776 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:58,776 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:58,776 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:58,776 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:58,776 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:58,776 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:58,776 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:58,776 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:58,776 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:58,779 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:58,781 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:58,782 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:58,782 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:58,782 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:58,782 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:58,782 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:58,782 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:58,784 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:58,786 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:58,786 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:58,786 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:58,786 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:58,786 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:58,786 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:58,786 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:58,786 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:58,786 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,786 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,786 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:58,786 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:58,786 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,786 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,786 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:58,786 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:58,786 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,787 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:58,787 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:58,787 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:58,788 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:58,788 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:58,788 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:58,788 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:58,788 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:58,788 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:58,788 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:58,788 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:58,788 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:58,788 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,788 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:58,788 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:58,788 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,788 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,788 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,789 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,789 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,789 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,789 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,789 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,789 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:58,789 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,790 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:58,790 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,790 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,790 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:58,790 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:58,790 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,790 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,790 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,790 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,790 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,790 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,790 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,791 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,791 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:58,791 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,791 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:58,791 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,791 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:58,791 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,791 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:58,791 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:58,791 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:58,792 - src.models.xgboost_model - INFO -   n_estimators: 603
2025-06-24 09:27:58,792 - src.models.xgboost_model - INFO -   max_depth: 13
2025-06-24 09:27:58,792 - src.models.xgboost_model - INFO -   learning_rate: 0.01907906250177294
2025-06-24 09:27:58,792 - src.models.xgboost_model - INFO -   subsample: 0.6942534441572816
2025-06-24 09:27:58,792 - src.models.xgboost_model - INFO -   colsample_bytree: 0.938464434101627
2025-06-24 09:27:58,792 - src.models.xgboost_model - INFO -   min_child_weight: 6
2025-06-24 09:27:58,792 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:58,792 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:58,792 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:58,792 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:58,792 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:58,792 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:58,792 - src.models.xgboost_model - INFO -   reg_alpha: 0.00022682936396780558
2025-06-24 09:27:58,792 - src.models.xgboost_model - INFO -   reg_lambda: 4.45561669868669
2025-06-24 09:27:58,792 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:58,792 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:58,792 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:58,831 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:58,831 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:58,831 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:58,831 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:58,831 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,832 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,832 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,832 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,832 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,832 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,832 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,833 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,833 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:58,833 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,833 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:58,834 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:58,834 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:58,834 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:58,834 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:58,834 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,834 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:58,834 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:58,834 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:58,834 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:58,834 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:58,834 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:58,834 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:58,834 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,835 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,835 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,835 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,835 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:58,835 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:58,835 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:58,835 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:58,835 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:58,835 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:58,835 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:58,835 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:58,835 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:58,835 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:58,835 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:58,835 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:58,835 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:58,836 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:58,836 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:58,836 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,836 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,836 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,836 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,857 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:58,857 - src.hyperparameter_tuning - ERROR - Trial 64 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:58,874 - src.hyperparameter_tuning - INFO - Trial 65: 모델 타입 = xgboost
2025-06-24 09:27:58,878 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:58,879 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:58,879 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:58,879 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:58,879 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:58,879 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:58,879 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:58,879 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:58,879 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:58,880 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:58,880 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:58,880 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:58,880 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:58,880 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:58,880 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:58,880 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:58,880 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:58,880 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:58,881 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:58,881 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:58,881 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:58,881 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:58,881 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:58,881 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:58,881 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:58,881 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:58,881 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:58,881 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:58,884 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:58,886 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:58,886 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:58,886 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:58,886 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:58,886 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:58,886 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:58,886 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:58,888 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:58,890 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:58,890 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:58,890 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:58,890 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:58,891 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:58,891 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:58,891 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:58,891 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:58,891 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,891 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,891 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:58,891 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:58,891 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,891 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,891 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:58,891 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:58,891 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,892 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:58,892 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:58,892 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:58,893 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:58,893 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:58,893 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:58,893 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:58,893 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:58,893 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:58,893 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:58,893 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:58,893 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:58,893 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,893 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:58,893 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:58,893 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,893 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,893 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,893 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,894 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:58,894 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,894 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:58,894 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,894 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,894 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:58,894 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:58,894 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,895 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,895 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,895 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,895 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,895 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,895 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,895 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,896 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:58,896 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,896 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:58,896 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,896 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:58,896 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,896 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:58,896 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:58,896 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:58,896 - src.models.xgboost_model - INFO -   n_estimators: 639
2025-06-24 09:27:58,896 - src.models.xgboost_model - INFO -   max_depth: 15
2025-06-24 09:27:58,896 - src.models.xgboost_model - INFO -   learning_rate: 0.015539591247548544
2025-06-24 09:27:58,896 - src.models.xgboost_model - INFO -   subsample: 0.8476657650935041
2025-06-24 09:27:58,896 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6885737118864246
2025-06-24 09:27:58,896 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 09:27:58,896 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:58,896 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:58,896 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:58,896 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:58,896 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:58,896 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:58,896 - src.models.xgboost_model - INFO -   reg_alpha: 2.135344482122875e-06
2025-06-24 09:27:58,896 - src.models.xgboost_model - INFO -   reg_lambda: 9.507584963345197
2025-06-24 09:27:58,896 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:58,896 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:58,897 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:58,961 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:58,961 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:58,961 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:58,961 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:58,961 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,961 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:58,962 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:58,962 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:58,962 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:58,962 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:58,962 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:58,962 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:58,962 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:58,962 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,963 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:58,965 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:58,965 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:58,965 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:58,965 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:58,965 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,965 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:58,965 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:58,965 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:58,965 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:58,965 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:58,965 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:58,965 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:58,965 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,966 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,966 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,966 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:58,966 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:58,966 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:58,966 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:58,966 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:58,966 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:58,966 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:58,966 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:58,966 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:58,966 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:58,966 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:58,966 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:58,966 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:58,966 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:58,967 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:58,967 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:58,967 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,967 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,967 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:58,967 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:58,988 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:58,988 - src.hyperparameter_tuning - ERROR - Trial 65 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:59,006 - src.hyperparameter_tuning - INFO - Trial 66: 모델 타입 = xgboost
2025-06-24 09:27:59,009 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:59,010 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:59,010 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:59,010 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:59,010 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:59,010 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:59,010 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:59,010 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:59,010 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:59,011 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:59,011 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:59,011 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:59,011 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:59,011 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:59,011 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:59,011 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:59,011 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:59,011 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:59,012 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:59,012 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:59,012 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:59,012 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:59,012 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:59,012 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:59,012 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:59,012 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:59,012 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:59,012 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:59,015 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:59,017 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:59,017 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:59,018 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:59,018 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:59,018 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:59,018 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:59,018 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:59,020 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:59,022 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:59,022 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:59,022 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:59,022 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:59,022 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:59,022 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:59,022 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:59,022 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:59,022 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,022 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,022 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:59,022 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:59,022 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,022 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,022 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:59,022 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:59,022 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,023 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:59,023 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:59,023 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:59,024 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:59,024 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:59,024 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:59,024 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:59,024 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:59,024 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:59,024 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:59,024 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:59,024 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:59,024 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,024 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:59,024 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:59,024 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,024 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,025 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,025 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,025 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,025 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,025 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,025 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,025 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:59,025 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,026 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:59,026 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,026 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,026 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:59,026 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:59,026 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,026 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,026 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,026 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,026 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,027 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,027 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,027 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,027 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:59,027 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,027 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:59,027 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,027 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:59,027 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,027 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:59,028 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:59,028 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:59,028 - src.models.xgboost_model - INFO -   n_estimators: 759
2025-06-24 09:27:59,028 - src.models.xgboost_model - INFO -   max_depth: 7
2025-06-24 09:27:59,028 - src.models.xgboost_model - INFO -   learning_rate: 0.03979327596125047
2025-06-24 09:27:59,028 - src.models.xgboost_model - INFO -   subsample: 0.8903803852114492
2025-06-24 09:27:59,028 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6519922289069321
2025-06-24 09:27:59,028 - src.models.xgboost_model - INFO -   min_child_weight: 5
2025-06-24 09:27:59,028 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:59,028 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:59,028 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:59,028 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:59,028 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:59,028 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:59,028 - src.models.xgboost_model - INFO -   reg_alpha: 6.360497158046327e-06
2025-06-24 09:27:59,028 - src.models.xgboost_model - INFO -   reg_lambda: 6.120976221733305e-08
2025-06-24 09:27:59,028 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:59,028 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:59,028 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:59,058 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:59,059 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:59,059 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:59,059 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:59,059 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,059 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,059 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,059 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,059 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,059 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,060 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,060 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,060 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:59,060 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,060 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:59,061 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:59,061 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:59,061 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:59,061 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:59,061 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,061 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:59,061 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:59,061 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:59,061 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:59,061 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:59,061 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:59,061 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:59,061 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,062 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,062 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,062 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,062 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:59,062 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:59,062 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:59,062 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:59,062 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:59,062 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:59,062 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:59,062 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:59,062 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:59,062 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:59,062 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:59,062 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:59,062 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:59,063 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:59,063 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:59,063 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,063 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,063 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,063 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,084 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:59,084 - src.hyperparameter_tuning - ERROR - Trial 66 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:59,102 - src.hyperparameter_tuning - INFO - Trial 67: 모델 타입 = xgboost
2025-06-24 09:27:59,106 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:59,106 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:59,106 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:59,106 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:59,106 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:59,106 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:59,106 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:59,106 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:59,106 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:59,107 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:59,107 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:59,107 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:59,107 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:59,107 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:59,107 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:59,107 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:59,107 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:59,107 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:59,108 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:59,108 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:59,108 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:59,108 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:59,108 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:59,108 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:59,108 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:59,108 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:59,108 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:59,108 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:59,112 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:59,114 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:59,114 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:59,114 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:59,114 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:59,114 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:59,114 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:59,114 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:59,116 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:59,118 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:59,118 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:59,118 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:59,118 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:59,118 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:59,118 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:59,118 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:59,118 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:59,118 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,118 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,118 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:59,118 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:59,119 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,119 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,119 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:59,119 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:59,119 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,119 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:59,119 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:59,119 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:59,120 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:59,120 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:59,120 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:59,120 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:59,120 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:59,120 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:59,120 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:59,120 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:59,120 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:59,120 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,120 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:59,120 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:59,120 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,120 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,121 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,121 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,121 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,121 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,121 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,121 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,121 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:59,121 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:59,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,122 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,122 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:59,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:59,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,122 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,122 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,122 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,123 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,123 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,123 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,123 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:59,123 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,123 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:59,123 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,123 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:59,123 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,123 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:59,124 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:59,124 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:59,124 - src.models.xgboost_model - INFO -   n_estimators: 460
2025-06-24 09:27:59,124 - src.models.xgboost_model - INFO -   max_depth: 14
2025-06-24 09:27:59,124 - src.models.xgboost_model - INFO -   learning_rate: 0.010279355645218053
2025-06-24 09:27:59,124 - src.models.xgboost_model - INFO -   subsample: 0.788610647676336
2025-06-24 09:27:59,124 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6007402282383875
2025-06-24 09:27:59,124 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 09:27:59,124 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:59,124 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:59,124 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:59,124 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:59,124 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:59,124 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:59,124 - src.models.xgboost_model - INFO -   reg_alpha: 2.1648599920690632e-07
2025-06-24 09:27:59,124 - src.models.xgboost_model - INFO -   reg_lambda: 3.822412525449798e-06
2025-06-24 09:27:59,124 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:59,124 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:59,124 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:59,223 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:59,223 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:59,223 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:59,223 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:59,223 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,224 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,224 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,224 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,224 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,224 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,224 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,225 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,225 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:59,225 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,225 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:59,226 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:59,226 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:59,226 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:59,226 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:59,226 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,226 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:59,226 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:59,226 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:59,226 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:59,226 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:59,226 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:59,226 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:59,227 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,227 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,227 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,227 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,227 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:59,227 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:59,227 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:59,227 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:27:59,227 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:59,227 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:59,227 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:59,227 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:59,227 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:59,227 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:59,227 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:59,227 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:59,227 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:59,228 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:59,228 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:59,228 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,228 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,228 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,228 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,249 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:59,250 - src.hyperparameter_tuning - ERROR - Trial 67 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:59,268 - src.hyperparameter_tuning - INFO - Trial 68: 모델 타입 = xgboost
2025-06-24 09:27:59,271 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:59,272 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:59,272 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:59,272 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:59,272 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:59,272 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:59,272 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:59,272 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:59,272 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:59,273 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:59,273 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:59,273 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:59,273 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:59,273 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:59,273 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:59,273 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:59,273 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:59,273 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:59,274 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:59,274 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:59,274 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:59,274 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:59,274 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:59,274 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:59,274 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:59,274 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:59,274 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:59,274 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:59,277 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:59,279 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:59,279 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:59,279 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:59,279 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:59,279 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:59,279 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:59,279 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:59,281 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:59,283 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:59,283 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:59,283 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:59,283 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:59,283 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:59,283 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:59,283 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:59,283 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:59,283 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,283 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,284 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:59,284 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:59,284 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,284 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,284 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:59,284 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:59,284 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,285 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:59,285 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:59,285 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:59,285 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:59,285 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:59,285 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:59,285 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:59,285 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:59,286 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:59,286 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:59,286 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:59,286 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:59,286 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,286 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:59,286 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:59,286 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,286 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,286 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,286 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,286 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,286 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,287 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,287 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,287 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:59,287 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,287 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:59,287 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,287 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,287 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:59,287 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:59,287 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,287 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,288 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,288 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,288 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,288 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,288 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,288 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,288 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:59,288 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,289 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:59,289 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,289 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:59,289 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,289 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:59,289 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:59,289 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:59,289 - src.models.xgboost_model - INFO -   n_estimators: 487
2025-06-24 09:27:59,289 - src.models.xgboost_model - INFO -   max_depth: 6
2025-06-24 09:27:59,289 - src.models.xgboost_model - INFO -   learning_rate: 0.09730090926348017
2025-06-24 09:27:59,289 - src.models.xgboost_model - INFO -   subsample: 0.6404051273442564
2025-06-24 09:27:59,289 - src.models.xgboost_model - INFO -   colsample_bytree: 0.703047110166788
2025-06-24 09:27:59,289 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 09:27:59,289 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:59,289 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:59,289 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:59,289 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:59,289 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:59,289 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:59,289 - src.models.xgboost_model - INFO -   reg_alpha: 4.604550476563442e-05
2025-06-24 09:27:59,289 - src.models.xgboost_model - INFO -   reg_lambda: 1.0047451535654421
2025-06-24 09:27:59,289 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:59,289 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:59,289 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:59,309 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:59,309 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:59,309 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:59,309 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:59,309 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,310 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,310 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,310 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,310 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,310 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,310 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,311 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,311 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:59,311 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:59,313 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:59,313 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:59,313 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:59,313 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:59,313 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,313 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:59,313 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:59,313 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:59,313 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:59,314 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:59,314 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:59,314 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:59,314 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,314 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,314 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,315 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,315 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:59,315 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:59,315 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:59,315 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:27:59,315 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:59,315 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:59,315 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:59,315 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:59,315 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:59,315 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:59,315 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:59,315 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:59,315 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:59,315 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:59,315 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:59,315 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,315 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,315 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,315 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,337 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:59,337 - src.hyperparameter_tuning - ERROR - Trial 68 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:59,354 - src.hyperparameter_tuning - INFO - Trial 69: 모델 타입 = xgboost
2025-06-24 09:27:59,357 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:59,358 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:59,358 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:59,358 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:59,358 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:59,358 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:59,358 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:59,358 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:59,358 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:59,359 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:59,359 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:59,359 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:59,359 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:59,359 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:59,359 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:59,359 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:59,359 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:59,359 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:59,360 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:59,360 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:59,360 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:59,360 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:59,360 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:59,360 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:59,360 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:59,360 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:59,360 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:59,360 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:59,363 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:59,365 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:59,365 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:59,365 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:59,366 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:59,366 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:59,366 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:59,366 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:59,368 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:59,370 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:59,370 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:59,370 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:59,370 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:59,370 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:59,370 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:59,370 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:59,370 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:59,370 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,370 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,370 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:59,370 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:59,370 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,370 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,370 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:59,370 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:59,370 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,371 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:59,371 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:59,371 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:59,372 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:59,372 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:59,372 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:59,372 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:59,372 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:59,372 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:59,372 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:59,372 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:59,372 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:59,372 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,372 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:59,372 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:59,372 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,372 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,372 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,373 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,373 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,373 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,373 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,373 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,373 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:59,373 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,374 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:59,374 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,374 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,374 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:59,374 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:59,374 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,374 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,374 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,374 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,374 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,375 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,375 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,375 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,375 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:59,375 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,375 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:59,375 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,375 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:59,375 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,375 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:59,376 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:59,376 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:59,376 - src.models.xgboost_model - INFO -   n_estimators: 568
2025-06-24 09:27:59,376 - src.models.xgboost_model - INFO -   max_depth: 8
2025-06-24 09:27:59,376 - src.models.xgboost_model - INFO -   learning_rate: 0.06647890428280832
2025-06-24 09:27:59,376 - src.models.xgboost_model - INFO -   subsample: 0.7553577490504471
2025-06-24 09:27:59,376 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6230458931249605
2025-06-24 09:27:59,376 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 09:27:59,376 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:59,376 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:59,376 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:59,376 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:59,376 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:59,376 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:59,376 - src.models.xgboost_model - INFO -   reg_alpha: 0.5602581457564217
2025-06-24 09:27:59,376 - src.models.xgboost_model - INFO -   reg_lambda: 0.10299929639216457
2025-06-24 09:27:59,376 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:59,376 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:59,376 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:59,389 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:59,389 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:59,389 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:59,389 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:59,389 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,389 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,390 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,390 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,390 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,390 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,390 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,390 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,390 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:59,390 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,391 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:59,391 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:59,391 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:59,391 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:59,391 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:59,391 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,391 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:59,391 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:59,391 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:59,392 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:59,392 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:59,392 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:59,392 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:59,392 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,392 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,393 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,393 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,393 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:59,393 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:59,393 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:59,393 - src.training - INFO -   accuracy: 0.984
2025-06-24 09:27:59,393 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:59,393 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:59,393 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:59,393 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:59,393 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:59,393 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:59,393 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:59,393 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:59,393 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:59,393 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:59,394 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.984, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:59,394 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,394 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,394 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,394 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,415 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:59,415 - src.hyperparameter_tuning - ERROR - Trial 69 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:59,433 - src.hyperparameter_tuning - INFO - Trial 70: 모델 타입 = xgboost
2025-06-24 09:27:59,437 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:59,438 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:59,438 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:59,438 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:59,438 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:59,438 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:59,438 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:59,438 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:59,438 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:59,438 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:59,439 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:59,439 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:59,439 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:59,439 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:59,439 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:59,439 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:59,439 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:59,439 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:59,440 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:59,440 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:59,440 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:59,440 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:59,440 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:59,440 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:59,440 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:59,440 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:59,440 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:59,440 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:59,443 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:59,445 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:59,445 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:59,445 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:59,445 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:59,445 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:59,445 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:59,445 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:59,447 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:59,449 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:59,449 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:59,449 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:59,449 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:59,449 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:59,449 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:59,449 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:59,449 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:59,449 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,449 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,450 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:59,450 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:59,450 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,450 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,450 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:59,450 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:59,450 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,450 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:59,451 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:59,451 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:59,451 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:59,451 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:59,451 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:59,451 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:59,451 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:59,451 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:59,451 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:59,451 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:59,451 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:59,451 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,452 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:59,452 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:59,452 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,452 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,452 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,452 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,452 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,452 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,453 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,453 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,453 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:59,453 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,453 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:59,453 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,453 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,453 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:59,453 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:59,453 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,453 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,454 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,454 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,454 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,454 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,454 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,454 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,454 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:59,454 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,455 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:59,455 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,455 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:59,455 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,455 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:59,455 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:59,455 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:59,455 - src.models.xgboost_model - INFO -   n_estimators: 695
2025-06-24 09:27:59,455 - src.models.xgboost_model - INFO -   max_depth: 13
2025-06-24 09:27:59,455 - src.models.xgboost_model - INFO -   learning_rate: 0.02344019160201767
2025-06-24 09:27:59,455 - src.models.xgboost_model - INFO -   subsample: 0.8642627275318365
2025-06-24 09:27:59,455 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6708359461260636
2025-06-24 09:27:59,455 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 09:27:59,455 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:59,455 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:59,455 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:59,455 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:59,455 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:59,455 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:59,455 - src.models.xgboost_model - INFO -   reg_alpha: 6.220432273522753e-08
2025-06-24 09:27:59,455 - src.models.xgboost_model - INFO -   reg_lambda: 2.3941535049884575
2025-06-24 09:27:59,455 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:59,455 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:59,455 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:59,497 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:59,497 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:59,497 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:59,497 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:59,497 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,497 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,497 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,497 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,498 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,498 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,498 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,498 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,498 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:59,498 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,498 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:59,504 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:59,504 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:59,504 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:59,504 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:59,504 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,504 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:59,504 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:59,504 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:59,505 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:59,505 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:59,505 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:59,505 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:59,505 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,505 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,505 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,506 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,506 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:59,506 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:59,506 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:59,506 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:27:59,506 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:59,506 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:59,506 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:59,506 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:59,506 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:59,506 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:59,506 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:59,506 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:59,506 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:59,506 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:59,506 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:59,506 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,506 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,507 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,507 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,528 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:59,528 - src.hyperparameter_tuning - ERROR - Trial 70 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:59,546 - src.hyperparameter_tuning - INFO - Trial 71: 모델 타입 = xgboost
2025-06-24 09:27:59,550 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:59,550 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:59,551 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:59,551 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:59,551 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:59,551 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:59,551 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:59,551 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:59,551 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:59,551 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:59,551 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:59,551 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:59,551 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:59,551 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:59,551 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:59,551 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:59,551 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:59,551 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:59,552 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:59,552 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:59,552 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:59,552 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:59,552 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:59,552 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:59,552 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:59,552 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:59,552 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:59,552 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:59,556 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:59,558 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:59,558 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:59,558 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:59,558 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:59,558 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:59,558 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:59,558 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:59,560 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:59,562 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:59,562 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:59,562 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:59,562 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:59,562 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:59,562 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:59,562 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:59,562 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:59,562 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,562 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,563 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:59,563 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:59,563 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,563 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,563 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:59,563 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:59,563 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,563 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:59,563 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:59,563 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:59,564 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:59,564 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:59,564 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:59,564 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:59,564 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:59,564 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:59,564 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:59,564 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:59,564 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:59,564 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,564 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:59,564 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:59,564 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,565 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,565 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,565 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,565 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,565 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,565 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,566 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,566 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:59,566 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,566 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:59,566 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,566 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,566 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:59,566 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:59,566 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,566 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,566 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,567 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,567 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,567 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,567 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,567 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,567 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:59,567 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,567 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:59,567 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,567 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:59,567 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,567 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:59,568 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:59,568 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:59,568 - src.models.xgboost_model - INFO -   n_estimators: 384
2025-06-24 09:27:59,568 - src.models.xgboost_model - INFO -   max_depth: 6
2025-06-24 09:27:59,568 - src.models.xgboost_model - INFO -   learning_rate: 0.04634783282470217
2025-06-24 09:27:59,568 - src.models.xgboost_model - INFO -   subsample: 0.6495556176249225
2025-06-24 09:27:59,568 - src.models.xgboost_model - INFO -   colsample_bytree: 0.9432352490990602
2025-06-24 09:27:59,568 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 09:27:59,568 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:59,568 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:59,568 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:59,568 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:59,568 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:59,568 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:59,568 - src.models.xgboost_model - INFO -   reg_alpha: 8.887669300615459
2025-06-24 09:27:59,568 - src.models.xgboost_model - INFO -   reg_lambda: 0.34889850438251785
2025-06-24 09:27:59,568 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:59,568 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:59,568 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:59,587 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:59,587 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:59,587 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:59,587 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:59,587 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,588 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,588 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,588 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,588 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,588 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,588 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,589 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,589 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:59,589 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,589 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:59,589 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:59,590 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:59,590 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:59,590 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:59,590 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,590 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:59,590 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:59,590 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:59,590 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:59,590 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:59,590 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:59,590 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:59,590 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,590 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,591 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,591 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,591 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:59,591 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:59,591 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:59,591 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:59,591 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:59,591 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:59,591 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:59,591 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:59,591 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:59,591 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:59,591 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:59,591 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:59,591 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:59,592 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:59,592 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:59,592 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,592 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,592 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,592 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,614 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:59,614 - src.hyperparameter_tuning - ERROR - Trial 71 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:59,632 - src.hyperparameter_tuning - INFO - Trial 72: 모델 타입 = xgboost
2025-06-24 09:27:59,635 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:59,636 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:59,636 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:59,636 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:59,636 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:59,636 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:59,636 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:59,636 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:59,636 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:59,637 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:59,637 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:59,637 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:59,637 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:59,637 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:59,637 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:59,637 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:59,637 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:59,637 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:59,638 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:59,638 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:59,638 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:59,638 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:59,638 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:59,638 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:59,638 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:59,638 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:59,638 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:59,638 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:59,641 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:59,643 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:59,643 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:59,643 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:59,643 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:59,644 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:59,644 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:59,644 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:59,646 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:59,648 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:59,648 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:59,648 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:59,648 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:59,648 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:59,648 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:59,648 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:59,648 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:59,648 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,648 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,648 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:59,648 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:59,648 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,648 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,648 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:59,648 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:59,648 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,649 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:59,649 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:59,649 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:59,650 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:59,650 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:59,650 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:59,650 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:59,650 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:59,650 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:59,650 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:59,650 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:59,650 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:59,650 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,650 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:59,650 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:59,650 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,650 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,650 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,651 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,651 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,651 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,651 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,651 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,651 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:59,651 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,652 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:59,652 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,652 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,652 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:59,652 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:59,652 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,652 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,652 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,652 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,652 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,652 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,653 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,653 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,653 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:59,653 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,653 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:59,653 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,653 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:59,653 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,653 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:59,654 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:59,654 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:59,654 - src.models.xgboost_model - INFO -   n_estimators: 284
2025-06-24 09:27:59,654 - src.models.xgboost_model - INFO -   max_depth: 4
2025-06-24 09:27:59,654 - src.models.xgboost_model - INFO -   learning_rate: 0.08385288060187905
2025-06-24 09:27:59,654 - src.models.xgboost_model - INFO -   subsample: 0.6657162896381135
2025-06-24 09:27:59,654 - src.models.xgboost_model - INFO -   colsample_bytree: 0.8316137715558425
2025-06-24 09:27:59,654 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 09:27:59,654 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:59,654 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:59,654 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:59,654 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:59,654 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:59,654 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:59,654 - src.models.xgboost_model - INFO -   reg_alpha: 2.7179151631949225
2025-06-24 09:27:59,654 - src.models.xgboost_model - INFO -   reg_lambda: 0.09595386642381562
2025-06-24 09:27:59,654 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:59,654 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:59,654 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:59,668 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:59,668 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:59,668 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:59,668 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:59,668 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,668 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,668 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,668 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,669 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,669 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,669 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,669 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,669 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:59,669 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,669 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:59,670 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:59,670 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:59,670 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:59,670 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:59,670 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,670 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:59,670 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:59,670 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:59,670 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:59,670 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:59,670 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:59,670 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:59,671 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,671 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,671 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,671 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,671 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:59,672 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:59,672 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:59,672 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:27:59,672 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:59,672 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:59,672 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:59,672 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:59,672 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:59,672 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:59,672 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:59,672 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:59,672 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:59,672 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:59,672 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:59,672 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,672 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,672 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,672 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,694 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:59,694 - src.hyperparameter_tuning - ERROR - Trial 72 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:59,712 - src.hyperparameter_tuning - INFO - Trial 73: 모델 타입 = xgboost
2025-06-24 09:27:59,716 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:59,717 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:59,717 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:59,717 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:59,717 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:59,717 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:59,717 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:59,717 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:59,717 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:59,717 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:59,718 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:59,718 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:59,718 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:59,718 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:59,718 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:59,718 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:59,718 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:59,718 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:59,718 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:59,719 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:59,719 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:59,719 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:59,719 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:59,719 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:59,719 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:59,719 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:59,719 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:59,719 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:59,722 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:59,724 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:59,724 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:59,724 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:59,724 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:59,724 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:59,724 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:59,724 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:59,726 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:59,728 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:59,728 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:59,728 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:59,728 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:59,728 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:59,728 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:59,728 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:59,728 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:59,728 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,728 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,729 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:59,729 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:59,729 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,729 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,729 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:59,729 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:59,729 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,729 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:59,729 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:59,730 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:59,730 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:59,730 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:59,730 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:59,730 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:59,730 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:59,730 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:59,730 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:59,730 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:59,730 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:59,730 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,730 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:59,730 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:59,730 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,731 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,731 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,731 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,731 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,731 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,731 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,732 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,732 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:59,732 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,732 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:59,732 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,732 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,732 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:59,732 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:59,732 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,732 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,732 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,733 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,733 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,733 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,733 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,733 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,733 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:59,733 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,733 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:59,733 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,733 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:59,734 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,734 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:59,734 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:59,734 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:59,734 - src.models.xgboost_model - INFO -   n_estimators: 332
2025-06-24 09:27:59,734 - src.models.xgboost_model - INFO -   max_depth: 9
2025-06-24 09:27:59,734 - src.models.xgboost_model - INFO -   learning_rate: 0.06564385259487518
2025-06-24 09:27:59,734 - src.models.xgboost_model - INFO -   subsample: 0.6366226835102399
2025-06-24 09:27:59,734 - src.models.xgboost_model - INFO -   colsample_bytree: 0.8752546753201617
2025-06-24 09:27:59,734 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 09:27:59,734 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:59,734 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:59,734 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:59,734 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:59,734 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:59,734 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:59,734 - src.models.xgboost_model - INFO -   reg_alpha: 5.150012366819398
2025-06-24 09:27:59,734 - src.models.xgboost_model - INFO -   reg_lambda: 1.003711451020569
2025-06-24 09:27:59,734 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:59,734 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:59,734 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:59,748 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:59,748 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:59,748 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:59,748 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:59,748 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,748 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,748 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,748 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,748 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,749 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,749 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,749 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,749 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:59,749 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,749 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:59,750 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:59,750 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:59,750 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:59,750 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:59,750 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,750 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:59,750 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:59,750 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:59,750 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:59,750 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:59,750 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:59,750 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:59,750 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,751 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,751 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,751 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,751 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:59,751 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:59,751 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:59,751 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:27:59,751 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:59,751 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:59,751 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:59,751 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:59,751 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:59,751 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:59,751 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:59,751 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:59,752 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:59,752 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:59,752 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:59,752 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,752 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,752 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,752 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,774 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:59,774 - src.hyperparameter_tuning - ERROR - Trial 73 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:59,792 - src.hyperparameter_tuning - INFO - Trial 74: 모델 타입 = xgboost
2025-06-24 09:27:59,796 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:59,797 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:59,797 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:59,797 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:59,797 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:59,797 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:59,797 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:59,797 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:59,797 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:59,797 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:59,798 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:59,798 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:59,798 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:59,798 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:59,798 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:59,798 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:59,798 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:59,798 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:59,799 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:59,799 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:59,799 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:59,799 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:59,799 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:59,799 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:59,799 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:59,799 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:59,799 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:59,799 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:59,802 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:59,804 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:59,804 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:59,804 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:59,804 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:59,804 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:59,804 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:59,804 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:59,806 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:59,808 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:59,808 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:59,808 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:59,808 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:59,808 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:59,808 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:59,808 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:59,808 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:59,809 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,809 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,809 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:59,809 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:59,809 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,809 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,809 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:59,809 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:59,809 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,810 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:59,810 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:59,810 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:59,811 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:59,811 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:59,811 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:59,811 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:59,811 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:59,811 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:59,811 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:59,811 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:59,811 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:59,811 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,811 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:59,811 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:59,811 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,811 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,811 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,811 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,811 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,812 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,812 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,812 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,812 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:59,812 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,812 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:59,812 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,812 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,812 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:59,812 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:59,812 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,813 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,813 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,813 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,813 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,813 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,813 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,813 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,813 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:59,813 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,814 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:59,814 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,814 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:59,814 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,814 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:59,814 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:59,814 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:59,814 - src.models.xgboost_model - INFO -   n_estimators: 447
2025-06-24 09:27:59,814 - src.models.xgboost_model - INFO -   max_depth: 5
2025-06-24 09:27:59,814 - src.models.xgboost_model - INFO -   learning_rate: 0.05989345129213702
2025-06-24 09:27:59,814 - src.models.xgboost_model - INFO -   subsample: 0.6925861679392898
2025-06-24 09:27:59,814 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6843827350824451
2025-06-24 09:27:59,814 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 09:27:59,814 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:59,814 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:59,814 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:59,814 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:59,814 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:59,814 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:59,814 - src.models.xgboost_model - INFO -   reg_alpha: 5.118786379381839e-07
2025-06-24 09:27:59,814 - src.models.xgboost_model - INFO -   reg_lambda: 1.093596014940291e-06
2025-06-24 09:27:59,814 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:59,814 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:59,815 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:59,837 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:59,837 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:59,837 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:59,837 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:59,837 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,838 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,838 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,838 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,838 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,838 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,838 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,838 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,839 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:59,839 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,839 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:59,839 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:59,839 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:59,839 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:59,839 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:59,840 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,840 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:59,840 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:59,840 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:59,840 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:59,840 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:59,840 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:59,840 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:59,840 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,840 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,840 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,841 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,841 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:59,841 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:59,841 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:59,841 - src.training - INFO -   accuracy: 0.984
2025-06-24 09:27:59,841 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:59,841 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:59,841 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:59,841 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:59,841 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:59,841 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:59,841 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:59,841 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:59,841 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:59,841 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:59,841 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.984, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:59,841 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,842 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,842 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,842 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,863 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:59,863 - src.hyperparameter_tuning - ERROR - Trial 74 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:59,882 - src.hyperparameter_tuning - INFO - Trial 75: 모델 타입 = xgboost
2025-06-24 09:27:59,886 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:59,887 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:59,887 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:59,887 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:59,887 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:59,887 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:59,887 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:59,887 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:59,887 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:59,887 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:59,887 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:59,887 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:59,887 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:59,887 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:59,887 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:59,887 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:59,887 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:59,887 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:59,888 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:59,888 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:59,888 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:59,888 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:59,888 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:59,888 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:59,888 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:59,888 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:59,888 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:59,888 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:59,892 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:59,894 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:59,894 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:59,894 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:59,894 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:59,894 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:59,894 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:59,894 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:59,896 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:59,898 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:59,898 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:59,898 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:59,898 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:59,898 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:59,898 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:59,898 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:59,898 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:59,898 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,898 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,899 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:59,899 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:59,899 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,899 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,899 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:59,899 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:59,899 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,899 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:59,899 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:59,899 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:59,900 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:59,900 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:59,900 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:59,900 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:59,900 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:59,900 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:59,900 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:59,900 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:59,900 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:59,900 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,900 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:59,900 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:59,900 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,901 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,901 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,901 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,901 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,901 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,901 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,901 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,902 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:59,902 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,902 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:59,902 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,902 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,902 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:59,902 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:59,902 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,902 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,902 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,903 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,903 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,903 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,903 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,903 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,903 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:59,903 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,903 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:59,903 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,903 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:59,903 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,903 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:59,904 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:59,904 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:59,904 - src.models.xgboost_model - INFO -   n_estimators: 366
2025-06-24 09:27:59,904 - src.models.xgboost_model - INFO -   max_depth: 5
2025-06-24 09:27:59,904 - src.models.xgboost_model - INFO -   learning_rate: 0.07545121326757587
2025-06-24 09:27:59,904 - src.models.xgboost_model - INFO -   subsample: 0.6217112676073377
2025-06-24 09:27:59,904 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7461623645206352
2025-06-24 09:27:59,904 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 09:27:59,904 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:59,904 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:59,904 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:59,904 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:59,904 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:59,904 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:59,904 - src.models.xgboost_model - INFO -   reg_alpha: 3.591723831798953e-08
2025-06-24 09:27:59,904 - src.models.xgboost_model - INFO -   reg_lambda: 4.624302543074102
2025-06-24 09:27:59,904 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:59,904 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:59,904 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:27:59,918 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:27:59,918 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:27:59,918 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:27:59,918 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:59,918 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,919 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,919 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,919 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:59,920 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,920 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:27:59,920 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:27:59,920 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:27:59,920 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:27:59,920 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:27:59,920 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,920 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:27:59,921 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:27:59,921 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:27:59,921 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:27:59,921 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:27:59,921 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:27:59,921 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:27:59,921 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,921 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,922 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,922 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:27:59,922 - src.training - INFO -   precision: 0.0
2025-06-24 09:27:59,922 - src.training - INFO -   recall: 0.0
2025-06-24 09:27:59,922 - src.training - INFO -   f1: 0.0
2025-06-24 09:27:59,922 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:27:59,922 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:27:59,922 - src.training - INFO -   positive_samples: 0
2025-06-24 09:27:59,922 - src.training - INFO -   negative_samples: 250
2025-06-24 09:27:59,922 - src.training - INFO -   total_samples: 250
2025-06-24 09:27:59,922 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:27:59,922 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:27:59,922 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:27:59,922 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:27:59,922 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:27:59,923 - src.training - INFO - 모델 학습 완료
2025-06-24 09:27:59,923 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:27:59,923 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,923 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,923 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,923 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,945 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:27:59,945 - src.hyperparameter_tuning - ERROR - Trial 75 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:27:59,963 - src.hyperparameter_tuning - INFO - Trial 76: 모델 타입 = xgboost
2025-06-24 09:27:59,967 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:27:59,968 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:27:59,968 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:27:59,968 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:27:59,968 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:27:59,968 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:27:59,968 - src.training - INFO - 교차 검증 시작
2025-06-24 09:27:59,968 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:27:59,968 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:27:59,969 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:27:59,969 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:27:59,969 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:27:59,969 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:27:59,969 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:27:59,969 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:27:59,969 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:27:59,969 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:27:59,969 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:27:59,970 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:59,970 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:59,970 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:27:59,970 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:27:59,970 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:59,970 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:27:59,970 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:27:59,970 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:27:59,970 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:27:59,970 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:27:59,973 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:27:59,975 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:59,975 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:27:59,975 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:27:59,975 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:27:59,976 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:27:59,976 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:27:59,976 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:27:59,978 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:27:59,980 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:27:59,980 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:59,980 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:59,980 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:27:59,980 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:27:59,980 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:59,980 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:27:59,980 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:27:59,980 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,980 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,980 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:27:59,980 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:27:59,980 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,980 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,980 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:27:59,980 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:27:59,980 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,981 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:59,981 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:27:59,981 - src.training - INFO - 모델 학습 시작
2025-06-24 09:27:59,982 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:27:59,982 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:27:59,982 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:27:59,982 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:27:59,982 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:27:59,982 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:27:59,982 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:27:59,982 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:27:59,982 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:27:59,982 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,982 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:27:59,982 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:27:59,982 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,982 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,983 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,983 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,983 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,983 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,983 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,984 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:27:59,984 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,984 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:27:59,984 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,984 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,984 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:27:59,984 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:27:59,984 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,984 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:27:59,985 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:27:59,985 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:27:59,985 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:27:59,985 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:27:59,985 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:27:59,985 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:27:59,985 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:27:59,985 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:27:59,986 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:27:59,986 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,986 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:27:59,986 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:27:59,986 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:27:59,986 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:27:59,986 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:27:59,986 - src.models.xgboost_model - INFO -   n_estimators: 251
2025-06-24 09:27:59,986 - src.models.xgboost_model - INFO -   max_depth: 10
2025-06-24 09:27:59,986 - src.models.xgboost_model - INFO -   learning_rate: 0.01779375529974472
2025-06-24 09:27:59,986 - src.models.xgboost_model - INFO -   subsample: 0.7987341374614242
2025-06-24 09:27:59,986 - src.models.xgboost_model - INFO -   colsample_bytree: 0.8559164726165345
2025-06-24 09:27:59,986 - src.models.xgboost_model - INFO -   min_child_weight: 5
2025-06-24 09:27:59,986 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:27:59,986 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:27:59,986 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:27:59,986 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:27:59,986 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:27:59,986 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:27:59,986 - src.models.xgboost_model - INFO -   reg_alpha: 1.5034238745928261
2025-06-24 09:27:59,986 - src.models.xgboost_model - INFO -   reg_lambda: 0.032844738310108486
2025-06-24 09:27:59,986 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:27:59,986 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:27:59,987 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:28:00,027 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:28:00,027 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:28:00,027 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:28:00,027 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:00,027 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,027 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,027 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,027 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,028 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,028 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,028 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,028 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,028 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:00,028 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,028 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:28:00,029 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:28:00,029 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:28:00,029 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:28:00,029 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:28:00,029 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,029 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:28:00,029 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:28:00,029 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:28:00,029 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:28:00,029 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:28:00,030 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:28:00,030 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:28:00,030 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,030 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,030 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,030 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,031 - src.training - INFO -   precision: 0.0
2025-06-24 09:28:00,031 - src.training - INFO -   recall: 0.0
2025-06-24 09:28:00,031 - src.training - INFO -   f1: 0.0
2025-06-24 09:28:00,031 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:28:00,031 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:28:00,031 - src.training - INFO -   positive_samples: 0
2025-06-24 09:28:00,031 - src.training - INFO -   negative_samples: 250
2025-06-24 09:28:00,031 - src.training - INFO -   total_samples: 250
2025-06-24 09:28:00,031 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:28:00,031 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:28:00,031 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:28:00,031 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:28:00,031 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:28:00,031 - src.training - INFO - 모델 학습 완료
2025-06-24 09:28:00,031 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:28:00,031 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,031 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,031 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,031 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,053 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:28:00,054 - src.hyperparameter_tuning - ERROR - Trial 76 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:28:00,072 - src.hyperparameter_tuning - INFO - Trial 77: 모델 타입 = xgboost
2025-06-24 09:28:00,076 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:28:00,077 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:28:00,077 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:28:00,077 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:28:00,077 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:28:00,077 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:28:00,077 - src.training - INFO - 교차 검증 시작
2025-06-24 09:28:00,077 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:28:00,077 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:28:00,077 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:28:00,077 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:28:00,077 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:28:00,077 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:28:00,077 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:28:00,077 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:28:00,077 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:28:00,077 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:28:00,078 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:28:00,079 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:00,079 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:00,079 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:00,079 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:00,079 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:00,079 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:28:00,079 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:28:00,079 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:28:00,079 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:28:00,079 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:28:00,082 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:28:00,084 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:00,084 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:28:00,084 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:28:00,084 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:28:00,084 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:28:00,084 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:28:00,084 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:00,086 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:00,088 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:28:00,088 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:00,088 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:00,088 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:00,088 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:00,088 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:00,088 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:00,088 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:28:00,088 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,088 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,089 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:28:00,089 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:28:00,089 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,089 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,089 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:28:00,089 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:28:00,089 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,090 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:00,090 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:00,090 - src.training - INFO - 모델 학습 시작
2025-06-24 09:28:00,091 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:28:00,091 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:28:00,091 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:28:00,091 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:28:00,091 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:28:00,091 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:28:00,091 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:28:00,091 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:28:00,091 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:28:00,091 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,091 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:28:00,091 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:28:00,091 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,091 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,091 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,091 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,091 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,092 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,092 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,092 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,092 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:28:00,092 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,092 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:28:00,092 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,092 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,092 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:28:00,092 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:00,092 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,093 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,093 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,093 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,093 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,093 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,093 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,093 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,093 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:00,094 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,094 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:28:00,094 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,094 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:28:00,094 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,094 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:28:00,094 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:28:00,094 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:28:00,094 - src.models.xgboost_model - INFO -   n_estimators: 531
2025-06-24 09:28:00,094 - src.models.xgboost_model - INFO -   max_depth: 7
2025-06-24 09:28:00,094 - src.models.xgboost_model - INFO -   learning_rate: 0.23849423555782936
2025-06-24 09:28:00,094 - src.models.xgboost_model - INFO -   subsample: 0.9419379172450565
2025-06-24 09:28:00,094 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7863023467758691
2025-06-24 09:28:00,094 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 09:28:00,094 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:28:00,094 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:28:00,094 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:28:00,094 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:28:00,094 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:28:00,094 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:28:00,095 - src.models.xgboost_model - INFO -   reg_alpha: 0.0032362074058608914
2025-06-24 09:28:00,095 - src.models.xgboost_model - INFO -   reg_lambda: 0.008381574440545663
2025-06-24 09:28:00,095 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:28:00,095 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:28:00,095 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:28:00,102 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:28:00,102 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:28:00,102 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:28:00,102 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:00,102 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,102 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,102 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,102 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,102 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,103 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,103 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,103 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,103 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:00,103 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,103 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:28:00,104 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:28:00,104 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:28:00,104 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:28:00,104 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:28:00,104 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,104 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:28:00,104 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:28:00,104 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:28:00,104 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:28:00,104 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:28:00,104 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:28:00,104 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:28:00,105 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,105 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,105 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,105 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,105 - src.training - INFO -   precision: 0.0
2025-06-24 09:28:00,105 - src.training - INFO -   recall: 0.0
2025-06-24 09:28:00,105 - src.training - INFO -   f1: 0.0
2025-06-24 09:28:00,105 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:28:00,106 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:28:00,106 - src.training - INFO -   positive_samples: 0
2025-06-24 09:28:00,106 - src.training - INFO -   negative_samples: 250
2025-06-24 09:28:00,106 - src.training - INFO -   total_samples: 250
2025-06-24 09:28:00,106 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:28:00,106 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:28:00,106 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:28:00,106 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:28:00,106 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:28:00,106 - src.training - INFO - 모델 학습 완료
2025-06-24 09:28:00,106 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:28:00,106 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,106 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,106 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,106 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,128 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:28:00,128 - src.hyperparameter_tuning - ERROR - Trial 77 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:28:00,147 - src.hyperparameter_tuning - INFO - Trial 78: 모델 타입 = xgboost
2025-06-24 09:28:00,151 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:28:00,151 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:28:00,151 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:28:00,151 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:28:00,151 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:28:00,151 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:28:00,151 - src.training - INFO - 교차 검증 시작
2025-06-24 09:28:00,152 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:28:00,152 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:28:00,152 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:28:00,152 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:28:00,152 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:28:00,152 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:28:00,152 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:28:00,152 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:28:00,152 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:28:00,152 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:28:00,152 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:28:00,153 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:00,153 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:00,153 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:00,153 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:00,153 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:00,153 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:28:00,153 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:28:00,153 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:28:00,153 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:28:00,153 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:28:00,157 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:28:00,159 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:00,159 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:28:00,159 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:28:00,159 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:28:00,159 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:28:00,159 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:28:00,159 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:00,161 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:00,163 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:28:00,163 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:00,163 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:00,163 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:00,163 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:00,163 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:00,163 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:00,163 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:28:00,163 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,163 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,164 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:28:00,164 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:28:00,164 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,164 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,164 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:28:00,164 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:28:00,164 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,164 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:00,164 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:00,164 - src.training - INFO - 모델 학습 시작
2025-06-24 09:28:00,165 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:28:00,165 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:28:00,165 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:28:00,165 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:28:00,165 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:28:00,165 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:28:00,165 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:28:00,165 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:28:00,165 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:28:00,165 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,165 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:28:00,165 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:28:00,165 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,165 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,166 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,166 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,166 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,166 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,166 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,166 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,167 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:28:00,167 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,167 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:28:00,167 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,167 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,167 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:28:00,167 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:00,167 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,167 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,167 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,167 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,167 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,168 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,168 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,168 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,168 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:00,168 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,168 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:28:00,168 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,168 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:28:00,168 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,168 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:28:00,169 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:28:00,169 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:28:00,169 - src.models.xgboost_model - INFO -   n_estimators: 998
2025-06-24 09:28:00,169 - src.models.xgboost_model - INFO -   max_depth: 4
2025-06-24 09:28:00,169 - src.models.xgboost_model - INFO -   learning_rate: 0.013420812289042905
2025-06-24 09:28:00,169 - src.models.xgboost_model - INFO -   subsample: 0.7718479733534648
2025-06-24 09:28:00,169 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6443965869624858
2025-06-24 09:28:00,169 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 09:28:00,169 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:28:00,169 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:28:00,169 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:28:00,169 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:28:00,169 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:28:00,169 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:28:00,169 - src.models.xgboost_model - INFO -   reg_alpha: 0.8415509018451914
2025-06-24 09:28:00,169 - src.models.xgboost_model - INFO -   reg_lambda: 0.001152784143478744
2025-06-24 09:28:00,169 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:28:00,169 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:28:00,169 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:28:00,230 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:28:00,230 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:28:00,230 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:28:00,230 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:00,230 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,230 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,231 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,231 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,231 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,231 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,231 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,231 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,231 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:00,231 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,232 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:28:00,233 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:28:00,233 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:28:00,233 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:28:00,233 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:28:00,233 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,233 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:28:00,233 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:28:00,233 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:28:00,234 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:28:00,234 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:28:00,234 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:28:00,234 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:28:00,234 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,234 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,234 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,235 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,235 - src.training - INFO -   precision: 0.0
2025-06-24 09:28:00,235 - src.training - INFO -   recall: 0.0
2025-06-24 09:28:00,235 - src.training - INFO -   f1: 0.0
2025-06-24 09:28:00,235 - src.training - INFO -   accuracy: 0.984
2025-06-24 09:28:00,235 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:28:00,235 - src.training - INFO -   positive_samples: 0
2025-06-24 09:28:00,235 - src.training - INFO -   negative_samples: 250
2025-06-24 09:28:00,235 - src.training - INFO -   total_samples: 250
2025-06-24 09:28:00,235 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:28:00,235 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:28:00,235 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:28:00,235 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:28:00,235 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:28:00,235 - src.training - INFO - 모델 학습 완료
2025-06-24 09:28:00,235 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.984, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:28:00,235 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,235 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,235 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,235 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,258 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:28:00,258 - src.hyperparameter_tuning - ERROR - Trial 78 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:28:00,276 - src.hyperparameter_tuning - INFO - Trial 79: 모델 타입 = xgboost
2025-06-24 09:28:00,280 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:28:00,281 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:28:00,281 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:28:00,281 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:28:00,281 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:28:00,281 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:28:00,281 - src.training - INFO - 교차 검증 시작
2025-06-24 09:28:00,281 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:28:00,281 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:28:00,281 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:28:00,281 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:28:00,282 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:28:00,282 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:28:00,282 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:28:00,282 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:28:00,282 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:28:00,282 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:28:00,282 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:28:00,282 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:00,283 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:00,283 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:00,283 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:00,283 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:00,283 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:28:00,283 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:28:00,283 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:28:00,283 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:28:00,283 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:28:00,286 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:28:00,288 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:00,288 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:28:00,288 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:28:00,288 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:28:00,288 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:28:00,288 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:28:00,288 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:00,290 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:00,292 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:28:00,292 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:00,292 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:00,292 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:00,292 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:00,292 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:00,292 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:00,292 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:28:00,292 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,292 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,293 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:28:00,293 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:28:00,293 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,293 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,293 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:28:00,293 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:28:00,293 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,294 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:00,294 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:00,294 - src.training - INFO - 모델 학습 시작
2025-06-24 09:28:00,294 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:28:00,294 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:28:00,294 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:28:00,294 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:28:00,294 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:28:00,295 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:28:00,295 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:28:00,295 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:28:00,295 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:28:00,295 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,295 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:28:00,295 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:28:00,295 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,295 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,295 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,295 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,295 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,295 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,296 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,296 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,296 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:28:00,296 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,296 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:28:00,296 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,296 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,296 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:28:00,296 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:00,296 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,296 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,297 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,297 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:00,297 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:28:00,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,298 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:28:00,298 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,298 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:28:00,298 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:28:00,298 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:28:00,298 - src.models.xgboost_model - INFO -   n_estimators: 505
2025-06-24 09:28:00,298 - src.models.xgboost_model - INFO -   max_depth: 6
2025-06-24 09:28:00,298 - src.models.xgboost_model - INFO -   learning_rate: 0.09223704045252305
2025-06-24 09:28:00,298 - src.models.xgboost_model - INFO -   subsample: 0.6084206452361289
2025-06-24 09:28:00,298 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6576916197629644
2025-06-24 09:28:00,298 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 09:28:00,298 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:28:00,298 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:28:00,298 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:28:00,298 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:28:00,298 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:28:00,298 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:28:00,298 - src.models.xgboost_model - INFO -   reg_alpha: 0.0011987901971062102
2025-06-24 09:28:00,298 - src.models.xgboost_model - INFO -   reg_lambda: 0.00029030914836418713
2025-06-24 09:28:00,298 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:28:00,298 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:28:00,298 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:28:00,314 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:28:00,314 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:28:00,314 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:28:00,314 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:00,314 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,314 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,314 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,314 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,314 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,315 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,315 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,315 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,315 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:00,315 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,315 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:28:00,316 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:28:00,316 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:28:00,316 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:28:00,316 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:28:00,316 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,316 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:28:00,316 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:28:00,316 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:28:00,316 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:28:00,316 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:28:00,316 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:28:00,316 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:28:00,317 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,317 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,317 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,317 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,317 - src.training - INFO -   precision: 0.0
2025-06-24 09:28:00,318 - src.training - INFO -   recall: 0.0
2025-06-24 09:28:00,318 - src.training - INFO -   f1: 0.0
2025-06-24 09:28:00,318 - src.training - INFO -   accuracy: 0.988
2025-06-24 09:28:00,318 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:28:00,318 - src.training - INFO -   positive_samples: 0
2025-06-24 09:28:00,318 - src.training - INFO -   negative_samples: 250
2025-06-24 09:28:00,318 - src.training - INFO -   total_samples: 250
2025-06-24 09:28:00,318 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:28:00,318 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:28:00,318 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:28:00,318 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:28:00,318 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:28:00,318 - src.training - INFO - 모델 학습 완료
2025-06-24 09:28:00,318 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.988, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:28:00,318 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,318 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,318 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,318 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,341 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:28:00,341 - src.hyperparameter_tuning - ERROR - Trial 79 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:28:00,359 - src.hyperparameter_tuning - INFO - Trial 80: 모델 타입 = xgboost
2025-06-24 09:28:00,363 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:28:00,364 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:28:00,364 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:28:00,364 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:28:00,364 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:28:00,364 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:28:00,364 - src.training - INFO - 교차 검증 시작
2025-06-24 09:28:00,364 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:28:00,364 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:28:00,365 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:28:00,365 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:28:00,365 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:28:00,365 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:28:00,365 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:28:00,365 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:28:00,365 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:28:00,365 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:28:00,365 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:28:00,366 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:00,366 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:00,366 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:00,366 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:00,366 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:00,366 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:28:00,366 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:28:00,366 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:28:00,366 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:28:00,366 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:28:00,369 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:28:00,371 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:00,371 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:28:00,371 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:28:00,371 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:28:00,371 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:28:00,371 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:28:00,371 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:00,373 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:00,375 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:28:00,375 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:00,375 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:00,375 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:00,375 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:00,375 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:00,375 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:00,376 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:28:00,376 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,376 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,376 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:28:00,376 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:28:00,376 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,376 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,376 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:28:00,376 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:28:00,376 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,377 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:00,377 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:00,377 - src.training - INFO - 모델 학습 시작
2025-06-24 09:28:00,378 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:28:00,378 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:28:00,378 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:28:00,378 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:28:00,378 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:28:00,378 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:28:00,378 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:28:00,378 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:28:00,378 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:28:00,378 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,378 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:28:00,378 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:28:00,378 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,378 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,378 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,378 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,378 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,379 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,379 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,379 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,379 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:28:00,379 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,379 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:28:00,379 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,379 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,379 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:28:00,379 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:00,379 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,380 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,380 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,380 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,380 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,380 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,380 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,380 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,380 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:00,380 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,381 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:28:00,381 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,381 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:28:00,381 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,381 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:28:00,381 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:28:00,381 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:28:00,381 - src.models.xgboost_model - INFO -   n_estimators: 804
2025-06-24 09:28:00,381 - src.models.xgboost_model - INFO -   max_depth: 3
2025-06-24 09:28:00,381 - src.models.xgboost_model - INFO -   learning_rate: 0.14958986572942531
2025-06-24 09:28:00,381 - src.models.xgboost_model - INFO -   subsample: 0.7068138084717677
2025-06-24 09:28:00,381 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7255899090155987
2025-06-24 09:28:00,381 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 09:28:00,381 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:28:00,381 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:28:00,381 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:28:00,381 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:28:00,381 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:28:00,381 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:28:00,381 - src.models.xgboost_model - INFO -   reg_alpha: 3.0035571687042233
2025-06-24 09:28:00,381 - src.models.xgboost_model - INFO -   reg_lambda: 0.45430900321965184
2025-06-24 09:28:00,381 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:28:00,381 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:28:00,382 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:28:00,390 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:28:00,390 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:28:00,390 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:28:00,390 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:00,390 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,390 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,390 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,390 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,391 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,391 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,391 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,391 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,391 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:00,391 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,391 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:28:00,392 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:28:00,392 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:28:00,392 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:28:00,392 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:28:00,392 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,392 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:28:00,392 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:28:00,392 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:28:00,392 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:28:00,392 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:28:00,392 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:28:00,392 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:28:00,393 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,393 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,393 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,393 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,393 - src.training - INFO -   precision: 0.0
2025-06-24 09:28:00,393 - src.training - INFO -   recall: 0.0
2025-06-24 09:28:00,393 - src.training - INFO -   f1: 0.0
2025-06-24 09:28:00,393 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:28:00,393 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:28:00,394 - src.training - INFO -   positive_samples: 0
2025-06-24 09:28:00,394 - src.training - INFO -   negative_samples: 250
2025-06-24 09:28:00,394 - src.training - INFO -   total_samples: 250
2025-06-24 09:28:00,394 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:28:00,394 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:28:00,394 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:28:00,394 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:28:00,394 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:28:00,394 - src.training - INFO - 모델 학습 완료
2025-06-24 09:28:00,394 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:28:00,394 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,394 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,394 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,394 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,417 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:28:00,417 - src.hyperparameter_tuning - ERROR - Trial 80 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:28:00,435 - src.hyperparameter_tuning - INFO - Trial 81: 모델 타입 = xgboost
2025-06-24 09:28:00,439 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:28:00,440 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:28:00,440 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:28:00,440 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:28:00,440 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:28:00,440 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:28:00,440 - src.training - INFO - 교차 검증 시작
2025-06-24 09:28:00,440 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:28:00,440 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:28:00,440 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:28:00,440 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:28:00,440 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:28:00,440 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:28:00,440 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:28:00,440 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:28:00,440 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:28:00,440 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:28:00,440 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:28:00,441 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:00,441 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:00,441 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:00,441 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:00,441 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:00,441 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:28:00,441 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:28:00,441 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:28:00,441 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:28:00,441 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:28:00,445 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:28:00,447 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:00,447 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:28:00,447 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:28:00,447 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:28:00,447 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:28:00,447 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:28:00,447 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:00,449 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:00,451 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:28:00,451 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:00,451 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:00,451 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:00,451 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:00,451 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:00,451 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:00,451 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:28:00,451 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,451 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,452 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:28:00,452 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:28:00,452 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,452 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,452 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:28:00,452 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:28:00,452 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,452 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:00,452 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:00,452 - src.training - INFO - 모델 학습 시작
2025-06-24 09:28:00,453 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:28:00,453 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:28:00,453 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:28:00,453 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:28:00,453 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:28:00,453 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:28:00,453 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:28:00,453 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:28:00,453 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:28:00,453 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,453 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:28:00,453 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:28:00,453 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,454 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,454 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,454 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,454 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,454 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,454 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,455 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,455 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:28:00,455 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,455 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:28:00,455 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,455 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,455 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:28:00,455 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:00,455 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,455 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,455 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,456 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,456 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,456 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,456 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,456 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,456 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:00,456 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,456 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:28:00,456 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,456 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:28:00,456 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,456 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:28:00,457 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:28:00,457 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:28:00,457 - src.models.xgboost_model - INFO -   n_estimators: 212
2025-06-24 09:28:00,457 - src.models.xgboost_model - INFO -   max_depth: 14
2025-06-24 09:28:00,457 - src.models.xgboost_model - INFO -   learning_rate: 0.10124151949395611
2025-06-24 09:28:00,457 - src.models.xgboost_model - INFO -   subsample: 0.8977558406443732
2025-06-24 09:28:00,457 - src.models.xgboost_model - INFO -   colsample_bytree: 0.9169269819543159
2025-06-24 09:28:00,457 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 09:28:00,457 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:28:00,457 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:28:00,457 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:28:00,457 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:28:00,457 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:28:00,457 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:28:00,457 - src.models.xgboost_model - INFO -   reg_alpha: 1.604827585576437e-05
2025-06-24 09:28:00,457 - src.models.xgboost_model - INFO -   reg_lambda: 1.9944937535964806e-07
2025-06-24 09:28:00,457 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:28:00,457 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:28:00,457 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:28:00,471 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:28:00,471 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:28:00,471 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:28:00,471 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:00,471 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,472 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,472 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,472 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,472 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,472 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,472 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,472 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,473 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:00,473 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,473 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:28:00,473 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:28:00,473 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:28:00,473 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:28:00,473 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:28:00,473 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,473 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:28:00,473 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:28:00,474 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:28:00,474 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:28:00,474 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:28:00,474 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:28:00,474 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:28:00,474 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,474 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,474 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,475 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,475 - src.training - INFO -   precision: 0.0
2025-06-24 09:28:00,475 - src.training - INFO -   recall: 0.0
2025-06-24 09:28:00,475 - src.training - INFO -   f1: 0.0
2025-06-24 09:28:00,475 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:28:00,475 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:28:00,475 - src.training - INFO -   positive_samples: 0
2025-06-24 09:28:00,475 - src.training - INFO -   negative_samples: 250
2025-06-24 09:28:00,475 - src.training - INFO -   total_samples: 250
2025-06-24 09:28:00,475 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:28:00,475 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:28:00,475 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:28:00,475 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:28:00,475 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:28:00,475 - src.training - INFO - 모델 학습 완료
2025-06-24 09:28:00,475 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:28:00,475 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,475 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,475 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,475 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,498 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:28:00,498 - src.hyperparameter_tuning - ERROR - Trial 81 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:28:00,517 - src.hyperparameter_tuning - INFO - Trial 82: 모델 타입 = xgboost
2025-06-24 09:28:00,521 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:28:00,522 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:28:00,522 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:28:00,522 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:28:00,522 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:28:00,522 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:28:00,522 - src.training - INFO - 교차 검증 시작
2025-06-24 09:28:00,522 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:28:00,522 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:28:00,522 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:28:00,522 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:28:00,522 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:28:00,522 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:28:00,522 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:28:00,522 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:28:00,522 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:28:00,522 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:28:00,522 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:28:00,523 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:00,523 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:00,523 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:00,523 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:00,523 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:00,523 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:28:00,523 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:28:00,523 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:28:00,523 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:28:00,523 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:28:00,527 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:28:00,529 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:00,529 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:28:00,529 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:28:00,529 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:28:00,529 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:28:00,529 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:28:00,529 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:00,531 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:00,533 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:28:00,533 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:00,533 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:00,533 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:00,533 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:00,533 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:00,533 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:00,533 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:28:00,533 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,533 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,534 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:28:00,534 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:28:00,534 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,534 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,534 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:28:00,534 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:28:00,534 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,534 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:00,534 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:00,534 - src.training - INFO - 모델 학습 시작
2025-06-24 09:28:00,535 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:28:00,535 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:28:00,535 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:28:00,535 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:28:00,535 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:28:00,535 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:28:00,535 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:28:00,535 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:28:00,535 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:28:00,535 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,535 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:28:00,535 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:28:00,535 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,536 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,536 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,536 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,536 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,536 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,536 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,536 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,537 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:28:00,537 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,537 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:28:00,537 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,537 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,537 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:28:00,537 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:00,537 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,537 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,537 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,537 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,538 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,538 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,538 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,538 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,538 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:00,538 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,538 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:28:00,538 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,538 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:28:00,538 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,538 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:28:00,539 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:28:00,539 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:28:00,539 - src.models.xgboost_model - INFO -   n_estimators: 657
2025-06-24 09:28:00,539 - src.models.xgboost_model - INFO -   max_depth: 12
2025-06-24 09:28:00,539 - src.models.xgboost_model - INFO -   learning_rate: 0.11635234042364859
2025-06-24 09:28:00,539 - src.models.xgboost_model - INFO -   subsample: 0.9566328378597991
2025-06-24 09:28:00,539 - src.models.xgboost_model - INFO -   colsample_bytree: 0.9010712058196666
2025-06-24 09:28:00,539 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 09:28:00,539 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:28:00,539 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:28:00,539 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:28:00,539 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:28:00,539 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:28:00,539 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:28:00,539 - src.models.xgboost_model - INFO -   reg_alpha: 2.8789055328268898e-05
2025-06-24 09:28:00,539 - src.models.xgboost_model - INFO -   reg_lambda: 5.2128193857019155e-05
2025-06-24 09:28:00,539 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:28:00,539 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:28:00,539 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:28:00,552 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:28:00,552 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:28:00,552 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:28:00,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:00,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,552 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,552 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,553 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:00,553 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,553 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:28:00,554 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:28:00,554 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:28:00,554 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:28:00,554 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:28:00,554 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,554 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:28:00,554 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:28:00,554 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:28:00,554 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:28:00,554 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:28:00,554 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:28:00,554 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:28:00,555 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,555 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,555 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,555 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,555 - src.training - INFO -   precision: 0.0
2025-06-24 09:28:00,555 - src.training - INFO -   recall: 0.0
2025-06-24 09:28:00,555 - src.training - INFO -   f1: 0.0
2025-06-24 09:28:00,555 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:28:00,555 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:28:00,555 - src.training - INFO -   positive_samples: 0
2025-06-24 09:28:00,555 - src.training - INFO -   negative_samples: 250
2025-06-24 09:28:00,555 - src.training - INFO -   total_samples: 250
2025-06-24 09:28:00,555 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:28:00,555 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:28:00,556 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:28:00,556 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:28:00,556 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:28:00,556 - src.training - INFO - 모델 학습 완료
2025-06-24 09:28:00,556 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:28:00,556 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,556 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,556 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,556 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,579 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:28:00,579 - src.hyperparameter_tuning - ERROR - Trial 82 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:28:00,597 - src.hyperparameter_tuning - INFO - Trial 83: 모델 타입 = xgboost
2025-06-24 09:28:00,601 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:28:00,602 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:28:00,602 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:28:00,602 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:28:00,602 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:28:00,602 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:28:00,602 - src.training - INFO - 교차 검증 시작
2025-06-24 09:28:00,602 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:28:00,602 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:28:00,602 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:28:00,603 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:28:00,603 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:28:00,603 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:28:00,603 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:28:00,603 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:28:00,603 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:28:00,603 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:28:00,603 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:28:00,604 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:00,604 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:00,604 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:00,604 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:00,604 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:00,604 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:28:00,604 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:28:00,604 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:28:00,604 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:28:00,604 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:28:00,607 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:28:00,609 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:00,609 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:28:00,609 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:28:00,609 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:28:00,609 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:28:00,609 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:28:00,609 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:00,611 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:00,613 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:28:00,613 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:00,613 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:00,613 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:00,613 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:00,613 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:00,613 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:00,613 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:28:00,613 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,613 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,614 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:28:00,614 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:28:00,614 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,614 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,614 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:28:00,614 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:28:00,614 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,615 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:00,615 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:00,615 - src.training - INFO - 모델 학습 시작
2025-06-24 09:28:00,615 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:28:00,615 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:28:00,616 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:28:00,616 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:28:00,616 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:28:00,616 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:28:00,616 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:28:00,616 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:28:00,616 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:28:00,616 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,616 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:28:00,616 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:28:00,616 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,616 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,616 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,616 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,616 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,616 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,617 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,617 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,617 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:28:00,617 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:28:00,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,617 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,617 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:28:00,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:00,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,618 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,618 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,618 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,618 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,618 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,618 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,618 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:00,618 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,619 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:28:00,619 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,619 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:28:00,619 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,619 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:28:00,619 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:28:00,619 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:28:00,619 - src.models.xgboost_model - INFO -   n_estimators: 432
2025-06-24 09:28:00,619 - src.models.xgboost_model - INFO -   max_depth: 15
2025-06-24 09:28:00,619 - src.models.xgboost_model - INFO -   learning_rate: 0.19949127461965904
2025-06-24 09:28:00,619 - src.models.xgboost_model - INFO -   subsample: 0.9266994348532946
2025-06-24 09:28:00,619 - src.models.xgboost_model - INFO -   colsample_bytree: 0.9647751920673402
2025-06-24 09:28:00,619 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 09:28:00,619 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:28:00,619 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:28:00,619 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:28:00,619 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:28:00,619 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:28:00,619 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:28:00,619 - src.models.xgboost_model - INFO -   reg_alpha: 1.033975156966066e-05
2025-06-24 09:28:00,619 - src.models.xgboost_model - INFO -   reg_lambda: 8.837805119907822e-08
2025-06-24 09:28:00,619 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:28:00,619 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:28:00,620 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:28:00,628 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:28:00,628 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:28:00,628 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:28:00,628 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:00,628 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,628 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,628 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,628 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,628 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,629 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,629 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,629 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,629 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:00,629 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,629 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:28:00,630 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:28:00,630 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:28:00,630 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:28:00,630 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:28:00,630 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,630 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:28:00,630 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:28:00,630 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:28:00,630 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:28:00,630 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:28:00,630 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:28:00,630 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:28:00,630 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,631 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,631 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,631 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,631 - src.training - INFO -   precision: 0.0
2025-06-24 09:28:00,631 - src.training - INFO -   recall: 0.0
2025-06-24 09:28:00,631 - src.training - INFO -   f1: 0.0
2025-06-24 09:28:00,631 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:28:00,631 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:28:00,631 - src.training - INFO -   positive_samples: 0
2025-06-24 09:28:00,631 - src.training - INFO -   negative_samples: 250
2025-06-24 09:28:00,631 - src.training - INFO -   total_samples: 250
2025-06-24 09:28:00,631 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:28:00,631 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:28:00,631 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:28:00,631 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:28:00,631 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:28:00,632 - src.training - INFO - 모델 학습 완료
2025-06-24 09:28:00,632 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:28:00,632 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,632 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,632 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,632 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,655 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:28:00,655 - src.hyperparameter_tuning - ERROR - Trial 83 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:28:00,673 - src.hyperparameter_tuning - INFO - Trial 84: 모델 타입 = xgboost
2025-06-24 09:28:00,677 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:28:00,678 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:28:00,678 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:28:00,678 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:28:00,678 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:28:00,678 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:28:00,678 - src.training - INFO - 교차 검증 시작
2025-06-24 09:28:00,678 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:28:00,678 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:28:00,679 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:28:00,679 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:28:00,679 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:28:00,679 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:28:00,679 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:28:00,679 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:28:00,679 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:28:00,679 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:28:00,679 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:28:00,680 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:00,680 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:00,680 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:00,680 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:00,680 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:00,680 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:28:00,680 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:28:00,680 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:28:00,680 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:28:00,680 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:28:00,683 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:28:00,685 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:00,685 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:28:00,685 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:28:00,685 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:28:00,685 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:28:00,685 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:28:00,686 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:00,688 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:00,690 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:28:00,690 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:00,690 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:00,690 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:00,690 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:00,690 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:00,690 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:00,690 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:28:00,690 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,690 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,690 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:28:00,690 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:28:00,690 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,690 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,690 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:28:00,690 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:28:00,690 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,691 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:00,691 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:00,691 - src.training - INFO - 모델 학습 시작
2025-06-24 09:28:00,692 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:28:00,692 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:28:00,692 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:28:00,692 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:28:00,692 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:28:00,692 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:28:00,692 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:28:00,692 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:28:00,692 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:28:00,692 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,692 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:28:00,692 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:28:00,692 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,692 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,692 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,693 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,693 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,693 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,693 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,693 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,693 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:28:00,693 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,694 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:28:00,694 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,694 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,694 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:28:00,694 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:00,694 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,694 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,694 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,694 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,694 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,694 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,695 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,695 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,695 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:00,695 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,695 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:28:00,695 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,695 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:28:00,695 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,695 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:28:00,696 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:28:00,696 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:28:00,696 - src.models.xgboost_model - INFO -   n_estimators: 75
2025-06-24 09:28:00,696 - src.models.xgboost_model - INFO -   max_depth: 13
2025-06-24 09:28:00,696 - src.models.xgboost_model - INFO -   learning_rate: 0.12420949805942995
2025-06-24 09:28:00,696 - src.models.xgboost_model - INFO -   subsample: 0.8371142000275339
2025-06-24 09:28:00,696 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6968342314621331
2025-06-24 09:28:00,696 - src.models.xgboost_model - INFO -   min_child_weight: 6
2025-06-24 09:28:00,696 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:28:00,696 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:28:00,696 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:28:00,696 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:28:00,696 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:28:00,696 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:28:00,696 - src.models.xgboost_model - INFO -   reg_alpha: 0.00010100942954259031
2025-06-24 09:28:00,696 - src.models.xgboost_model - INFO -   reg_lambda: 1.8723966846963856e-08
2025-06-24 09:28:00,696 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:28:00,696 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:28:00,696 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:28:00,715 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:28:00,715 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:28:00,715 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:28:00,715 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:00,715 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,715 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,715 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,715 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,716 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,716 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,716 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,716 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,716 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:00,716 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,716 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:28:00,717 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:28:00,717 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:28:00,717 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:28:00,717 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:28:00,717 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,717 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:28:00,717 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:28:00,717 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:28:00,717 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:28:00,717 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:28:00,717 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:28:00,717 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:28:00,718 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,718 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,718 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,718 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,718 - src.training - INFO -   precision: 0.0
2025-06-24 09:28:00,718 - src.training - INFO -   recall: 0.0
2025-06-24 09:28:00,719 - src.training - INFO -   f1: 0.0
2025-06-24 09:28:00,719 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:28:00,719 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:28:00,719 - src.training - INFO -   positive_samples: 0
2025-06-24 09:28:00,719 - src.training - INFO -   negative_samples: 250
2025-06-24 09:28:00,719 - src.training - INFO -   total_samples: 250
2025-06-24 09:28:00,719 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:28:00,719 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:28:00,719 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:28:00,719 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:28:00,719 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:28:00,719 - src.training - INFO - 모델 학습 완료
2025-06-24 09:28:00,719 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:28:00,719 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,719 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,719 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,719 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,742 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:28:00,742 - src.hyperparameter_tuning - ERROR - Trial 84 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:28:00,761 - src.hyperparameter_tuning - INFO - Trial 85: 모델 타입 = xgboost
2025-06-24 09:28:00,764 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:28:00,765 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:28:00,765 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:28:00,765 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:28:00,765 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:28:00,765 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:28:00,765 - src.training - INFO - 교차 검증 시작
2025-06-24 09:28:00,765 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:28:00,765 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:28:00,766 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:28:00,766 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:28:00,766 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:28:00,766 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:28:00,766 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:28:00,766 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:28:00,766 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:28:00,766 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:28:00,766 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:28:00,767 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:00,767 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:00,767 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:00,767 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:00,767 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:00,767 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:28:00,767 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:28:00,767 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:28:00,767 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:28:00,767 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:28:00,770 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:28:00,772 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:00,772 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:28:00,772 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:28:00,773 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:28:00,773 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:28:00,773 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:28:00,773 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:00,775 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:00,777 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:28:00,777 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:00,777 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:00,777 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:00,777 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:00,777 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:00,777 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:00,777 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:28:00,777 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,777 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,777 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:28:00,777 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:28:00,777 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,777 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,777 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:28:00,777 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:28:00,777 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,778 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:00,778 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:00,778 - src.training - INFO - 모델 학습 시작
2025-06-24 09:28:00,779 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:28:00,779 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:28:00,779 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:28:00,779 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:28:00,779 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:28:00,779 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:28:00,779 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:28:00,779 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:28:00,779 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:28:00,780 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,780 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:28:00,780 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:28:00,780 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,780 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,780 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,780 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,781 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:28:00,781 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:28:00,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,782 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,782 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:28:00,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:00,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,782 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,782 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,783 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,783 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,783 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,783 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,783 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:00,783 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,783 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:28:00,783 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,783 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:28:00,783 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,783 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:28:00,784 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:28:00,784 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:28:00,784 - src.models.xgboost_model - INFO -   n_estimators: 398
2025-06-24 09:28:00,784 - src.models.xgboost_model - INFO -   max_depth: 15
2025-06-24 09:28:00,784 - src.models.xgboost_model - INFO -   learning_rate: 0.10780550385328953
2025-06-24 09:28:00,784 - src.models.xgboost_model - INFO -   subsample: 0.8574317376375139
2025-06-24 09:28:00,784 - src.models.xgboost_model - INFO -   colsample_bytree: 0.9270886334494652
2025-06-24 09:28:00,784 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 09:28:00,784 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:28:00,784 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:28:00,784 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:28:00,784 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:28:00,784 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:28:00,784 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:28:00,784 - src.models.xgboost_model - INFO -   reg_alpha: 2.7879189687947814e-06
2025-06-24 09:28:00,784 - src.models.xgboost_model - INFO -   reg_lambda: 1.842362074149553e-05
2025-06-24 09:28:00,784 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:28:00,784 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:28:00,784 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:28:00,928 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:28:00,928 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:28:00,928 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:28:00,928 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:00,929 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,929 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:00,929 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:00,929 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:00,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:00,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:00,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:00,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:00,930 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:00,930 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,930 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:28:00,932 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:28:00,932 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:28:00,932 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:28:00,932 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:28:00,932 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,932 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:28:00,932 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:28:00,932 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:28:00,933 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:28:00,933 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:28:00,933 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:28:00,933 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:28:00,933 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,933 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,934 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,934 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:00,934 - src.training - INFO -   precision: 0.0
2025-06-24 09:28:00,934 - src.training - INFO -   recall: 0.0
2025-06-24 09:28:00,934 - src.training - INFO -   f1: 0.0
2025-06-24 09:28:00,934 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:28:00,934 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:28:00,934 - src.training - INFO -   positive_samples: 0
2025-06-24 09:28:00,934 - src.training - INFO -   negative_samples: 250
2025-06-24 09:28:00,934 - src.training - INFO -   total_samples: 250
2025-06-24 09:28:00,934 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:28:00,934 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:28:00,934 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:28:00,934 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:28:00,934 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:28:00,935 - src.training - INFO - 모델 학습 완료
2025-06-24 09:28:00,935 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:28:00,935 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,935 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,935 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,935 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,957 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:28:00,958 - src.hyperparameter_tuning - ERROR - Trial 85 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:28:00,977 - src.hyperparameter_tuning - INFO - Trial 86: 모델 타입 = xgboost
2025-06-24 09:28:00,983 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:28:00,984 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:28:00,984 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:28:00,984 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:28:00,984 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:28:00,984 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:28:00,984 - src.training - INFO - 교차 검증 시작
2025-06-24 09:28:00,984 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:28:00,984 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:28:00,985 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:28:00,985 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:28:00,985 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:28:00,985 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:28:00,985 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:28:00,985 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:28:00,985 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:28:00,985 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:28:00,985 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:28:00,986 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:00,986 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:00,986 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:00,986 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:00,986 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:00,986 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:28:00,986 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:28:00,986 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:28:00,986 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:28:00,986 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:28:00,990 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:28:00,993 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:00,993 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:28:00,993 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:28:00,993 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:28:00,993 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:28:00,993 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:28:00,993 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:00,995 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:00,997 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:28:00,997 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:00,997 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:00,997 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:00,997 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:00,997 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:00,997 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:00,997 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:28:00,997 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:00,997 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,998 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:28:00,998 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:28:00,998 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,998 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,998 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:28:00,998 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:28:00,998 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:00,999 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:00,999 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:00,999 - src.training - INFO - 모델 학습 시작
2025-06-24 09:28:01,000 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:28:01,000 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:28:01,000 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:28:01,000 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:28:01,000 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:28:01,000 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:28:01,000 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:28:01,000 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:28:01,000 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:28:01,000 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,000 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:28:01,000 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:28:01,000 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,000 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,000 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,000 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,001 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,001 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,001 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,001 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,001 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:28:01,001 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,002 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:28:01,002 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,002 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,002 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:28:01,002 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:01,002 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,002 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,002 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,002 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,002 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,003 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,003 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,003 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,003 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:01,003 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,003 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:28:01,003 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,003 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:28:01,003 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,003 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:28:01,004 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:28:01,004 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:28:01,004 - src.models.xgboost_model - INFO -   n_estimators: 96
2025-06-24 09:28:01,004 - src.models.xgboost_model - INFO -   max_depth: 8
2025-06-24 09:28:01,004 - src.models.xgboost_model - INFO -   learning_rate: 0.17618335294055193
2025-06-24 09:28:01,004 - src.models.xgboost_model - INFO -   subsample: 0.8813213588471572
2025-06-24 09:28:01,004 - src.models.xgboost_model - INFO -   colsample_bytree: 0.965381550396305
2025-06-24 09:28:01,004 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 09:28:01,004 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:28:01,004 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:28:01,004 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:28:01,004 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:28:01,004 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:28:01,004 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:28:01,004 - src.models.xgboost_model - INFO -   reg_alpha: 1.0825398750320777e-06
2025-06-24 09:28:01,004 - src.models.xgboost_model - INFO -   reg_lambda: 0.1705978216866465
2025-06-24 09:28:01,004 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:28:01,004 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:28:01,004 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:28:01,014 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:28:01,014 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:28:01,014 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:28:01,014 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:01,014 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,014 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,014 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,014 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,015 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,015 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,015 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,015 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,015 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:01,015 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,015 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:28:01,016 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:28:01,016 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:28:01,016 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:28:01,016 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:28:01,016 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,016 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:28:01,016 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:28:01,016 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:28:01,016 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:28:01,016 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:28:01,016 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:28:01,016 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:28:01,017 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,017 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,017 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,017 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,017 - src.training - INFO -   precision: 0.0
2025-06-24 09:28:01,017 - src.training - INFO -   recall: 0.0
2025-06-24 09:28:01,018 - src.training - INFO -   f1: 0.0
2025-06-24 09:28:01,018 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:28:01,018 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:28:01,018 - src.training - INFO -   positive_samples: 0
2025-06-24 09:28:01,018 - src.training - INFO -   negative_samples: 250
2025-06-24 09:28:01,018 - src.training - INFO -   total_samples: 250
2025-06-24 09:28:01,018 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:28:01,018 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:28:01,018 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:28:01,018 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:28:01,018 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:28:01,018 - src.training - INFO - 모델 학습 완료
2025-06-24 09:28:01,018 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:28:01,018 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,018 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,018 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,018 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,041 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:28:01,042 - src.hyperparameter_tuning - ERROR - Trial 86 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:28:01,061 - src.hyperparameter_tuning - INFO - Trial 87: 모델 타입 = xgboost
2025-06-24 09:28:01,065 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:28:01,066 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:28:01,066 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:28:01,066 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:28:01,066 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:28:01,066 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:28:01,066 - src.training - INFO - 교차 검증 시작
2025-06-24 09:28:01,066 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:28:01,066 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:28:01,067 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:28:01,067 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:28:01,067 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:28:01,067 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:28:01,067 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:28:01,067 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:28:01,067 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:28:01,067 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:28:01,067 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:28:01,068 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:01,068 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:01,068 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:01,068 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:01,068 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:01,068 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:28:01,068 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:28:01,068 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:28:01,068 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:28:01,068 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:28:01,071 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:28:01,073 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:01,073 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:28:01,073 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:28:01,073 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:28:01,074 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:28:01,074 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:28:01,074 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:01,076 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:01,078 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:28:01,078 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:01,078 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:01,078 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:01,078 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:01,078 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:01,078 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:01,078 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:28:01,078 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,078 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,078 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:28:01,078 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:28:01,078 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,078 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,078 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:28:01,078 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:28:01,078 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,079 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:01,079 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:01,079 - src.training - INFO - 모델 학습 시작
2025-06-24 09:28:01,080 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:28:01,080 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:28:01,080 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:28:01,080 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:28:01,080 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:28:01,080 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:28:01,080 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:28:01,080 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:28:01,080 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:28:01,080 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,080 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:28:01,080 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:28:01,080 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,080 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,081 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,081 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,081 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,081 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,081 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,081 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,081 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:28:01,081 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:28:01,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,082 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,082 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:28:01,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:01,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,082 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,082 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,082 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,082 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,083 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,083 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,083 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:01,083 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,083 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:28:01,083 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,083 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:28:01,083 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,083 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:28:01,084 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:28:01,084 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:28:01,084 - src.models.xgboost_model - INFO -   n_estimators: 169
2025-06-24 09:28:01,084 - src.models.xgboost_model - INFO -   max_depth: 6
2025-06-24 09:28:01,084 - src.models.xgboost_model - INFO -   learning_rate: 0.07042498529131146
2025-06-24 09:28:01,084 - src.models.xgboost_model - INFO -   subsample: 0.9134481974541603
2025-06-24 09:28:01,084 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6373529145130514
2025-06-24 09:28:01,084 - src.models.xgboost_model - INFO -   min_child_weight: 5
2025-06-24 09:28:01,084 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:28:01,084 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:28:01,084 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:28:01,084 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:28:01,084 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:28:01,084 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:28:01,084 - src.models.xgboost_model - INFO -   reg_alpha: 1.776238835262612e-08
2025-06-24 09:28:01,084 - src.models.xgboost_model - INFO -   reg_lambda: 1.0781176718191016e-08
2025-06-24 09:28:01,084 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:28:01,084 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:28:01,084 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:28:01,107 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:28:01,107 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:28:01,107 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:28:01,107 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:01,107 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,107 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,107 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,107 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,107 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,108 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,108 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,108 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,108 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:01,108 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,108 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:28:01,109 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:28:01,109 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:28:01,109 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:28:01,109 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:28:01,109 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,109 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:28:01,109 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:28:01,109 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:28:01,109 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:28:01,109 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:28:01,109 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:28:01,109 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:28:01,109 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,110 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,110 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,110 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,110 - src.training - INFO -   precision: 0.0
2025-06-24 09:28:01,110 - src.training - INFO -   recall: 0.0
2025-06-24 09:28:01,110 - src.training - INFO -   f1: 0.0
2025-06-24 09:28:01,110 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:28:01,110 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:28:01,110 - src.training - INFO -   positive_samples: 0
2025-06-24 09:28:01,110 - src.training - INFO -   negative_samples: 250
2025-06-24 09:28:01,110 - src.training - INFO -   total_samples: 250
2025-06-24 09:28:01,110 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:28:01,110 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:28:01,110 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:28:01,111 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:28:01,111 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:28:01,111 - src.training - INFO - 모델 학습 완료
2025-06-24 09:28:01,111 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:28:01,111 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,111 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,111 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,111 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,134 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:28:01,134 - src.hyperparameter_tuning - ERROR - Trial 87 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:28:01,154 - src.hyperparameter_tuning - INFO - Trial 88: 모델 타입 = xgboost
2025-06-24 09:28:01,158 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:28:01,158 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:28:01,158 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:28:01,158 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:28:01,158 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:28:01,158 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:28:01,158 - src.training - INFO - 교차 검증 시작
2025-06-24 09:28:01,158 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:28:01,159 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:28:01,159 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:28:01,159 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:28:01,159 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:28:01,159 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:28:01,159 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:28:01,159 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:28:01,159 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:28:01,159 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:28:01,159 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:28:01,160 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:01,160 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:01,160 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:01,160 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:01,160 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:01,160 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:28:01,160 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:28:01,160 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:28:01,160 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:28:01,160 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:28:01,164 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:28:01,166 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:01,166 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:28:01,166 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:28:01,166 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:28:01,166 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:28:01,166 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:28:01,166 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:01,168 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:01,170 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:28:01,170 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:01,170 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:01,170 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:01,170 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:01,170 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:01,170 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:01,170 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:28:01,170 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,170 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,171 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:28:01,171 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:28:01,171 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,171 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,171 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:28:01,171 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:28:01,171 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,171 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:01,171 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:01,171 - src.training - INFO - 모델 학습 시작
2025-06-24 09:28:01,172 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:28:01,172 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:28:01,172 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:28:01,172 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:28:01,172 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:28:01,172 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:28:01,172 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:28:01,172 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:28:01,172 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:28:01,172 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,172 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:28:01,172 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:28:01,172 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,173 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,173 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,173 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,173 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,173 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,173 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,174 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,174 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:28:01,174 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,174 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:28:01,174 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,174 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,174 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:28:01,174 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:01,174 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,174 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,174 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,175 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,175 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,175 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,175 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,175 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,175 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:01,175 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,175 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:28:01,175 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,176 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:28:01,176 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,176 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:28:01,176 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:28:01,176 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:28:01,176 - src.models.xgboost_model - INFO -   n_estimators: 50
2025-06-24 09:28:01,176 - src.models.xgboost_model - INFO -   max_depth: 11
2025-06-24 09:28:01,176 - src.models.xgboost_model - INFO -   learning_rate: 0.04837107008052651
2025-06-24 09:28:01,176 - src.models.xgboost_model - INFO -   subsample: 0.8185572360906911
2025-06-24 09:28:01,176 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6805457813036034
2025-06-24 09:28:01,176 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 09:28:01,176 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:28:01,176 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:28:01,176 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:28:01,176 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:28:01,176 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:28:01,176 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:28:01,176 - src.models.xgboost_model - INFO -   reg_alpha: 0.256221915858353
2025-06-24 09:28:01,176 - src.models.xgboost_model - INFO -   reg_lambda: 2.983978754380211e-07
2025-06-24 09:28:01,176 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:28:01,176 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:28:01,176 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:28:01,189 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:28:01,189 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:28:01,189 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:28:01,189 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:01,189 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,189 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,190 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,190 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,190 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,190 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,190 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,190 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,190 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:01,190 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,191 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:28:01,191 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:28:01,191 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:28:01,191 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:28:01,191 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:28:01,191 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,191 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:28:01,191 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:28:01,191 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:28:01,192 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:28:01,192 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:28:01,192 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:28:01,192 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:28:01,192 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,192 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,192 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,193 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,193 - src.training - INFO -   precision: 0.0
2025-06-24 09:28:01,193 - src.training - INFO -   recall: 0.0
2025-06-24 09:28:01,193 - src.training - INFO -   f1: 0.0
2025-06-24 09:28:01,193 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:28:01,193 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:28:01,193 - src.training - INFO -   positive_samples: 0
2025-06-24 09:28:01,193 - src.training - INFO -   negative_samples: 250
2025-06-24 09:28:01,193 - src.training - INFO -   total_samples: 250
2025-06-24 09:28:01,193 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:28:01,193 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:28:01,193 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:28:01,193 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:28:01,193 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:28:01,193 - src.training - INFO - 모델 학습 완료
2025-06-24 09:28:01,193 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:28:01,193 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,193 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,193 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,193 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,217 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:28:01,217 - src.hyperparameter_tuning - ERROR - Trial 88 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:28:01,236 - src.hyperparameter_tuning - INFO - Trial 89: 모델 타입 = xgboost
2025-06-24 09:28:01,240 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:28:01,241 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:28:01,241 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:28:01,241 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:28:01,241 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:28:01,241 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:28:01,241 - src.training - INFO - 교차 검증 시작
2025-06-24 09:28:01,241 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:28:01,241 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:28:01,241 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:28:01,241 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:28:01,241 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:28:01,241 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:28:01,242 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:28:01,242 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:28:01,242 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:28:01,242 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:28:01,242 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:28:01,242 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:01,243 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:01,243 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:01,243 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:01,243 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:01,243 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:28:01,243 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:28:01,243 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:28:01,243 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:28:01,243 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:28:01,246 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:28:01,248 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:01,248 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:28:01,248 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:28:01,248 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:28:01,248 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:28:01,248 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:28:01,248 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:01,250 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:01,252 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:28:01,252 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:01,252 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:01,252 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:01,252 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:01,252 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:01,252 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:01,252 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:28:01,252 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,252 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,253 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:28:01,253 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:28:01,253 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,253 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,253 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:28:01,253 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:28:01,253 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,254 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:01,254 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:01,254 - src.training - INFO - 모델 학습 시작
2025-06-24 09:28:01,254 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:28:01,254 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:28:01,255 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:28:01,255 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:28:01,255 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:28:01,255 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:28:01,255 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:28:01,255 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:28:01,255 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:28:01,255 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,255 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:28:01,255 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:28:01,255 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,255 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,255 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,255 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,255 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,255 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,256 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,256 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,256 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:28:01,256 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,256 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:28:01,256 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,256 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,256 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:28:01,256 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:01,256 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,256 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,257 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,257 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,257 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,257 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,257 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,257 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,257 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:01,257 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,258 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:28:01,258 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,258 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:28:01,258 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,258 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:28:01,258 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:28:01,258 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:28:01,258 - src.models.xgboost_model - INFO -   n_estimators: 138
2025-06-24 09:28:01,258 - src.models.xgboost_model - INFO -   max_depth: 13
2025-06-24 09:28:01,258 - src.models.xgboost_model - INFO -   learning_rate: 0.0563312460123962
2025-06-24 09:28:01,258 - src.models.xgboost_model - INFO -   subsample: 0.8270640535313987
2025-06-24 09:28:01,258 - src.models.xgboost_model - INFO -   colsample_bytree: 0.8905166252075778
2025-06-24 09:28:01,258 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 09:28:01,258 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:28:01,258 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:28:01,258 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:28:01,258 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:28:01,258 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:28:01,258 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:28:01,258 - src.models.xgboost_model - INFO -   reg_alpha: 7.74630120863801e-08
2025-06-24 09:28:01,258 - src.models.xgboost_model - INFO -   reg_lambda: 2.0198812673168107
2025-06-24 09:28:01,258 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:28:01,258 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:28:01,259 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:28:01,279 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:28:01,279 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:28:01,279 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:28:01,279 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:01,279 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,280 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,280 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,280 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,280 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,280 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,280 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,281 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,281 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:01,281 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,281 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:28:01,282 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:28:01,282 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:28:01,282 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:28:01,282 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:28:01,282 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,282 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:28:01,282 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:28:01,282 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:28:01,282 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:28:01,282 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:28:01,282 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:28:01,282 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:28:01,282 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,283 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,283 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,283 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,283 - src.training - INFO -   precision: 0.0
2025-06-24 09:28:01,283 - src.training - INFO -   recall: 0.0
2025-06-24 09:28:01,283 - src.training - INFO -   f1: 0.0
2025-06-24 09:28:01,283 - src.training - INFO -   accuracy: 0.98
2025-06-24 09:28:01,283 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:28:01,283 - src.training - INFO -   positive_samples: 0
2025-06-24 09:28:01,283 - src.training - INFO -   negative_samples: 250
2025-06-24 09:28:01,283 - src.training - INFO -   total_samples: 250
2025-06-24 09:28:01,283 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:28:01,283 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:28:01,283 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:28:01,283 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:28:01,283 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:28:01,284 - src.training - INFO - 모델 학습 완료
2025-06-24 09:28:01,284 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.98, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:28:01,284 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,284 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,284 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,284 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,307 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:28:01,307 - src.hyperparameter_tuning - ERROR - Trial 89 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:28:01,326 - src.hyperparameter_tuning - INFO - Trial 90: 모델 타입 = xgboost
2025-06-24 09:28:01,330 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:28:01,331 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:28:01,331 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:28:01,331 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:28:01,331 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:28:01,331 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:28:01,331 - src.training - INFO - 교차 검증 시작
2025-06-24 09:28:01,331 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:28:01,331 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:28:01,332 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:28:01,332 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:28:01,332 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:28:01,332 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:28:01,332 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:28:01,332 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:28:01,332 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:28:01,332 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:28:01,332 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:28:01,333 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:01,333 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:01,333 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:01,333 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:01,333 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:01,333 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:28:01,333 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:28:01,333 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:28:01,333 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:28:01,333 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:28:01,336 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:28:01,338 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:01,338 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:28:01,338 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:28:01,338 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:28:01,338 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:28:01,338 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:28:01,338 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:01,340 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:01,342 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:28:01,342 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:01,342 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:01,342 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:01,342 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:01,342 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:01,342 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:01,343 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:28:01,343 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,343 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,343 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:28:01,343 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:28:01,343 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,343 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,343 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:28:01,343 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:28:01,343 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,344 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:01,344 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:01,344 - src.training - INFO - 모델 학습 시작
2025-06-24 09:28:01,345 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:28:01,345 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:28:01,345 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:28:01,345 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:28:01,345 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:28:01,345 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:28:01,345 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:28:01,345 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:28:01,345 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:28:01,345 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,345 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:28:01,345 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:28:01,345 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,345 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,345 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,345 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,345 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,346 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:28:01,346 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:28:01,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,346 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,346 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:28:01,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:01,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,347 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,347 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,347 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,347 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,347 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,347 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,347 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,347 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:01,348 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,348 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:28:01,348 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,348 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:28:01,348 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,348 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:28:01,348 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:28:01,348 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:28:01,348 - src.models.xgboost_model - INFO -   n_estimators: 618
2025-06-24 09:28:01,348 - src.models.xgboost_model - INFO -   max_depth: 3
2025-06-24 09:28:01,348 - src.models.xgboost_model - INFO -   learning_rate: 0.08258044671319616
2025-06-24 09:28:01,348 - src.models.xgboost_model - INFO -   subsample: 0.6871168082573467
2025-06-24 09:28:01,348 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6534170794170923
2025-06-24 09:28:01,348 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 09:28:01,348 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:28:01,348 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:28:01,348 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:28:01,348 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:28:01,348 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:28:01,348 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:28:01,348 - src.models.xgboost_model - INFO -   reg_alpha: 0.07217022334431503
2025-06-24 09:28:01,348 - src.models.xgboost_model - INFO -   reg_lambda: 0.014209048856980655
2025-06-24 09:28:01,348 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:28:01,348 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:28:01,349 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:28:01,368 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:28:01,368 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:28:01,368 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:28:01,368 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:01,368 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,369 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,369 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,369 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,369 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,369 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,369 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,369 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,370 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:01,370 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,370 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:28:01,375 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:28:01,375 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:28:01,375 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:28:01,375 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:28:01,375 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,375 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:28:01,375 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:28:01,375 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:28:01,376 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:28:01,376 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:28:01,376 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:28:01,376 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:28:01,376 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,376 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,377 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,377 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,377 - src.training - INFO -   precision: 0.0
2025-06-24 09:28:01,377 - src.training - INFO -   recall: 0.0
2025-06-24 09:28:01,377 - src.training - INFO -   f1: 0.0
2025-06-24 09:28:01,377 - src.training - INFO -   accuracy: 0.984
2025-06-24 09:28:01,377 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:28:01,377 - src.training - INFO -   positive_samples: 0
2025-06-24 09:28:01,377 - src.training - INFO -   negative_samples: 250
2025-06-24 09:28:01,377 - src.training - INFO -   total_samples: 250
2025-06-24 09:28:01,377 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:28:01,377 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:28:01,377 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:28:01,377 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:28:01,377 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:28:01,378 - src.training - INFO - 모델 학습 완료
2025-06-24 09:28:01,378 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.984, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:28:01,378 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,378 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,378 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,378 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,401 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:28:01,401 - src.hyperparameter_tuning - ERROR - Trial 90 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:28:01,420 - src.hyperparameter_tuning - INFO - Trial 91: 모델 타입 = xgboost
2025-06-24 09:28:01,424 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:28:01,425 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:28:01,425 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:28:01,425 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:28:01,425 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:28:01,425 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:28:01,425 - src.training - INFO - 교차 검증 시작
2025-06-24 09:28:01,425 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:28:01,425 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:28:01,426 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:28:01,426 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:28:01,426 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:28:01,426 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:28:01,426 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:28:01,426 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:28:01,426 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:28:01,426 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:28:01,426 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:28:01,427 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:01,427 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:01,427 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:01,427 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:01,427 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:01,427 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:28:01,427 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:28:01,427 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:28:01,427 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:28:01,427 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:28:01,430 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:28:01,432 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:01,432 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:28:01,432 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:28:01,432 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:28:01,432 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:28:01,432 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:28:01,432 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:01,434 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:01,436 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:28:01,436 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:01,437 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:01,437 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:01,437 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:01,437 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:01,437 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:01,437 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:28:01,437 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,437 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,437 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:28:01,437 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:28:01,437 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,437 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,437 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:28:01,437 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:28:01,437 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,438 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:01,438 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:01,438 - src.training - INFO - 모델 학습 시작
2025-06-24 09:28:01,439 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:28:01,439 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:28:01,439 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:28:01,439 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:28:01,439 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:28:01,439 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:28:01,439 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:28:01,439 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:28:01,439 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:28:01,439 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,439 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:28:01,439 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:28:01,439 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,439 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,439 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,440 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,440 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,440 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,440 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,440 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,440 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:28:01,440 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,441 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:28:01,441 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,441 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,441 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:28:01,441 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:01,441 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,441 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,441 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,441 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,441 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,441 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,442 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,442 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,442 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:01,442 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,442 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:28:01,442 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,442 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:28:01,442 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,442 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:28:01,443 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:28:01,443 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:28:01,443 - src.models.xgboost_model - INFO -   n_estimators: 559
2025-06-24 09:28:01,443 - src.models.xgboost_model - INFO -   max_depth: 7
2025-06-24 09:28:01,443 - src.models.xgboost_model - INFO -   learning_rate: 0.011887643464300901
2025-06-24 09:28:01,443 - src.models.xgboost_model - INFO -   subsample: 0.7366060849280066
2025-06-24 09:28:01,443 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7659288922219541
2025-06-24 09:28:01,443 - src.models.xgboost_model - INFO -   min_child_weight: 8
2025-06-24 09:28:01,443 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:28:01,443 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:28:01,443 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:28:01,443 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:28:01,443 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:28:01,443 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:28:01,443 - src.models.xgboost_model - INFO -   reg_alpha: 0.003309847217561616
2025-06-24 09:28:01,443 - src.models.xgboost_model - INFO -   reg_lambda: 0.6950227539399666
2025-06-24 09:28:01,443 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:28:01,443 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:28:01,443 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:28:01,501 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:28:01,501 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:28:01,501 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:28:01,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:01,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,502 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,503 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:01,503 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,503 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:28:01,503 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:28:01,504 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:28:01,504 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:28:01,504 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:28:01,504 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,504 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:28:01,504 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:28:01,504 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:28:01,504 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:28:01,504 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:28:01,504 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:28:01,504 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:28:01,504 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,505 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,505 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,505 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,505 - src.training - INFO -   precision: 0.0
2025-06-24 09:28:01,505 - src.training - INFO -   recall: 0.0
2025-06-24 09:28:01,505 - src.training - INFO -   f1: 0.0
2025-06-24 09:28:01,505 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:28:01,505 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:28:01,505 - src.training - INFO -   positive_samples: 0
2025-06-24 09:28:01,505 - src.training - INFO -   negative_samples: 250
2025-06-24 09:28:01,505 - src.training - INFO -   total_samples: 250
2025-06-24 09:28:01,506 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:28:01,506 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:28:01,506 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:28:01,506 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:28:01,506 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:28:01,506 - src.training - INFO - 모델 학습 완료
2025-06-24 09:28:01,506 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:28:01,506 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,506 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,506 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,506 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,529 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:28:01,529 - src.hyperparameter_tuning - ERROR - Trial 91 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:28:01,549 - src.hyperparameter_tuning - INFO - Trial 92: 모델 타입 = xgboost
2025-06-24 09:28:01,553 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:28:01,553 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:28:01,553 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:28:01,553 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:28:01,553 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:28:01,553 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:28:01,553 - src.training - INFO - 교차 검증 시작
2025-06-24 09:28:01,553 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:28:01,553 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:28:01,554 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:28:01,554 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:28:01,554 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:28:01,554 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:28:01,554 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:28:01,554 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:28:01,554 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:28:01,554 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:28:01,554 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:28:01,555 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:01,555 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:01,555 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:01,555 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:01,555 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:01,555 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:28:01,555 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:28:01,555 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:28:01,555 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:28:01,555 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:28:01,559 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:28:01,561 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:01,561 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:28:01,561 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:28:01,561 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:28:01,561 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:28:01,561 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:28:01,561 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:01,563 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:01,565 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:28:01,565 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:01,565 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:01,565 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:01,565 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:01,565 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:01,565 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:01,565 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:28:01,565 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,565 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,566 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:28:01,566 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:28:01,566 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,566 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,566 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:28:01,566 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:28:01,566 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,566 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:01,566 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:01,566 - src.training - INFO - 모델 학습 시작
2025-06-24 09:28:01,567 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:28:01,567 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:28:01,567 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:28:01,567 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:28:01,567 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:28:01,567 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:28:01,567 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:28:01,567 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:28:01,567 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:28:01,568 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,568 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:28:01,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:28:01,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,568 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,568 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,568 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,568 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,569 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,569 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,569 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:28:01,569 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,569 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:28:01,569 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,569 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,569 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:28:01,569 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:01,569 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,570 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,570 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,570 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,570 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,570 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,570 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,570 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,571 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:01,571 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,571 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:28:01,571 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,571 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:28:01,571 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,571 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:28:01,571 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:28:01,571 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:28:01,571 - src.models.xgboost_model - INFO -   n_estimators: 740
2025-06-24 09:28:01,571 - src.models.xgboost_model - INFO -   max_depth: 7
2025-06-24 09:28:01,571 - src.models.xgboost_model - INFO -   learning_rate: 0.010221425817591378
2025-06-24 09:28:01,571 - src.models.xgboost_model - INFO -   subsample: 0.666657201786488
2025-06-24 09:28:01,571 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7115646485463037
2025-06-24 09:28:01,571 - src.models.xgboost_model - INFO -   min_child_weight: 8
2025-06-24 09:28:01,571 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:28:01,572 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:28:01,572 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:28:01,572 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:28:01,572 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:28:01,572 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:28:01,572 - src.models.xgboost_model - INFO -   reg_alpha: 0.0004411662029686766
2025-06-24 09:28:01,572 - src.models.xgboost_model - INFO -   reg_lambda: 1.2482848444244687
2025-06-24 09:28:01,572 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:28:01,572 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:28:01,572 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:28:01,642 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:28:01,643 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:28:01,643 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:28:01,643 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:01,643 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,643 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,643 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,643 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,643 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,643 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,644 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:01,644 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:28:01,645 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:28:01,645 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:28:01,645 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:28:01,645 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:28:01,645 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,645 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:28:01,645 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:28:01,645 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:28:01,645 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:28:01,645 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:28:01,645 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:28:01,645 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:28:01,646 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,646 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,646 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,646 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,647 - src.training - INFO -   precision: 0.0
2025-06-24 09:28:01,647 - src.training - INFO -   recall: 0.0
2025-06-24 09:28:01,647 - src.training - INFO -   f1: 0.0
2025-06-24 09:28:01,647 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:28:01,647 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:28:01,647 - src.training - INFO -   positive_samples: 0
2025-06-24 09:28:01,647 - src.training - INFO -   negative_samples: 250
2025-06-24 09:28:01,647 - src.training - INFO -   total_samples: 250
2025-06-24 09:28:01,647 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:28:01,647 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:28:01,647 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:28:01,647 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:28:01,647 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:28:01,647 - src.training - INFO - 모델 학습 완료
2025-06-24 09:28:01,647 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:28:01,647 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,647 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,647 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,647 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,671 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:28:01,671 - src.hyperparameter_tuning - ERROR - Trial 92 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:28:01,691 - src.hyperparameter_tuning - INFO - Trial 93: 모델 타입 = xgboost
2025-06-24 09:28:01,694 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:28:01,695 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:28:01,695 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:28:01,695 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:28:01,695 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:28:01,695 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:28:01,695 - src.training - INFO - 교차 검증 시작
2025-06-24 09:28:01,695 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:28:01,695 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:28:01,696 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:28:01,696 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:28:01,696 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:28:01,696 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:28:01,696 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:28:01,696 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:28:01,696 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:28:01,696 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:28:01,696 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:28:01,697 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:01,697 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:01,697 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:01,697 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:01,697 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:01,697 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:28:01,697 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:28:01,697 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:28:01,697 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:28:01,697 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:28:01,701 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:28:01,703 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:01,703 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:28:01,703 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:28:01,703 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:28:01,703 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:28:01,703 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:28:01,704 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:01,706 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:01,708 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:28:01,708 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:01,708 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:01,708 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:01,708 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:01,708 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:01,708 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:01,708 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:28:01,708 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,708 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,709 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:28:01,709 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:28:01,709 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,709 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,709 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:28:01,709 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:28:01,709 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,709 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:01,709 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:01,710 - src.training - INFO - 모델 학습 시작
2025-06-24 09:28:01,710 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:28:01,710 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:28:01,710 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:28:01,710 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:28:01,710 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:28:01,710 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:28:01,711 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:28:01,711 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:28:01,711 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:28:01,711 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,711 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:28:01,711 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:28:01,711 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,711 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,711 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,711 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,711 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,712 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,712 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,712 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,712 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:28:01,712 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,712 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:28:01,712 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,712 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,712 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:28:01,712 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:01,712 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,713 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,713 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,713 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,713 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,713 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,713 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,713 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,714 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:01,714 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,714 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:28:01,714 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,714 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:28:01,714 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,714 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:28:01,714 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:28:01,714 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:28:01,714 - src.models.xgboost_model - INFO -   n_estimators: 612
2025-06-24 09:28:01,714 - src.models.xgboost_model - INFO -   max_depth: 6
2025-06-24 09:28:01,714 - src.models.xgboost_model - INFO -   learning_rate: 0.015564496481951108
2025-06-24 09:28:01,714 - src.models.xgboost_model - INFO -   subsample: 0.6823923516183442
2025-06-24 09:28:01,714 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7417688479762209
2025-06-24 09:28:01,714 - src.models.xgboost_model - INFO -   min_child_weight: 10
2025-06-24 09:28:01,714 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:28:01,714 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:28:01,714 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:28:01,714 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:28:01,714 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:28:01,714 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:28:01,714 - src.models.xgboost_model - INFO -   reg_alpha: 0.00018189998886927023
2025-06-24 09:28:01,714 - src.models.xgboost_model - INFO -   reg_lambda: 4.8979257643987095
2025-06-24 09:28:01,714 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:28:01,715 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:28:01,715 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:28:01,761 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:28:01,761 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:28:01,762 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:28:01,762 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:01,762 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,762 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,762 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,762 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,762 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,762 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,763 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,763 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,763 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:01,763 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,763 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:28:01,764 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:28:01,764 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:28:01,764 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:28:01,764 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:28:01,764 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,764 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:28:01,764 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:28:01,764 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:28:01,764 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:28:01,764 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:28:01,764 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:28:01,764 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:28:01,765 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,765 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,765 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,765 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,765 - src.training - INFO -   precision: 0.0
2025-06-24 09:28:01,765 - src.training - INFO -   recall: 0.0
2025-06-24 09:28:01,765 - src.training - INFO -   f1: 0.0
2025-06-24 09:28:01,765 - src.training - INFO -   accuracy: 0.972
2025-06-24 09:28:01,766 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:28:01,766 - src.training - INFO -   positive_samples: 0
2025-06-24 09:28:01,766 - src.training - INFO -   negative_samples: 250
2025-06-24 09:28:01,766 - src.training - INFO -   total_samples: 250
2025-06-24 09:28:01,766 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:28:01,766 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:28:01,766 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:28:01,766 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:28:01,766 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:28:01,766 - src.training - INFO - 모델 학습 완료
2025-06-24 09:28:01,766 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.972, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:28:01,766 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,766 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,766 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,766 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,790 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:28:01,790 - src.hyperparameter_tuning - ERROR - Trial 93 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:28:01,809 - src.hyperparameter_tuning - INFO - Trial 94: 모델 타입 = xgboost
2025-06-24 09:28:01,813 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:28:01,814 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:28:01,814 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:28:01,814 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:28:01,814 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:28:01,814 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:28:01,814 - src.training - INFO - 교차 검증 시작
2025-06-24 09:28:01,814 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:28:01,814 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:28:01,815 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:28:01,815 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:28:01,815 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:28:01,815 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:28:01,815 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:28:01,815 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:28:01,815 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:28:01,815 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:28:01,815 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:28:01,816 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:01,816 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:01,816 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:01,816 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:01,816 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:01,816 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:28:01,816 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:28:01,816 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:28:01,816 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:28:01,816 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:28:01,820 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:28:01,822 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:01,822 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:28:01,822 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:28:01,822 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:28:01,822 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:28:01,822 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:28:01,822 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:01,824 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:01,826 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:28:01,826 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:01,826 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:01,826 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:01,827 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:01,827 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:01,827 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:01,827 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:28:01,827 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,827 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,827 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:28:01,827 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:28:01,827 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,827 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,827 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:28:01,827 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:28:01,827 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,828 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:01,828 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:01,828 - src.training - INFO - 모델 학습 시작
2025-06-24 09:28:01,829 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:28:01,829 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:28:01,829 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:28:01,829 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:28:01,829 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:28:01,829 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:28:01,829 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:28:01,829 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:28:01,829 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:28:01,829 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,829 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:28:01,829 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:28:01,829 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,829 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,829 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,829 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,830 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,830 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,830 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,830 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,830 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:28:01,830 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,830 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:28:01,830 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,830 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,830 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:28:01,830 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:01,830 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,831 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,831 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,831 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,831 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,831 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,831 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,831 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,832 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:01,832 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,832 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:28:01,832 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,832 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:28:01,832 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,832 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:28:01,832 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:28:01,832 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:28:01,832 - src.models.xgboost_model - INFO -   n_estimators: 639
2025-06-24 09:28:01,832 - src.models.xgboost_model - INFO -   max_depth: 10
2025-06-24 09:28:01,832 - src.models.xgboost_model - INFO -   learning_rate: 0.012461445908281925
2025-06-24 09:28:01,832 - src.models.xgboost_model - INFO -   subsample: 0.6584671873372798
2025-06-24 09:28:01,832 - src.models.xgboost_model - INFO -   colsample_bytree: 0.8170644717190884
2025-06-24 09:28:01,832 - src.models.xgboost_model - INFO -   min_child_weight: 7
2025-06-24 09:28:01,832 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:28:01,832 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:28:01,832 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:28:01,832 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:28:01,832 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:28:01,832 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:28:01,832 - src.models.xgboost_model - INFO -   reg_alpha: 0.024258190676820907
2025-06-24 09:28:01,832 - src.models.xgboost_model - INFO -   reg_lambda: 4.151493439520333e-06
2025-06-24 09:28:01,833 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:28:01,833 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:28:01,833 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:28:01,895 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:28:01,895 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:28:01,895 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:28:01,895 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:01,895 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,895 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,896 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,896 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,896 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,896 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,896 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,896 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,896 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:01,896 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,897 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:28:01,897 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:28:01,897 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:28:01,897 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:28:01,897 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:28:01,897 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,897 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:28:01,897 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:28:01,897 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:28:01,898 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:28:01,898 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:28:01,898 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:28:01,898 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:28:01,898 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,898 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,898 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,899 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,899 - src.training - INFO -   precision: 0.0
2025-06-24 09:28:01,899 - src.training - INFO -   recall: 0.0
2025-06-24 09:28:01,899 - src.training - INFO -   f1: 0.0
2025-06-24 09:28:01,899 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:28:01,899 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:28:01,899 - src.training - INFO -   positive_samples: 0
2025-06-24 09:28:01,899 - src.training - INFO -   negative_samples: 250
2025-06-24 09:28:01,899 - src.training - INFO -   total_samples: 250
2025-06-24 09:28:01,899 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:28:01,899 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:28:01,899 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:28:01,899 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:28:01,899 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:28:01,899 - src.training - INFO - 모델 학습 완료
2025-06-24 09:28:01,899 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:28:01,899 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,899 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,899 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,899 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,924 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:28:01,924 - src.hyperparameter_tuning - ERROR - Trial 94 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:28:01,943 - src.hyperparameter_tuning - INFO - Trial 95: 모델 타입 = xgboost
2025-06-24 09:28:01,947 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:28:01,947 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:28:01,947 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:28:01,947 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:28:01,947 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:28:01,947 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:28:01,947 - src.training - INFO - 교차 검증 시작
2025-06-24 09:28:01,947 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:28:01,947 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:28:01,948 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:28:01,948 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:28:01,948 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:28:01,948 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:28:01,948 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:28:01,948 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:28:01,948 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:28:01,948 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:28:01,948 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:28:01,949 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:01,949 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:01,949 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:01,949 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:01,949 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:01,949 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:28:01,949 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:28:01,949 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:28:01,949 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:28:01,949 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:28:01,952 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:28:01,955 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:01,955 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:28:01,955 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:28:01,955 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:28:01,955 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:28:01,955 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:28:01,955 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:01,957 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:01,959 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:28:01,959 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:01,959 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:01,959 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:01,959 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:01,959 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:01,959 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:01,959 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:28:01,959 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,959 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,959 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:28:01,959 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:28:01,959 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,959 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,960 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:28:01,960 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:28:01,960 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,960 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:01,960 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:01,960 - src.training - INFO - 모델 학습 시작
2025-06-24 09:28:01,961 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:28:01,961 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:28:01,961 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:28:01,961 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:28:01,961 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:28:01,961 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:28:01,961 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:28:01,961 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:28:01,961 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:28:01,961 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,961 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:28:01,961 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:28:01,961 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,961 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,962 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,962 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,962 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,962 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,962 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,962 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,962 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:28:01,963 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,963 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:28:01,963 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,963 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,963 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:28:01,963 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:01,963 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,963 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,963 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,963 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,963 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,964 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,964 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,964 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,964 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:01,964 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,964 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:28:01,964 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,964 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:28:01,964 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,964 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:28:01,965 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:28:01,965 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:28:01,965 - src.models.xgboost_model - INFO -   n_estimators: 588
2025-06-24 09:28:01,965 - src.models.xgboost_model - INFO -   max_depth: 14
2025-06-24 09:28:01,965 - src.models.xgboost_model - INFO -   learning_rate: 0.09181070251964117
2025-06-24 09:28:01,965 - src.models.xgboost_model - INFO -   subsample: 0.7204929404670175
2025-06-24 09:28:01,965 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6967990350212042
2025-06-24 09:28:01,965 - src.models.xgboost_model - INFO -   min_child_weight: 10
2025-06-24 09:28:01,965 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:28:01,965 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:28:01,965 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:28:01,965 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:28:01,965 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:28:01,965 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:28:01,965 - src.models.xgboost_model - INFO -   reg_alpha: 1.0601784908506723e-05
2025-06-24 09:28:01,965 - src.models.xgboost_model - INFO -   reg_lambda: 2.812262199281051
2025-06-24 09:28:01,965 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:28:01,965 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:28:01,965 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:28:01,979 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:28:01,979 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:28:01,979 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:28:01,979 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:01,979 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,979 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:01,979 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:01,979 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:01,979 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:01,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:01,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:01,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:01,980 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:01,980 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,980 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:28:01,981 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:28:01,981 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:28:01,981 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:28:01,981 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:28:01,981 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,981 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:28:01,981 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:28:01,981 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:28:01,981 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:28:01,981 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:28:01,981 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:28:01,981 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:28:01,982 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,982 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,982 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,982 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:01,982 - src.training - INFO -   precision: 0.0
2025-06-24 09:28:01,982 - src.training - INFO -   recall: 0.0
2025-06-24 09:28:01,982 - src.training - INFO -   f1: 0.0
2025-06-24 09:28:01,982 - src.training - INFO -   accuracy: 0.972
2025-06-24 09:28:01,982 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:28:01,982 - src.training - INFO -   positive_samples: 0
2025-06-24 09:28:01,982 - src.training - INFO -   negative_samples: 250
2025-06-24 09:28:01,982 - src.training - INFO -   total_samples: 250
2025-06-24 09:28:01,982 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:28:01,982 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:28:01,982 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:28:01,982 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:28:01,982 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:28:01,983 - src.training - INFO - 모델 학습 완료
2025-06-24 09:28:01,983 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.972, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:28:01,983 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,983 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:01,983 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:01,983 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,007 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:28:02,007 - src.hyperparameter_tuning - ERROR - Trial 95 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:28:02,027 - src.hyperparameter_tuning - INFO - Trial 96: 모델 타입 = xgboost
2025-06-24 09:28:02,031 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:28:02,032 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:28:02,032 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:28:02,032 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:28:02,032 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:28:02,032 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:28:02,032 - src.training - INFO - 교차 검증 시작
2025-06-24 09:28:02,032 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:28:02,032 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:28:02,032 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:28:02,032 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:28:02,032 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:28:02,032 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:28:02,033 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:28:02,033 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:28:02,033 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:28:02,033 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:28:02,033 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:28:02,034 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:02,034 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:02,034 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:02,034 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:02,034 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:02,034 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:28:02,034 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:28:02,034 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:28:02,034 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:28:02,034 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:28:02,037 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:28:02,039 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:02,039 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:28:02,039 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:28:02,039 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:28:02,039 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:28:02,039 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:28:02,039 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:02,041 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:02,043 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:28:02,043 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:02,044 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:02,044 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:02,044 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:02,044 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:02,044 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:02,044 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:28:02,044 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,044 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,044 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:28:02,044 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:28:02,044 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,044 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,044 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:28:02,044 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:28:02,044 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,045 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:02,045 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:02,045 - src.training - INFO - 모델 학습 시작
2025-06-24 09:28:02,046 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:28:02,046 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:28:02,046 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:28:02,046 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:28:02,046 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:28:02,046 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:28:02,046 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:28:02,046 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:28:02,046 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:28:02,046 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,046 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:28:02,046 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:28:02,046 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,046 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:02,046 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:02,047 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:02,047 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:02,047 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:02,047 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:02,047 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:02,047 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:28:02,047 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,047 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:28:02,047 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,048 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,048 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:28:02,048 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:02,048 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,048 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:02,048 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:02,048 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:02,048 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:02,048 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:02,048 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:02,049 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:02,049 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:02,049 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,049 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:28:02,049 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,049 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:28:02,049 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,049 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:28:02,049 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:28:02,049 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:28:02,049 - src.models.xgboost_model - INFO -   n_estimators: 710
2025-06-24 09:28:02,049 - src.models.xgboost_model - INFO -   max_depth: 8
2025-06-24 09:28:02,050 - src.models.xgboost_model - INFO -   learning_rate: 0.017518784533526184
2025-06-24 09:28:02,050 - src.models.xgboost_model - INFO -   subsample: 0.7054057845088054
2025-06-24 09:28:02,050 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6759885155452908
2025-06-24 09:28:02,050 - src.models.xgboost_model - INFO -   min_child_weight: 9
2025-06-24 09:28:02,050 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:28:02,050 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:28:02,050 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:28:02,050 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:28:02,050 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:28:02,050 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:28:02,050 - src.models.xgboost_model - INFO -   reg_alpha: 6.87861471549386e-05
2025-06-24 09:28:02,050 - src.models.xgboost_model - INFO -   reg_lambda: 6.3161374087561155
2025-06-24 09:28:02,050 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:28:02,050 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:28:02,050 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:28:02,094 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:28:02,094 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:28:02,094 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:28:02,094 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:02,094 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,095 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:02,095 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:02,095 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:02,095 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:02,095 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:02,095 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:02,095 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:02,096 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:02,096 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,096 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:28:02,096 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:28:02,096 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:28:02,096 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:28:02,096 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:28:02,096 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,096 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:28:02,096 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:28:02,097 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:28:02,097 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:28:02,097 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:28:02,097 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:28:02,097 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:28:02,097 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:02,097 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:02,097 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:02,098 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:02,098 - src.training - INFO -   precision: 0.0
2025-06-24 09:28:02,098 - src.training - INFO -   recall: 0.0
2025-06-24 09:28:02,098 - src.training - INFO -   f1: 0.0
2025-06-24 09:28:02,098 - src.training - INFO -   accuracy: 0.972
2025-06-24 09:28:02,098 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:28:02,098 - src.training - INFO -   positive_samples: 0
2025-06-24 09:28:02,098 - src.training - INFO -   negative_samples: 250
2025-06-24 09:28:02,098 - src.training - INFO -   total_samples: 250
2025-06-24 09:28:02,098 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:28:02,098 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:28:02,098 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:28:02,098 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:28:02,098 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:28:02,098 - src.training - INFO - 모델 학습 완료
2025-06-24 09:28:02,098 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.972, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:28:02,098 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,098 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,098 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,098 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,123 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:28:02,123 - src.hyperparameter_tuning - ERROR - Trial 96 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:28:02,142 - src.hyperparameter_tuning - INFO - Trial 97: 모델 타입 = xgboost
2025-06-24 09:28:02,146 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:28:02,147 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:28:02,147 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:28:02,147 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:28:02,147 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:28:02,147 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:28:02,147 - src.training - INFO - 교차 검증 시작
2025-06-24 09:28:02,147 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:28:02,147 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:28:02,148 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:28:02,148 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:28:02,148 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:28:02,148 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:28:02,148 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:28:02,148 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:28:02,148 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:28:02,148 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:28:02,148 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:28:02,149 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:02,149 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:02,149 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:02,149 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:02,149 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:02,149 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:28:02,149 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:28:02,149 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:28:02,149 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:28:02,149 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:28:02,152 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:28:02,154 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:02,154 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:28:02,154 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:28:02,154 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:28:02,154 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:28:02,154 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:28:02,154 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:02,156 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:02,158 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:28:02,158 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:02,158 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:02,158 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:02,158 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:02,159 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:02,159 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:02,159 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:28:02,159 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,159 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,159 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:28:02,159 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:28:02,159 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,159 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,159 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:28:02,159 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:28:02,159 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,160 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:02,160 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:02,160 - src.training - INFO - 모델 학습 시작
2025-06-24 09:28:02,161 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:28:02,161 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:28:02,161 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:28:02,161 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:28:02,161 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:28:02,161 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:28:02,161 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:28:02,161 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:28:02,161 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:28:02,161 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,161 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:28:02,161 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:28:02,161 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,161 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:02,161 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:02,161 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:02,161 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:02,162 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:02,162 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:02,162 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:02,162 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:28:02,162 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,162 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:28:02,162 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,162 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,162 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:28:02,162 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:02,162 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,163 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:02,163 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:02,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:02,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:02,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:02,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:02,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:02,164 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:02,164 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:28:02,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,164 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:28:02,164 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,164 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:28:02,164 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:28:02,164 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:28:02,164 - src.models.xgboost_model - INFO -   n_estimators: 675
2025-06-24 09:28:02,164 - src.models.xgboost_model - INFO -   max_depth: 7
2025-06-24 09:28:02,164 - src.models.xgboost_model - INFO -   learning_rate: 0.040727213276816776
2025-06-24 09:28:02,164 - src.models.xgboost_model - INFO -   subsample: 0.8113569985028878
2025-06-24 09:28:02,164 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7248662560212005
2025-06-24 09:28:02,164 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 09:28:02,164 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:28:02,164 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:28:02,164 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:28:02,164 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:28:02,164 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:28:02,164 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:28:02,164 - src.models.xgboost_model - INFO -   reg_alpha: 0.0370620663398509
2025-06-24 09:28:02,164 - src.models.xgboost_model - INFO -   reg_lambda: 0.3457651462620648
2025-06-24 09:28:02,165 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:28:02,165 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:28:02,165 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:28:02,187 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:28:02,187 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:28:02,187 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:28:02,187 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:02,187 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,187 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:02,187 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:02,187 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:02,187 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:02,187 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:02,188 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:02,188 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:02,188 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:02,188 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,188 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:28:02,189 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:28:02,189 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:28:02,189 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:28:02,189 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:28:02,189 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,189 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:28:02,189 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:28:02,189 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:28:02,189 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:28:02,189 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:28:02,189 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:28:02,189 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:28:02,189 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:02,190 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:02,190 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:02,190 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:02,190 - src.training - INFO -   precision: 0.0
2025-06-24 09:28:02,190 - src.training - INFO -   recall: 0.0
2025-06-24 09:28:02,190 - src.training - INFO -   f1: 0.0
2025-06-24 09:28:02,190 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:28:02,190 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:28:02,190 - src.training - INFO -   positive_samples: 0
2025-06-24 09:28:02,190 - src.training - INFO -   negative_samples: 250
2025-06-24 09:28:02,190 - src.training - INFO -   total_samples: 250
2025-06-24 09:28:02,190 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:28:02,190 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:28:02,190 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:28:02,190 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:28:02,190 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:28:02,191 - src.training - INFO - 모델 학습 완료
2025-06-24 09:28:02,191 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:28:02,191 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,191 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,191 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,191 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,215 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:28:02,215 - src.hyperparameter_tuning - ERROR - Trial 97 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:28:02,235 - src.hyperparameter_tuning - INFO - Trial 98: 모델 타입 = xgboost
2025-06-24 09:28:02,238 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:28:02,239 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:28:02,239 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:28:02,239 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:28:02,239 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:28:02,239 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:28:02,239 - src.training - INFO - 교차 검증 시작
2025-06-24 09:28:02,239 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:28:02,239 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:28:02,240 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:28:02,240 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:28:02,240 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:28:02,240 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:28:02,240 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:28:02,240 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:28:02,240 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:28:02,240 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:28:02,240 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:28:02,241 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:02,241 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:02,241 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:02,241 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:02,241 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:02,241 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:28:02,241 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:28:02,241 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:28:02,241 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:28:02,241 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:28:02,244 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:28:02,246 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:02,246 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:28:02,246 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:28:02,246 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:28:02,246 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:28:02,246 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:28:02,246 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:02,249 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:02,250 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:28:02,250 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:02,251 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:02,251 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:02,251 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:02,251 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:02,251 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:02,251 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:28:02,251 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,251 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,251 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:28:02,251 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:28:02,251 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,251 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,251 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:28:02,251 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:28:02,251 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,252 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:02,252 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:02,252 - src.training - INFO - 모델 학습 시작
2025-06-24 09:28:02,253 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:28:02,253 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:28:02,253 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:28:02,253 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:28:02,253 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:28:02,253 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:28:02,253 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:28:02,253 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:28:02,253 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:28:02,253 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,253 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:28:02,253 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:28:02,253 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,253 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:02,253 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:02,253 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:02,254 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:02,254 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:02,254 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:02,254 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:02,254 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:28:02,254 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,254 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:28:02,254 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,254 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,254 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:28:02,254 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:02,254 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,255 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:02,255 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:02,255 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:02,255 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:02,255 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:02,255 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:02,255 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:02,256 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:02,256 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,256 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:28:02,256 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,256 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:28:02,256 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,256 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:28:02,256 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:28:02,256 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:28:02,256 - src.models.xgboost_model - INFO -   n_estimators: 494
2025-06-24 09:28:02,256 - src.models.xgboost_model - INFO -   max_depth: 5
2025-06-24 09:28:02,256 - src.models.xgboost_model - INFO -   learning_rate: 0.05167009358358815
2025-06-24 09:28:02,256 - src.models.xgboost_model - INFO -   subsample: 0.8426970731862589
2025-06-24 09:28:02,256 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6641367287057586
2025-06-24 09:28:02,256 - src.models.xgboost_model - INFO -   min_child_weight: 6
2025-06-24 09:28:02,257 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:28:02,257 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:28:02,257 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:28:02,257 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:28:02,257 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:28:02,257 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:28:02,257 - src.models.xgboost_model - INFO -   reg_alpha: 0.005958076178548152
2025-06-24 09:28:02,257 - src.models.xgboost_model - INFO -   reg_lambda: 1.0792349551592184
2025-06-24 09:28:02,257 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:28:02,257 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:28:02,257 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:28:02,277 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:28:02,277 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:28:02,277 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:28:02,277 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:02,277 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,277 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:02,277 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:02,277 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:02,278 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:02,278 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:02,278 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:02,278 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:02,278 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:02,278 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,278 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:28:02,279 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:28:02,279 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:28:02,279 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:28:02,279 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:28:02,279 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,279 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:28:02,279 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:28:02,279 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:28:02,279 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:28:02,279 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:28:02,279 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:28:02,279 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:28:02,280 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:02,280 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:02,280 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:02,280 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:02,280 - src.training - INFO -   precision: 0.0
2025-06-24 09:28:02,280 - src.training - INFO -   recall: 0.0
2025-06-24 09:28:02,281 - src.training - INFO -   f1: 0.0
2025-06-24 09:28:02,281 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:28:02,281 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:28:02,281 - src.training - INFO -   positive_samples: 0
2025-06-24 09:28:02,281 - src.training - INFO -   negative_samples: 250
2025-06-24 09:28:02,281 - src.training - INFO -   total_samples: 250
2025-06-24 09:28:02,281 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:28:02,281 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:28:02,281 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:28:02,281 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:28:02,281 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:28:02,281 - src.training - INFO - 모델 학습 완료
2025-06-24 09:28:02,281 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:28:02,281 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,281 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,281 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,281 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,305 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:28:02,305 - src.hyperparameter_tuning - ERROR - Trial 98 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:28:02,325 - src.hyperparameter_tuning - INFO - Trial 99: 모델 타입 = xgboost
2025-06-24 09:28:02,329 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:28:02,330 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:28:02,330 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:28:02,330 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:28:02,330 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:28:02,330 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:28:02,330 - src.training - INFO - 교차 검증 시작
2025-06-24 09:28:02,330 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:28:02,330 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:28:02,331 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:28:02,331 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:28:02,331 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:28:02,331 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:28:02,331 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:28:02,331 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:28:02,331 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:28:02,331 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:28:02,331 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:28:02,332 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:02,332 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:02,332 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:28:02,332 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:28:02,332 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:02,332 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:28:02,332 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:28:02,332 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:28:02,332 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:28:02,332 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:28:02,335 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:28:02,337 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:02,337 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:28:02,337 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:28:02,337 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:28:02,337 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:28:02,337 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:28:02,337 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:28:02,340 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:28:02,342 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:28:02,342 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:02,342 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:02,342 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:28:02,342 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:28:02,342 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:02,342 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:28:02,342 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:28:02,342 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,342 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,342 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:28:02,342 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:28:02,342 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,342 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,342 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:28:02,342 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:28:02,342 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,343 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:02,343 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:28:02,343 - src.training - INFO - 모델 학습 시작
2025-06-24 09:28:02,344 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:28:02,344 - src.training - INFO - 모델 타입: xgboost
2025-06-24 09:28:02,344 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 09:28:02,344 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 09:28:02,344 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:28:02,344 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:28:02,344 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:28:02,344 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 09:28:02,344 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:28:02,344 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,344 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (500, 6)
2025-06-24 09:28:02,344 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:28:02,344 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,344 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:02,344 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:02,345 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:02,345 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:02,345 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:02,345 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:02,345 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:02,345 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:28:02,345 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:28:02,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,346 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,346 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (500, 6)
2025-06-24 09:28:02,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:02,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:02,346 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:02,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:02,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:02,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:02,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:02,347 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:02,347 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:02,347 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,347 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:28:02,347 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,347 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (250, 6)
2025-06-24 09:28:02,347 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,347 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 09:28:02,347 - src.models.xgboost_model - INFO -   - scale_pos_weight: 499.00
2025-06-24 09:28:02,348 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:28:02,348 - src.models.xgboost_model - INFO -   n_estimators: 658
2025-06-24 09:28:02,348 - src.models.xgboost_model - INFO -   max_depth: 4
2025-06-24 09:28:02,348 - src.models.xgboost_model - INFO -   learning_rate: 0.12741588401247655
2025-06-24 09:28:02,348 - src.models.xgboost_model - INFO -   subsample: 0.743973892325305
2025-06-24 09:28:02,348 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7570921210139582
2025-06-24 09:28:02,348 - src.models.xgboost_model - INFO -   min_child_weight: 9
2025-06-24 09:28:02,348 - src.models.xgboost_model - INFO -   scale_pos_weight: 499.0
2025-06-24 09:28:02,348 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:28:02,348 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 09:28:02,348 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 09:28:02,348 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 09:28:02,348 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 09:28:02,348 - src.models.xgboost_model - INFO -   reg_alpha: 0.0003424597989175272
2025-06-24 09:28:02,348 - src.models.xgboost_model - INFO -   reg_lambda: 0.0020946747439076156
2025-06-24 09:28:02,348 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 09:28:02,348 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 09:28:02,348 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 09:28:02,370 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 09:28:02,370 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 09:28:02,370 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 09:28:02,370 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:28:02,370 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,370 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:28:02,370 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:28:02,370 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:28:02,370 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:28:02,371 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:28:02,371 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:28:02,371 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:28:02,371 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:28:02,371 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:28:02,372 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 09:28:02,372 - src.models.xgboost_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:28:02,372 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:28:02,372 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:28:02,372 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,372 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 09:28:02,372 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:28:02,372 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 09:28:02,372 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:28:02,372 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:28:02,372 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 09:28:02,372 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:28:02,373 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:02,373 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:02,373 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:02,373 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and binary targets, 0.0 반환
2025-06-24 09:28:02,373 - src.training - INFO -   precision: 0.0
2025-06-24 09:28:02,373 - src.training - INFO -   recall: 0.0
2025-06-24 09:28:02,373 - src.training - INFO -   f1: 0.0
2025-06-24 09:28:02,373 - src.training - INFO -   accuracy: 0.976
2025-06-24 09:28:02,373 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:28:02,373 - src.training - INFO -   positive_samples: 0
2025-06-24 09:28:02,374 - src.training - INFO -   negative_samples: 250
2025-06-24 09:28:02,374 - src.training - INFO -   total_samples: 250
2025-06-24 09:28:02,374 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:28:02,374 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:28:02,374 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:28:02,374 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:28:02,374 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:28:02,374 - src.training - INFO - 모델 학습 완료
2025-06-24 09:28:02,374 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.976, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:28:02,374 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,374 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,374 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:28:02,374 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:28:02,398 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:28:02,398 - src.hyperparameter_tuning - ERROR - Trial 99 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:28:02,399 - src.hyperparameter_tuning - INFO - 튜닝 완료 - 최고 성능: -inf
2025-06-24 09:28:02,399 - src.hyperparameter_tuning - INFO - 튜닝 시간: 9.11초
2025-06-24 09:28:02,403 - __main__ - INFO - 튜닝 결과 저장 중...
2025-06-24 09:28:02,404 - __main__ - ERROR - 하이퍼파라미터 튜닝 실패: 'NoneType' object has no attribute 'copy'
